---
layout: post
title: "简单图形编程的学习（1）---文字 (Windows GDI实现)"
categories:
- "游戏开发"
tags:
- Windows GDI
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '21'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---

<p style="text-align: center"><span style="color:#548dd4; font-size:22pt"><strong>简单图形编程的学习（1）---文字 (Windows GDI实现) </strong></span></p>
<p style="text-align: right"><a href="http://www.jtianling.com"><strong>write by <span style="font-family:宋体">九天雁翎</span>(JTianLing) -- www.jtianling.com</strong></a><span style="color: #c0504d; text-decoration: underline;"><strong> </strong></span></p>
<p style="text-align: right"><a href="http://groups.google.com/group/jiutianfile/"><strong>讨论新闻组及文件</strong></a> </p>
<p>&nbsp;</p>
<h1 style="text-indent: 0cm; margin: 24pt 0cm 0pt;"><span style="color: #365f91;"><span style="mso-bidi-font-family: 宋体; mso-bidi-theme-font: major-fareast;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-family: Cambria;">一、</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">全部简单图形编程的学习说在前面的话</span></span></h1>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="mso-tab-count: 1;"><span style="font-family: Calibri;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">此系列文章均假设读者已经具备一定的对应的程序编写知识，无论是最简单的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">small basic,</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">还是因为常用而被人熟知的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows GDI</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，或者是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下用的更多的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Qt(</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">一般我用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">PyQt),</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">甚至是现在国内知道的人并不多的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Android</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，我都不准备讲太多基础的语法，或者与平台相关的太多背景知识，这些靠读者先行学习，我仅仅准备在自己学习的过程中找点乐子：）看看我用一些简单的接口都能想出干什么事情，然后展示给大家看看，图形程序实在是最好展示的一类程序了，不像其他程序一样，哪怕我讲了一堆的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">boost</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，真正见识到</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">boost</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">强大的又有几个呢？</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">要知道，今天起，所有程序都是窗口程序，不再是命令行</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">!!!!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">人类用了多久才走到这一步我不知道。。。。我用了</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">25</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">年</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">.......</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">（从我出生算起）或者</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">1</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">年（从工作开始）</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="mso-tab-count: 1;"><span style="font-family: Calibri;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">另外，想要看怎么编写窗口应用程序的就不要走错地方了，这里不是想怎么描述怎么使用一个又一个的控件，这里都是讲绘图的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<h1 style="text-indent: 0cm; margin: 24pt 0cm 0pt;"><span style="color: #365f91;"><span style="mso-bidi-font-family: 宋体; mso-bidi-theme-font: major-fareast;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-family: Cambria;">二、</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">谈谈</span><span lang="EN-US"><span style="font-family: Cambria;">Windows GDI</span></span></span></h1>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">由于今天是第一篇，所以谈谈</span><span style="font-family: Calibri;"><span lang="EN-US">Windows GDI</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">虽然因为兴趣和工作需要，对</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">也有所了解，但是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">到目前为止绝对是本人最熟悉的平台。。。也许也是绝大部分程序员最熟悉的平台吧，但是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">GDI</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">用的实在是并不多。。。。也许又要说了。。我本质上是个服务器端的程序员</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">呵呵，服务器端程序员每天面对的只能是控制台，与图形化界面无关，更加与</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">GDI</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">无关。。。。呵呵，但是假如要做客户端的话，是有图形界面了，但是其实游戏还是不需要用到</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">GDI</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的。。。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下不都是用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">DirectX</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">嘛。但是我对</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">GDI</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">还是比较有兴趣，主要来源于一个资深同事描述用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows GDI</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">去描述</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">IM</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">软件界面的往事（公司以前是做</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">IM</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">软件的），呵呵，我听着都觉得出神入化。自己好歹也了解一下，虽然说其实用到的机会不多。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">文字好像都不像是图形编程中应该学习的东西，但是别忘了，文字可都是由象形文字发展过来的。。。中文至今还是象形文字呢，文字在远古的时代可本来就是图形啊，为啥学习图形编程的时候不要学习怎么显示文字啊？呵呵，前面的都是废话，其实你编点啥程序都会碰到需要在图形中显示文字的情况，所以我们先来看看文字的显示。另外，其实在显示文字的时候，假如需要对文字的显示进行设置，也能学到很多普通图形的设置方式，这点以后就能看到。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<h1 style="text-indent: 0cm; margin: 24pt 0cm 0pt;"><span style="color: #365f91;"><span style="mso-bidi-font-family: 宋体; mso-bidi-theme-font: major-fareast;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-family: Cambria;">三、</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp; </span></span></span><span lang="EN-US"><span style="font-family: Cambria;">Windows GDI</span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">的文字显示</span></span></h1>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">事实上因为一个完整的</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">程序已经较为复杂，所以以后的程序得有个模板可以套才行，不然老是纠缠在窗口注册，创建和消息循环上了，那样效率太低。这里就用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">VS2005</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">创建</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Win32</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">程序本身的那一套了，不用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">MFC</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">是不想拦住不了解也不像熟悉</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">MFC</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">的兄弟，也许另外弄个</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">MFC+GDI+ </span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">（注：切分格式是</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">(MFC+(GDI+))-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">）篇吧。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">基本程序如下：</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">// Win32GraphicEx1.cpp : </span>定义应用程序的入口点。</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"stdafx.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"Win32GraphicEx1.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="color: #a31515;" lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">MAX_LOADSTRING</span> 100</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">// </span>全局变量<span lang="EN-US">:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">HINSTANCE</span><span lang="EN-US"> <span style="color: #010001;">hInst</span>;<span style="mso-tab-count: 8;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span>当前实例</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">TCHAR</span><span lang="EN-US"> <span style="color: #010001;">szTitle</span>[<span style="color: #010001;">MAX_LOADSTRING</span>];<span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span>标题栏文本</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">TCHAR</span><span lang="EN-US"> <span style="color: #010001;">szWindowClass</span>[<span style="color: #010001;">MAX_LOADSTRING</span>];<span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span>主窗口类名</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">// </span>此代码模块中包含的函数的前向声明<span lang="EN-US">:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">ATOM</span><span lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MyRegisterClass</span>(<span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hInstance</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">BOOL</span><span lang="EN-US"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">InitInstance</span>(<span style="color: #010001;">HINSTANCE</span>, <span style="color: blue;">int</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">LRESULT</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span><span style="mso-tab-count: 1;"> </span><span style="color: #010001;">WndProc</span>(<span style="color: #010001;">HWND</span>, <span style="color: #010001;">UINT</span>, <span style="color: #010001;">WPARAM</span>, <span style="color: #010001;">LPARAM</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">INT_PTR</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span><span style="mso-tab-count: 1;"> </span><span style="color: #010001;">About</span>(<span style="color: #010001;">HWND</span>, <span style="color: #010001;">UINT</span>, <span style="color: #010001;">WPARAM</span>, <span style="color: #010001;">LPARAM</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">int</span><span lang="EN-US"> <span style="color: #010001;">APIENTRY</span> <span style="color: #010001;">_tWinMain</span>(<span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hInstance</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hPrevInstance</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LPTSTR</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lpCmdLine</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">nCmdShow</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">UNREFERENCED_PARAMETER</span>(<span style="color: #010001;">hPrevInstance</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">UNREFERENCED_PARAMETER</span>(<span style="color: #010001;">lpCmdLine</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;</span><span style="mso-tab-count: 1;">&nbsp; </span>// TODO: </span>在此放置代码。</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">MSG</span> <span style="color: #010001;">msg</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HACCEL</span> <span style="color: #010001;">hAccelTable</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>// </span>初始化全局字符串</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">LoadString</span>(<span style="color: #010001;">hInstance</span>, <span style="color: #010001;">IDS_APP_TITLE</span>, <span style="color: #010001;">szTitle</span>, <span style="color: #010001;">MAX_LOADSTRING</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">LoadString</span>(<span style="color: #010001;">hInstance</span>, <span style="color: #010001;">IDC_WIN32GRAPHICEX1</span>, <span style="color: #010001;">szWindowClass</span>, <span style="color: #010001;">MAX_LOADSTRING</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">MyRegisterClass</span>(<span style="color: #010001;">hInstance</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>// </span>执行应用程序初始化<span lang="EN-US">:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">InitInstance</span> (<span style="color: #010001;">hInstance</span>, <span style="color: #010001;">nCmdShow</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">FALSE</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">hAccelTable</span> = <span style="color: #010001;">LoadAccelerators</span>(<span style="color: #010001;">hInstance</span>, <span style="color: #010001;">MAKEINTRESOURCE</span>(<span style="color: #010001;">IDC_WIN32GRAPHICEX1</span>));</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>// </span>主消息循环<span lang="EN-US">:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">while</span> (<span style="color: #010001;">GetMessage</span>(&amp;<span style="color: #010001;">msg</span>, <span style="color: #010001;">NULL</span>, 0, 0))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">TranslateAccelerator</span>(<span style="color: #010001;">msg</span>.<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hAccelTable</span>, &amp;<span style="color: #010001;">msg</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TranslateMessage</span>(&amp;<span style="color: #010001;">msg</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DispatchMessage</span>(&amp;<span style="color: #010001;">msg</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">return</span> (<span style="color: blue;">int</span>) <span style="color: #010001;">msg</span>.<span style="color: #010001;">wParam</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span></span>函数<span lang="EN-US">: MyRegisterClass()</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span></span>目的<span lang="EN-US">: </span>注册窗口类。</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span></span>注释<span lang="EN-US">:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span>仅当希望</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span>此代码与添加到<span lang="EN-US">Windows 95 </span>中的<span lang="EN-US">&ldquo;RegisterClassEx&rdquo;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span>函数之前的<span lang="EN-US">Win32 </span>系统兼容时，才需要此函数及其用法。调用此函数十分重要，</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;</span></span>这样应用程序就可以获得关联的</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>&ldquo;</span>格式正确的<span lang="EN-US">&rdquo;</span>小图标。</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">ATOM</span><span lang="EN-US"> <span style="color: #010001;">MyRegisterClass</span>(<span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hInstance</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">WNDCLASSEX</span> <span style="color: #010001;">wcex</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">cbSize</span> = <span style="color: blue;">sizeof</span>(<span style="color: #010001;">WNDCLASSEX</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">style</span><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">CS_HREDRAW</span> | <span style="color: #010001;">CS_VREDRAW</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">lpfnWndProc</span><span style="mso-tab-count: 1;"> </span>= <span style="color: #010001;">WndProc</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">cbClsExtra</span><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">cbWndExtra</span><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">hInstance</span><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">hInstance</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">hIcon</span><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadIcon</span>(<span style="color: #010001;">hInstance</span>, <span style="color: #010001;">MAKEINTRESOURCE</span>(<span style="color: #010001;">IDI_WIN32GRAPHICEX1</span>));</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">hCursor</span><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadCursor</span>(<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_ARROW</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">hbrBackground</span><span style="mso-tab-count: 1;">&nbsp; </span>= (<span style="color: #010001;">HBRUSH</span>)(<span style="color: #010001;">COLOR_WINDOW</span>+1);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">lpszMenuName</span><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>= <span style="color: #010001;">MAKEINTRESOURCE</span>(<span style="color: #010001;">IDC_WIN32GRAPHICEX1</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">lpszClassName</span><span style="mso-tab-count: 1;">&nbsp; </span>= <span style="color: #010001;">szWindowClass</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wcex</span>.<span style="color: #010001;">hIconSm</span><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadIcon</span>(<span style="color: #010001;">wcex</span>.<span style="color: #010001;">hInstance</span>, <span style="color: #010001;">MAKEINTRESOURCE</span>(<span style="color: #010001;">IDI_SMALL</span>));</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">RegisterClassEx</span>(&amp;<span style="color: #010001;">wcex</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span></span>函数<span lang="EN-US">: InitInstance(HINSTANCE, int)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span></span>目的<span lang="EN-US">: </span>保存实例句柄并创建主窗口</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span></span>注释<span lang="EN-US">:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>在此函数中，我们在全局变量中保存实例句柄并</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>创建和显示主程序窗口。</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">BOOL</span><span lang="EN-US"> <span style="color: #010001;">InitInstance</span>(<span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hInstance</span>, <span style="color: blue;">int</span> <span style="color: #010001;">nCmdShow</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">HWND</span> <span style="color: #010001;">hWnd</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">hInst</span> = <span style="color: #010001;">hInstance</span>; // </span>将实例句柄存储在全局变量中</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">hWnd</span> = <span style="color: #010001;">CreateWindow</span>(<span style="color: #010001;">szWindowClass</span>, <span style="color: #010001;">szTitle</span>, <span style="color: #010001;">WS_OVERLAPPEDWINDOW</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">CW_USEDEFAULT</span>, 0, <span style="color: #010001;">CW_USEDEFAULT</span>, 0, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">hInstance</span>, <span style="color: #010001;">NULL</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">hWnd</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">FALSE</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">ShowWindow</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">nCmdShow</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: #010001;">UpdateWindow</span>(<span style="color: #010001;">hWnd</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">TRUE</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span></span>函数<span lang="EN-US">: WndProc(HWND, UINT, WPARAM, LPARAM)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span></span>目的<span lang="EN-US">: </span>处理主窗口的消息。</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span>WM_COMMAND<span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>- </span>处理应用程序菜单</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span>WM_PAINT<span style="mso-tab-count: 1;">&nbsp; </span>- </span>绘制主窗口</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">//<span style="mso-spacerun: yes;">&nbsp; </span>WM_DESTROY<span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>- </span>发送退出消息并返回</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">//</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">LRESULT</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span>(<span style="color: #010001;">HWND</span> <span style="color: #010001;">hWnd</span>, <span style="color: #010001;">UINT</span> <span style="color: #010001;">message</span>, <span style="color: #010001;">WPARAM</span> <span style="color: #010001;">wParam</span>, <span style="color: #010001;">LPARAM</span> <span style="color: #010001;">lParam</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">wmId</span>, <span style="color: #010001;">wmEvent</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">PAINTSTRUCT</span> <span style="color: #010001;">ps</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">message</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_COMMAND</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wmId</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LOWORD</span>(<span style="color: #010001;">wParam</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wmEvent</span> = <span style="color: #010001;">HIWORD</span>(<span style="color: #010001;">wParam</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span>分析菜单选择<span lang="EN-US">:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">wmId</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_ABOUT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DialogBox</span>(<span style="color: #010001;">hInst</span>, <span style="color: #010001;">MAKEINTRESOURCE</span>(<span style="color: #010001;">IDD_ABOUTBOX</span>), <span style="color: #010001;">hWnd</span>, <span style="color: #010001;">About</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_EXIT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DestroyWindow</span>(<span style="color: #010001;">hWnd</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">default</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_PAINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">BeginPaint</span>(<span style="color: #010001;">hWnd</span>, &amp;<span style="color: #010001;">ps</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// TODO: </span>在此添加任意绘图代码<span lang="EN-US">...</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndPaint</span>(<span style="color: #010001;">hWnd</span>, &amp;<span style="color: #010001;">ps</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_DESTROY</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PostQuitMessage</span>(0);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">default</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span>(<span style="color: #010001;">hWnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">// &ldquo;</span>关于<span lang="EN-US">&rdquo;</span>框的消息处理程序。</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">INT_PTR</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">About</span>(<span style="color: #010001;">HWND</span> <span style="color: #010001;">hDlg</span>, <span style="color: #010001;">UINT</span> <span style="color: #010001;">message</span>, <span style="color: #010001;">WPARAM</span> <span style="color: #010001;">wParam</span>, <span style="color: #010001;">LPARAM</span> <span style="color: #010001;">lParam</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">UNREFERENCED_PARAMETER</span>(<span style="color: #010001;">lParam</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">message</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_INITDIALOG</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> (<span style="color: #010001;">INT_PTR</span>)<span style="color: #010001;">TRUE</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_COMMAND</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">LOWORD</span>(<span style="color: #010001;">wParam</span>) == <span style="color: #010001;">IDOK</span> || <span style="color: #010001;">LOWORD</span>(<span style="color: #010001;">wParam</span>) == <span style="color: #010001;">IDCANCEL</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndDialog</span>(<span style="color: #010001;">hDlg</span>, <span style="color: #010001;">LOWORD</span>(<span style="color: #010001;">wParam</span>));</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> (<span style="color: #010001;">INT_PTR</span>)<span style="color: #010001;">TRUE</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">return</span> (<span style="color: #010001;">INT_PTR</span>)<span style="color: #010001;">FALSE</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">以后讲解的时候可能就不列出完整的源代码了，因为用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">C++</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">编写</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Win32</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">程序，可能动辄几页的代码，完整列出影响阅读，为了完整，就如前面所言，我已经假定读者都具有相关领域一定的编程经验，将描述的代码放进恰当的位置应该不成问题。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">文字的显示是个复杂的问题，（自有历史以来就复杂）不仅仅是调用几个类似于</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">TextOut</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">，</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">DrawText </span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">，</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">DrawTextEx API</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">那么简单，看过</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">《</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows </span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">图形编程》（</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">参考</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">1</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">）的人应该会有同感，此书是我见过关于</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">下字体，文字显示最深入的一本书，（其实是其他的专著太深看不懂也没有看）。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">至于</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">下普通的文字显示</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">API</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">，</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">《</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Programming Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">》一书按照惯例还是最好的一本。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">下最常用的文字输出</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">API</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">就是前面提到的</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">3</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">个，见下面的例子：</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_PAINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">BeginPaint</span>(<span style="color: #010001;">hWnd</span>, &amp;<span style="color: #010001;">ps</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// TextOut</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TextOut</span>(<span style="color: #010001;">hdc</span>, 0, 0, <span style="color: #010001;">szHelloWorld</span>, (<span style="color: blue;">int</span>)<span style="color: #010001;">_tcslen</span>(<span style="color: #010001;">szHelloWorld</span>));</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// DrawText</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">RECT</span> <span style="color: #010001;">rtText</span> = {0, 50, 100, 100};</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DrawText</span>(<span style="color: #010001;">hdc</span>, <span style="color: #010001;">szHelloWorld</span>, -1, &amp;<span style="color: #010001;">rtText</span>, <span style="color: #010001;">DT_LEFT</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// DrawTextEx</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">rtText</span>.<span style="color: #010001;">top</span> += 50;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">rtText</span>.<span style="color: #010001;">bottom</span> += 50;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DrawTextEx</span>(<span style="color: #010001;">hdc</span>, <span style="color: #010001;">szHelloWorld</span>, -1, &amp;<span style="color: #010001;">rtText</span>, <span style="color: #010001;">DT_LEFT</span>, <span style="color: #010001;">NULL</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndPaint</span>(<span style="color: #010001;">hWnd</span>, &amp;<span style="color: #010001;">ps</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">显示效果如插图</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">1</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: Calibri;">&nbsp;</span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">其实还有几个使用复杂度稍微高一点，但是控制力更强一些的文本输出函数，比如</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">TabbedTextOut,ExtTextOut</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">。（八卦一下：</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">ExtTextOut</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">是少有的将</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Ext</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">放在函数名前表示扩展而不是按照微软惯例将</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Ex</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">表示扩展放在函数名后的函数，估计是设计此函数的人刚到微软工作</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">）</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<h1 style="text-indent: 0cm; margin: 24pt 0cm 0pt;"><span style="color: #365f91;"><span style="mso-bidi-font-family: 宋体; mso-bidi-theme-font: major-fareast;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-family: Cambria;">四、</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">字体</span></span></h1>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">其实字体是个更加复杂的问题。。。。有多少人知道在字体的现实问题上</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">MS,Apple,Adobe</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">的研究人员投入了多少精力啊。。。。今天的</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">TrueType</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">可不是一开始就存在的。。。。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">当然，其实今天我们已经没有必要再去重复研究了，</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">下用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">MS</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">提供的</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">API</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">就好了，一般有两个接口：</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;">HFONT CreateFont(</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>int nHeight,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// height of font</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>int nWidth,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// average character width</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>int nEscapement,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// angle of escapement</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>int nOrientation,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// base-line orientation angle</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>int fnWeight,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// font weight</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>DWORD fdwItalic,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// italic attribute option</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>DWORD fdwUnderline,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// underline attribute option</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>DWORD fdwStrikeOut,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// strikeout attribute option</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>DWORD fdwCharSet,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// character set identifier</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>DWORD fdwOutputPrecision,<span style="mso-spacerun: yes;">&nbsp; </span>// output precision</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>DWORD fdwClipPrecision,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>// clipping precision</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>DWORD fdwQuality,<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// output quality</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>DWORD fdwPitchAndFamily,<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>// pitch and family</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>LPCTSTR lpszFace<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// typeface name</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;">);</span></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">这个接口直接通过超多的参数创建字体，看看参数的数量。。。就知道我说过的字体显示是个复杂问题没有错了。。。。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">另外有个更加人性化的接口，那就是利用结构，本质上没有太大区别，只是从软件接口设计上来说，当参数超过</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">6</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">，</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">7</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">个的时候提供结构传递参数会更加人性化一点，</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">CreateWindow</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">之类的也就是遵循了这样的方式。这也是</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">BS</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">说</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">C++</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">中不提供关键词参数，关键词参数没有那么重要的主要理由之一。（不明白我说的是什么那就忽略此句。。。见</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">D&amp;E6.5</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">）</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="text-indent: 21pt; margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">所谓的用结构创建字体的接口如下：</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;">HFONT CreateFontIndirect(</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>CONST LOGFONT* lplf<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>// characteristics</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;"><span style="font-size: large;">);</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">LOGFONT</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">结构就是前面一个直接创建的接口的参数的堆叠：</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">typedef struct tagLOGFONTW</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LONG</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfHeight</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LONG</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfWidth</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LONG</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfEscapement</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LONG</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfOrientation</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LONG</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfWeight</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BYTE</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfItalic</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BYTE</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfUnderline</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BYTE</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfStrikeOut</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BYTE</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfCharSet</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BYTE</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfOutPrecision</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BYTE</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfClipPrecision</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BYTE</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfQuality</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BYTE</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfPitchAndFamily</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: large;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WCHAR</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lfFaceName</span>[<span style="color: #010001;">LF_FACESIZE</span>];</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">} <span style="color: #010001;">LOGFONTW</span>, *<span style="color: #010001;">PLOGFONTW</span>, <span style="color: #010001;">NEAR</span> *<span style="color: #010001;">NPLOGFONTW</span>, <span style="color: #010001;">FAR</span> *<span style="color: #010001;">LPLOGFONTW</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="line-height: 115%; font-family: Fixedsys; font-size: 12pt; mso-bidi-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">这里列出来的是宽字节版本。参数如此之多，一方面体现了复杂度，一方面也是自由度，其实个人认为有点点设计的累赘了。。。。其实完全没有必要用一个一个整数来表示一个</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">bool</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">值的内容，</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">MS</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">习惯的位标志竟然在此处看不到痕迹。。。估计。。。写字体模块的哥们光研究怎么更好的显示字体了，没有关注接口的设计。。。。。或者，和写</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">TabbedTextOut,ExtTextOut</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">就是同一个人。。。。这个人很显然刚刚来微软。。。。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">参数的含义不一个一个解释了，看</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">MSDN</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">或者《</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">Programming Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">》，见下面一个例子，来自于《</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">Programming Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">》。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">/*---------------------------------------</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>EZFONT.C -- Easy Font Creation</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(c) Charles Petzold, 1998</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>---------------------------------------*/</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">&lt;windows.h&gt;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">&lt;math.h&gt;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"ezfont.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="color: #a31515;" lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">HFONT</span><span lang="EN-US"> <span style="color: #010001;">EzCreateFont</span> (<span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>, <span style="color: #010001;">TCHAR</span> * <span style="color: #010001;">szFaceName</span>, <span style="color: blue;">int</span> <span style="color: #010001;">iDeciPtHeight</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">iDeciPtWidth</span>, <span style="color: blue;">int</span> <span style="color: #010001;">iAttributes</span>, <span style="color: #010001;">BOOL</span> <span style="color: #010001;">fLogRes</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">FLOAT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxDpi</span>, <span style="color: #010001;">cyDpi</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HFONT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LOGFONT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">POINT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pt</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXTMETRIC</span> <span style="color: #010001;">tm</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SaveDC</span> (<span style="color: #010001;">hdc</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetGraphicsMode</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">GM_ADVANCED</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ModifyWorldTransform</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">MWT_IDENTITY</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetViewportOrgEx</span> (<span style="color: #010001;">hdc</span>, 0, 0, <span style="color: #010001;">NULL</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetWindowOrgEx</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>(<span style="color: #010001;">hdc</span>, 0, 0, <span style="color: #010001;">NULL</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">fLogRes</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxDpi</span> = (<span style="color: #010001;">FLOAT</span>) <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">LOGPIXELSX</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cyDpi</span> = (<span style="color: #010001;">FLOAT</span>) <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">LOGPIXELSY</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">else</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxDpi</span> = (<span style="color: #010001;">FLOAT</span>) (25.4 * <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">HORZRES</span>) /</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">HORZSIZE</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cyDpi</span> = (<span style="color: #010001;">FLOAT</span>) (25.4 * <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">VERTRES</span>) /</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">VERTSIZE</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pt</span>.<span style="color: #010001;">x</span> = (<span style="color: blue;">int</span>) (<span style="color: #010001;">iDeciPtWidth</span><span style="mso-spacerun: yes;">&nbsp; </span>* <span style="color: #010001;">cxDpi</span> / 72) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pt</span>.<span style="color: #010001;">y</span> = (<span style="color: blue;">int</span>) (<span style="color: #010001;">iDeciPtHeight</span> * <span style="color: #010001;">cyDpi</span> / 72) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DPtoLP</span> (<span style="color: #010001;">hdc</span>, &amp;<span style="color: #010001;">pt</span>, 1) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfHeight</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= - (<span style="color: blue;">int</span>) (<span style="color: #010001;">fabs</span> (<span style="color: #010001;">pt</span>.<span style="color: #010001;">y</span>) / 10.0 + 0.5) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfWidth</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfEscapement</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfOrientation</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfWeight</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">iAttributes</span> &amp; <span style="color: #010001;">EZ_ATTR_BOLD</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>? 700 : 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfItalic</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">iAttributes</span> &amp; <span style="color: #010001;">EZ_ATTR_ITALIC</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>?<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>1 : 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfUnderline</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">iAttributes</span> &amp; <span style="color: #010001;">EZ_ATTR_UNDERLINE</span> ?<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>1 : 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfStrikeOut</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">iAttributes</span> &amp; <span style="color: #010001;">EZ_ATTR_STRIKEOUT</span> ?<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>1 : 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfCharSet</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;</span>= <span style="color: #010001;">DEFAULT_CHARSET</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfOutPrecision</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfClipPrecision</span><span style="mso-spacerun: yes;">&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfQuality</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfPitchAndFamily</span> = 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lstrcpy</span> (<span style="color: #010001;">lf</span>.<span style="color: #010001;">lfFaceName</span>, <span style="color: #010001;">szFaceName</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> = <span style="color: #010001;">CreateFontIndirect</span> (&amp;<span style="color: #010001;">lf</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">iDeciPtWidth</span> != 0)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> = (<span style="color: #010001;">HFONT</span>) <span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">hFont</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetTextMetrics</span> (<span style="color: #010001;">hdc</span>, &amp;<span style="color: #010001;">tm</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteObject</span> (<span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">hFont</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfWidth</span> = (<span style="color: blue;">int</span>) (<span style="color: #010001;">tm</span>.<span style="color: #010001;">tmAveCharWidth</span> *</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fabs</span> (<span style="color: #010001;">pt</span>.<span style="color: #010001;">x</span>) / <span style="color: #010001;">fabs</span> (<span style="color: #010001;">pt</span>.<span style="color: #010001;">y</span>) + 0.5) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> = <span style="color: #010001;">CreateFontIndirect</span> (&amp;<span style="color: #010001;">lf</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">RestoreDC</span> (<span style="color: #010001;">hdc</span>, -1) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">hFont</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">/*----------------------------------------</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>FONTROT.C -- Rotated Fonts</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(c) Charles Petzold, 1998</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>----------------------------------------*/</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">&lt;windows.h&gt;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"ezfont.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="color: #a31515;" lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">TCHAR</span><span lang="EN-US"> <span style="color: #010001;">szAppName</span> [] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"FontRot"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">TCHAR</span><span lang="EN-US"> <span style="color: #010001;">szTitle</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>[] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"FontRot: Rotated Fonts"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">void</span><span lang="EN-US"> <span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cxArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cyArea</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szString</span> [] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>Rotation"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HFONT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">i</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">LOGFONT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> = <span style="color: #010001;">EzCreateFont</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Times New Roman"</span>), 540, 0, 0, <span style="color: #010001;">TRUE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">GetObject</span> (<span style="color: #010001;">hFont</span>, <span style="color: blue;">sizeof</span> (<span style="color: #010001;">LOGFONT</span>), &amp;<span style="color: #010001;">lf</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteObject</span> (<span style="color: #010001;">hFont</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetBkMode</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TRANSPARENT</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetTextAlign</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TA_BASELINE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetViewportOrgEx</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">cxArea</span> / 2, <span style="color: #010001;">cyArea</span> / 2, <span style="color: #010001;">NULL</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">for</span> (<span style="color: #010001;">i</span> = 0 ; <span style="color: #010001;">i</span> &lt; 12 ; <span style="color: #010001;">i</span> ++)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;</span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfEscapement</span> = <span style="color: #010001;">lf</span>.<span style="color: #010001;">lfOrientation</span> = <span style="color: #010001;">i</span> * 300 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">CreateFontIndirect</span> (&amp;<span style="color: #010001;">lf</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TextOut</span> (<span style="color: #010001;">hdc</span>, 0, 0, <span style="color: #010001;">szString</span>, <span style="color: #010001;">lstrlen</span> (<span style="color: #010001;">szString</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteObject</span> (<span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">GetStockObject</span> (<span style="color: #010001;">SYSTEM_FONT</span>))) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">/*------------------------------------------------</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>FONTDEMO.C -- Font Demonstration Shell Program</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(c) Charles Petzold, 1998</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>------------------------------------------------*/</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">&lt;windows.h&gt;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"EzFont.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"resource.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="color: #a31515;" lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: blue;">void</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">HWND</span>, <span style="color: #010001;">HDC</span>, <span style="color: blue;">int</span>, <span style="color: blue;">int</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">LRESULT</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span> (<span style="color: #010001;">HWND</span>, <span style="color: #010001;">UINT</span>, <span style="color: #010001;">WPARAM</span>, <span style="color: #010001;">LPARAM</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">HINSTANCE</span><span lang="EN-US"> <span style="color: #010001;">hInst</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szAppName</span> [] ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szTitle</span> [] ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">int</span><span lang="EN-US"> <span style="color: #010001;">WINAPI</span> <span style="color: #010001;">WinMain</span> (<span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hInstance</span>, <span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hPrevInstance</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PSTR</span> <span style="color: #010001;">szCmdLine</span>, <span style="color: blue;">int</span> <span style="color: #010001;">iCmdShow</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TCHAR</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szResource</span> [] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"FontDemo"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HWND</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hwnd</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MSG</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">msg</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WNDCLASS</span> <span style="color: #010001;">wndclass</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hInst</span> = <span style="color: #010001;">hInstance</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">style</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">CS_HREDRAW</span> | <span style="color: #010001;">CS_VREDRAW</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpfnWndProc</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= <span style="color: #010001;">WndProc</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">cbClsExtra</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">cbWndExtra</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hInstance</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">hInstance</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hIcon</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadIcon</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDI_APPLICATION</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hCursor</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_ARROW</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hbrBackground</span> = (<span style="color: #010001;">HBRUSH</span>) <span style="color: #010001;">GetStockObject</span> (<span style="color: #010001;">WHITE_BRUSH</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpszMenuName</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">szResource</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpszClassName</span> = <span style="color: #010001;">szAppName</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">RegisterClass</span> (&amp;<span style="color: #010001;">wndclass</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"This program requires Windows NT!"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONERROR</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hwnd</span> = <span style="color: #010001;">CreateWindow</span> (<span style="color: #010001;">szAppName</span>, <span style="color: #010001;">szTitle</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WS_OVERLAPPEDWINDOW</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">CW_USEDEFAULT</span>, <span style="color: #010001;">CW_USEDEFAULT</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">CW_USEDEFAULT</span>, <span style="color: #010001;">CW_USEDEFAULT</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">hInstance</span>, <span style="color: #010001;">NULL</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ShowWindow</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">iCmdShow</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">UpdateWindow</span> (<span style="color: #010001;">hwnd</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">while</span> (<span style="color: #010001;">GetMessage</span> (&amp;<span style="color: #010001;">msg</span>, <span style="color: #010001;">NULL</span>, 0, 0))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;</span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TranslateMessage</span> (&amp;<span style="color: #010001;">msg</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DispatchMessage</span> (&amp;<span style="color: #010001;">msg</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">msg</span>.<span style="color: #010001;">wParam</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">LRESULT</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span> (<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">UINT</span> <span style="color: #010001;">message</span>, <span style="color: #010001;">WPARAM</span> <span style="color: #010001;">wParam</span>, <span style="color: #010001;">LPARAM</span> <span style="color: #010001;">lParam</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">DOCINFO</span><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">di</span> = { <span style="color: blue;">sizeof</span> (<span style="color: #010001;">DOCINFO</span>), <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Font Demo: Printing"</span>) } ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxClient</span>, <span style="color: #010001;">cyClient</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">PRINTDLG</span> <span style="color: #010001;">pd</span> = { <span style="color: blue;">sizeof</span> (<span style="color: #010001;">PRINTDLG</span>) } ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BOOL</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HDC</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span>, <span style="color: #010001;">hdcPrn</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxPage</span>, <span style="color: #010001;">cyPage</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PAINTSTRUCT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ps</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">message</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_COMMAND</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">wParam</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_PRINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Get printer DC</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pd</span>.<span style="color: #010001;">hwndOwner</span> = <span style="color: #010001;">hwnd</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pd</span>.<span style="color: #010001;">Flags</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">PD_RETURNDC</span> | <span style="color: #010001;">PD_NOPAGENUMS</span> | <span style="color: #010001;">PD_NOSELECTION</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">PrintDlg</span> (&amp;<span style="color: #010001;">pd</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">NULL</span> == (<span style="color: #010001;">hdcPrn</span> = <span style="color: #010001;">pd</span>.<span style="color: #010001;">hDC</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Cannot obtain Printer DC"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONEXCLAMATION</span> | <span style="color: #010001;">MB_OK</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Get size of printable area of page</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxPage</span> = <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">HORZRES</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cyPage</span> = <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">VERTRES</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> = <span style="color: #010001;">FALSE</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Do the printer page</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetCursor</span> (<span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_WAIT</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ShowCursor</span> (<span style="color: #010001;">TRUE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> ((<span style="color: #010001;">StartDoc</span> (<span style="color: #010001;">hdcPrn</span>, &amp;<span style="color: #010001;">di</span>) &gt; 0) &amp;&amp; (<span style="color: #010001;">StartPage</span> (<span style="color: #010001;">hdcPrn</span>) &gt; 0))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">cxPage</span>, <span style="color: #010001;">cyPage</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">EndPage</span> (<span style="color: #010001;">hdcPrn</span>) &gt; 0)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> = <span style="color: #010001;">TRUE</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndDoc</span> (<span style="color: #010001;">hdcPrn</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteDC</span> (<span style="color: #010001;">hdcPrn</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ShowCursor</span> (<span style="color: #010001;">FALSE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetCursor</span> (<span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_ARROW</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">fSuccess</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Error encountered during printing"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONEXCLAMATION</span> | <span style="color: #010001;">MB_OK</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_ABOUT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Font Demonstration Program/n"</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"(c) Charles Petzold, 1998"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONINFORMATION</span> | <span style="color: #010001;">MB_OK</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_SIZE</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxClient</span> = <span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cyClient</span> = <span style="color: #010001;">HIWORD</span> (<span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_PAINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">BeginPaint</span> (<span style="color: #010001;">hwnd</span>, &amp;<span style="color: #010001;">ps</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdc</span>, <span style="color: #010001;">cxClient</span>, <span style="color: #010001;">cyClient</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndPaint</span> (<span style="color: #010001;">hwnd</span>, &amp;<span style="color: #010001;">ps</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_DESTROY</span> :</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PostQuitMessage</span> (0) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">显示效果如插图</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">2</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">，一个显示成一圈的</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">Rotation</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">，用最最简单的手段实现绚烂的效果，以</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">Small Basic</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">中的一个星空显示文字的程序为最，这也算是比较突出的例子了。。。。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">这里也不能老是抄袭</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Petzold</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">。。。。。。。我将其转起来。实现旋转的动画：）</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">/*------------------------------------------------</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>FONTDEMO.C -- Font Demonstration Shell Program</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(c) </span>改自<span lang="EN-US">Charles Petzold, 1998</span>，因为不知道其原来是啥版权，这里也不声明自己的版权了</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>------------------------------------------------*/</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">&lt;windows.h&gt;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"EzFont.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"resource.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="color: #a31515;" lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"> <span style="color: blue;">void</span> <span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">HWND</span>, <span style="color: #010001;">HDC</span>, <span style="color: blue;">int</span>, <span style="color: blue;">int</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"> <span style="color: blue;">void</span> <span style="color: #010001;">PaintAnimateOrientation</span>(<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cxArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cyArea</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">LRESULT</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span> (<span style="color: #010001;">HWND</span>, <span style="color: #010001;">UINT</span>, <span style="color: #010001;">WPARAM</span>, <span style="color: #010001;">LPARAM</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">HINSTANCE</span><span lang="EN-US"> <span style="color: #010001;">hInst</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szAppName</span> [] ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szTitle</span> [] ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">WND_WIDTH</span> (800)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">WND_HEIGHT</span> (800)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">int</span><span lang="EN-US"> <span style="color: #010001;">WINAPI</span> <span style="color: #010001;">WinMain</span> (<span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hInstance</span>, <span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hPrevInstance</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PSTR</span> <span style="color: #010001;">szCmdLine</span>, <span style="color: blue;">int</span> <span style="color: #010001;">iCmdShow</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">TCHAR</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szResource</span> [] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"FontDemo"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HWND</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hwnd</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">MSG</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">msg</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">WNDCLASS</span> <span style="color: #010001;">wndclass</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">hInst</span> = <span style="color: #010001;">hInstance</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">style</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">CS_HREDRAW</span> | <span style="color: #010001;">CS_VREDRAW</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpfnWndProc</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= <span style="color: #010001;">WndProc</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">cbClsExtra</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">cbWndExtra</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hInstance</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">hInstance</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hIcon</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadIcon</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDI_APPLICATION</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hCursor</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_ARROW</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hbrBackground</span> = (<span style="color: #010001;">HBRUSH</span>) <span style="color: #010001;">GetStockObject</span> (<span style="color: #010001;">WHITE_BRUSH</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpszMenuName</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">szResource</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpszClassName</span> = <span style="color: #010001;">szAppName</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">RegisterClass</span> (&amp;<span style="color: #010001;">wndclass</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"This program requires Windows NT!"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONERROR</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">hwnd</span> = <span style="color: #010001;">CreateWindow</span> (<span style="color: #010001;">szAppName</span>, <span style="color: #010001;">szTitle</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WS_OVERLAPPEDWINDOW</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">CW_USEDEFAULT</span>, <span style="color: #010001;">CW_USEDEFAULT</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WND_WIDTH</span>, <span style="color: #010001;">WND_HEIGHT</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">hInstance</span>, <span style="color: #010001;">NULL</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">ShowWindow</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">iCmdShow</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">UpdateWindow</span> (<span style="color: #010001;">hwnd</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">while</span> (<span style="color: #010001;">TRUE</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span>就像游戏中一贯的做法</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span>(<span style="color: #010001;">PeekMessage</span> (&amp;<span style="color: #010001;">msg</span>, <span style="color: #010001;">NULL</span>, 0, 0, <span style="color: #010001;">PM_REMOVE</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span>(<span style="color: #010001;">msg</span>.<span style="color: #010001;">message</span> == <span style="color: #010001;">WM_QUIT</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TranslateMessage</span> (&amp;<span style="color: #010001;">msg</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DispatchMessage</span> (&amp;<span style="color: #010001;">msg</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">GetDC</span>(<span style="color: #010001;">hwnd</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PaintAnimateOrientation</span>(<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdc</span>, <span style="color: #010001;">WND_WIDTH</span>, <span style="color: #010001;">WND_HEIGHT</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ReleaseDC</span>(<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdc</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">msg</span>.<span style="color: #010001;">wParam</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">LRESULT</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span> (<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">UINT</span> <span style="color: #010001;">message</span>, <span style="color: #010001;">WPARAM</span> <span style="color: #010001;">wParam</span>, <span style="color: #010001;">LPARAM</span> <span style="color: #010001;">lParam</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">DOCINFO</span><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">di</span> = { <span style="color: blue;">sizeof</span> (<span style="color: #010001;">DOCINFO</span>), <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Font Demo: Printing"</span>) } ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxClient</span>, <span style="color: #010001;">cyClient</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">PRINTDLG</span> <span style="color: #010001;">pd</span> = { <span style="color: blue;">sizeof</span> (<span style="color: #010001;">PRINTDLG</span>) } ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">BOOL</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">HDC</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span>, <span style="color: #010001;">hdcPrn</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxPage</span>, <span style="color: #010001;">cyPage</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PAINTSTRUCT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ps</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">message</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_COMMAND</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">wParam</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_PRINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Get printer DC</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pd</span>.<span style="color: #010001;">hwndOwner</span> = <span style="color: #010001;">hwnd</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pd</span>.<span style="color: #010001;">Flags</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">PD_RETURNDC</span> | <span style="color: #010001;">PD_NOPAGENUMS</span> | <span style="color: #010001;">PD_NOSELECTION</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">PrintDlg</span> (&amp;<span style="color: #010001;">pd</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">NULL</span> == (<span style="color: #010001;">hdcPrn</span> = <span style="color: #010001;">pd</span>.<span style="color: #010001;">hDC</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Cannot obtain Printer DC"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONEXCLAMATION</span> | <span style="color: #010001;">MB_OK</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Get size of printable area of page</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxPage</span> = <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">HORZRES</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cyPage</span> = <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">VERTRES</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> = <span style="color: #010001;">FALSE</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Do the printer page</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetCursor</span> (<span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_WAIT</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ShowCursor</span> (<span style="color: #010001;">TRUE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> ((<span style="color: #010001;">StartDoc</span> (<span style="color: #010001;">hdcPrn</span>, &amp;<span style="color: #010001;">di</span>) &gt; 0) &amp;&amp; (<span style="color: #010001;">StartPage</span> (<span style="color: #010001;">hdcPrn</span>) &gt; 0))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">cxPage</span>, <span style="color: #010001;">cyPage</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">EndPage</span> (<span style="color: #010001;">hdcPrn</span>) &gt; 0)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> = <span style="color: #010001;">TRUE</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndDoc</span> (<span style="color: #010001;">hdcPrn</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteDC</span> (<span style="color: #010001;">hdcPrn</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ShowCursor</span> (<span style="color: #010001;">FALSE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetCursor</span> (<span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_ARROW</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">fSuccess</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Error encountered during printing"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONEXCLAMATION</span> | <span style="color: #010001;">MB_OK</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_ABOUT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Font Demonstration Program/n"</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"(c) Charles Petzold, 1998"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONINFORMATION</span> | <span style="color: #010001;">MB_OK</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_SIZE</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxClient</span> = <span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cyClient</span> = <span style="color: #010001;">HIWORD</span> (<span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_PAINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">BeginPaint</span> (<span style="color: #010001;">hwnd</span>, &amp;<span style="color: #010001;">ps</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-spacerun: yes;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndPaint</span> (<span style="color: #010001;">hwnd</span>, &amp;<span style="color: #010001;">ps</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_DESTROY</span> :</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PostQuitMessage</span> (0) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">/*----------------------------------------</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>FONTROT.C -- Rotated Fonts</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(c) </span>改自<span lang="EN-US">Charles Petzold, 1998</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp; </span>----------------------------------------*/</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">&lt;windows.h&gt;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">&lt;tchar.h&gt;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"ezfont.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="color: #a31515;" lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">TCHAR</span><span lang="EN-US"> <span style="color: #010001;">szAppName</span> [] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"FontRot"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">TCHAR</span><span lang="EN-US"> <span style="color: #010001;">szTitle</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>[] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"FontRot: Rotated Fonts"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">FRAME_PER_SECOND</span> (20)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">TIME_IN_FRAME</span> (1000/<span style="color: #010001;">FRAME_PER_SECOND</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">WHITE_COLOR</span> (<span style="color: #010001;">RGB</span>(255,255,255))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">BLACK_COLOR</span> (<span style="color: #010001;">RGB</span>(0,0,0))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">void</span><span lang="EN-US"> <span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cxArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cyArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">iAnimateOrientation</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szString</span> [] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>Rotation"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HFONT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">i</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">LOGFONT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> = <span style="color: #010001;">EzCreateFont</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Times New Roman"</span>), 540, 0, 0, <span style="color: #010001;">TRUE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">GetObject</span> (<span style="color: #010001;">hFont</span>, <span style="color: blue;">sizeof</span> (<span style="color: #010001;">LOGFONT</span>), &amp;<span style="color: #010001;">lf</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">DeleteObject</span> (<span style="color: #010001;">hFont</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetBkMode</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TRANSPARENT</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetTextAlign</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TA_BASELINE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetViewportOrgEx</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">cxArea</span> / 2, <span style="color: #010001;">cyArea</span> / 2, <span style="color: #010001;">NULL</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="font-family: 新宋体; font-size: large;">&nbsp;&nbsp; </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetTextColor</span>(<span style="color: #010001;">hdc</span>, <span style="color: #010001;">WHITE_COLOR</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">for</span> (<span style="color: #010001;">i</span> = 0 ; <span style="color: #010001;">i</span> &lt; 12 ; <span style="color: #010001;">i</span>++)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfEscapement</span> = <span style="color: #010001;">lf</span>.<span style="color: #010001;">lfOrientation</span> = <span style="color: #010001;">i</span> * 300 + <span style="color: #010001;">iAnimateOrientation</span>-1;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">CreateFontIndirect</span> (&amp;<span style="color: #010001;">lf</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TextOut</span> (<span style="color: #010001;">hdc</span>, 0, 0, <span style="color: #010001;">szString</span>, <span style="color: #010001;">lstrlen</span> (<span style="color: #010001;">szString</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteObject</span> (<span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">GetStockObject</span> (<span style="color: #010001;">SYSTEM_FONT</span>))) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetTextColor</span>(<span style="color: #010001;">hdc</span>, <span style="color: #010001;">BLACK_COLOR</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">for</span> (<span style="color: #010001;">i</span> = 0 ; <span style="color: #010001;">i</span> &lt; 12 ; <span style="color: #010001;">i</span>++)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfEscapement</span> = <span style="color: #010001;">lf</span>.<span style="color: #010001;">lfOrientation</span> = <span style="color: #010001;">i</span> * 300 + <span style="color: #010001;">iAnimateOrientation</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">CreateFontIndirect</span> (&amp;<span style="color: #010001;">lf</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TextOut</span> (<span style="color: #010001;">hdc</span>, 0, 0, <span style="color: #010001;">szString</span>, <span style="color: #010001;">lstrlen</span> (<span style="color: #010001;">szString</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteObject</span> (<span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">GetStockObject</span> (<span style="color: #010001;">SYSTEM_FONT</span>))) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">// By </span>九天雁翎：</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">// </span>主要的新添函数</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">void</span><span lang="EN-US"> <span style="color: #010001;">PaintAnimateOrientation</span>(<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cxArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cyArea</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">DWORD</span> <span style="color: #010001;">dwStartTime</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">DWORD</span> <span style="color: #010001;">dwEndTime</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">DWORD</span> <span style="color: #010001;">dwInTime</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">iIntervalTimeNeed</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">iAnimateOrientation</span> = 0;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">dwStartTime</span> = <span style="color: #010001;">GetTickCount</span>();</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">iAnimateOrientation</span> += 1;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">PaintRoutine</span>(<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdc</span>, <span style="color: #010001;">cxArea</span>, <span style="color: #010001;">cyArea</span>, <span style="color: #010001;">iAnimateOrientation</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US">// </span>帧数控制</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">while</span>(<span style="color: #010001;">GetTickCount</span>() - <span style="color: #010001;">dwStartTime</span> &lt; <span style="color: #010001;">TIME_IN_FRAME</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">Sleep</span>(1);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">其实目前的源代码中有个瑕疵，因为是用透明文字背景画图，用白色的文字覆盖原有文字的时候会出现一些覆盖不了的情况，这个情况导致文字转动后会留有一些背景的尾巴。。。。效果如插图</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">3</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">了，另外。。。之所以使用此种循环画图方式纯粹因为最近看了《</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Window</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">游戏编程大师级技巧》一书，其实用纯</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">timer</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的方式实现如此简单的动画应该也是可行的，并且因为可以依赖消息机制的背景刷新，就不会有此问题。见下面的改良版旋转文字动画：</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">将</span><span style="font-family: Calibri;"><span style="color: #010001; mso-no-proof: yes;" lang="EN-US">SetBkMode</span><span style="mso-no-proof: yes;" lang="EN-US"> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TRANSPARENT</span>) ;</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">一句改为</span><span lang="EN-US"><span style="font-family: Calibri;">SetBkMode (hdc, OPAQUE) <span style="mso-no-proof: yes;">;</span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-no-proof: yes;">倒是可以解决这个问题，但是因为背景的不透明，中间</span><span style="mso-fareast-language: ZH-CN; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">R</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-no-proof: yes;">重合的部分会导致互相的遮掩，这点没有深入研究了，希望有人能给出更好的解决方案。另外，因为是使用</span><span style="mso-fareast-language: ZH-CN; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">GDI</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-no-proof: yes;">，所以在每秒</span><span style="mso-fareast-language: ZH-CN; mso-no-proof: yes;" lang="EN-US"><span style="font-family: Calibri;">20</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-no-proof: yes;">帧重画的时候都会有闪烁。。。。。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">改良版旋转文字动画：</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">/*------------------------------------------------</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>FONTDEMO.C -- Font Demonstration Shell Program</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(c) </span>改自<span lang="EN-US">Charles Petzold, 1998</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;</span><span style="mso-spacerun: yes;">&nbsp;</span>------------------------------------------------*/</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">&lt;windows.h&gt;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"EzFont.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#include</span><span lang="EN-US"> <span style="color: #a31515;">"resource.h"</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="color: #a31515;" lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">void</span><span lang="EN-US"> <span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cxArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cyArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">iAnimateOrientation</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">LRESULT</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span> (<span style="color: #010001;">HWND</span>, <span style="color: #010001;">UINT</span>, <span style="color: #010001;">WPARAM</span>, <span style="color: #010001;">LPARAM</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">HINSTANCE</span><span lang="EN-US"> <span style="color: #010001;">hInst</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szAppName</span> [] ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">extern</span><span lang="EN-US"> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szTitle</span> [] ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">WND_WIDTH</span> (800)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">WND_HEIGHT</span> (800)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">int</span><span lang="EN-US"> <span style="color: #010001;">WINAPI</span> <span style="color: #010001;">WinMain</span> (<span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hInstance</span>, <span style="color: #010001;">HINSTANCE</span> <span style="color: #010001;">hPrevInstance</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PSTR</span> <span style="color: #010001;">szCmdLine</span>, <span style="color: blue;">int</span> <span style="color: #010001;">iCmdShow</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">TCHAR</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szResource</span> [] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"FontDemo"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HWND</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hwnd</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">MSG</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">msg</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">WNDCLASS</span> <span style="color: #010001;">wndclass</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">hInst</span> = <span style="color: #010001;">hInstance</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">style</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">CS_HREDRAW</span> | <span style="color: #010001;">CS_VREDRAW</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpfnWndProc</span><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>= <span style="color: #010001;">WndProc</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">cbClsExtra</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">cbWndExtra</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>= 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hInstance</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">hInstance</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hIcon</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadIcon</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDI_APPLICATION</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hCursor</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_ARROW</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">hbrBackground</span> = (<span style="color: #010001;">HBRUSH</span>) <span style="color: #010001;">GetStockObject</span> (<span style="color: #010001;">WHITE_BRUSH</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpszMenuName</span><span style="mso-spacerun: yes;">&nbsp; </span>= <span style="color: #010001;">szResource</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">wndclass</span>.<span style="color: #010001;">lpszClassName</span> = <span style="color: #010001;">szAppName</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">RegisterClass</span> (&amp;<span style="color: #010001;">wndclass</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"This program requires Windows NT!"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONERROR</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">hwnd</span> = <span style="color: #010001;">CreateWindow</span> (<span style="color: #010001;">szAppName</span>, <span style="color: #010001;">szTitle</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WS_OVERLAPPEDWINDOW</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">CW_USEDEFAULT</span>, <span style="color: #010001;">CW_USEDEFAULT</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WND_WIDTH</span>, <span style="color: #010001;">WND_HEIGHT</span>,</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">hInstance</span>, <span style="color: #010001;">NULL</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">ShowWindow</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">iCmdShow</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">UpdateWindow</span> (<span style="color: #010001;">hwnd</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetTimer</span>(<span style="color: #010001;">hwnd</span>, 1, 50, <span style="color: #010001;">NULL</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>// </span>主消息循环<span lang="EN-US">:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">while</span> (<span style="color: #010001;">GetMessage</span>(&amp;<span style="color: #010001;">msg</span>, <span style="color: #010001;">NULL</span>, 0, 0))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TranslateMessage</span>(&amp;<span style="color: #010001;">msg</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DispatchMessage</span>(&amp;<span style="color: #010001;">msg</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">msg</span>.<span style="color: #010001;">wParam</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: #010001;" lang="EN-US">LRESULT</span><span lang="EN-US"> <span style="color: #010001;">CALLBACK</span> <span style="color: #010001;">WndProc</span> (<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">UINT</span> <span style="color: #010001;">message</span>, <span style="color: #010001;">WPARAM</span> <span style="color: #010001;">wParam</span>, <span style="color: #010001;">LPARAM</span> <span style="color: #010001;">lParam</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">DOCINFO</span><span style="mso-spacerun: yes;">&nbsp; </span><span style="color: #010001;">di</span> = { <span style="color: blue;">sizeof</span> (<span style="color: #010001;">DOCINFO</span>), <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Font Demo: Printing"</span>) } ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxClient</span>, <span style="color: #010001;">cyClient</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">PRINTDLG</span> <span style="color: #010001;">pd</span> = { <span style="color: blue;">sizeof</span> (<span style="color: #010001;">PRINTDLG</span>) } ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">BOOL</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HDC</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span>, <span style="color: #010001;">hdcPrn</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxPage</span>, <span style="color: #010001;">cyPage</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">PAINTSTRUCT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ps</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: blue;">int</span> <span style="color: #010001;">iAnimateOrientation</span> = 0;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">message</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_COMMAND</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">switch</span> (<span style="color: #010001;">wParam</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_PRINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Get printer DC</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pd</span>.<span style="color: #010001;">hwndOwner</span> = <span style="color: #010001;">hwnd</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">pd</span>.<span style="color: #010001;">Flags</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">PD_RETURNDC</span> | <span style="color: #010001;">PD_NOPAGENUMS</span> | <span style="color: #010001;">PD_NOSELECTION</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">PrintDlg</span> (&amp;<span style="color: #010001;">pd</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">NULL</span> == (<span style="color: #010001;">hdcPrn</span> = <span style="color: #010001;">pd</span>.<span style="color: #010001;">hDC</span>))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Cannot obtain Printer DC"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONEXCLAMATION</span> | <span style="color: #010001;">MB_OK</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Get size of printable area of page</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxPage</span> = <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">HORZRES</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cyPage</span> = <span style="color: #010001;">GetDeviceCaps</span> (<span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">VERTRES</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> = <span style="color: #010001;">FALSE</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Do the printer page</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetCursor</span> (<span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_WAIT</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ShowCursor</span> (<span style="color: #010001;">TRUE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> ((<span style="color: #010001;">StartDoc</span> (<span style="color: #010001;">hdcPrn</span>, &amp;<span style="color: #010001;">di</span>) &gt; 0) &amp;&amp; (<span style="color: #010001;">StartPage</span> (<span style="color: #010001;">hdcPrn</span>) &gt; 0))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdcPrn</span>, <span style="color: #010001;">cxPage</span>, <span style="color: #010001;">cyPage</span>, <span style="color: #010001;">iAnimateOrientation</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">EndPage</span> (<span style="color: #010001;">hdcPrn</span>) &gt; 0)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fSuccess</span> = <span style="color: #010001;">TRUE</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndDoc</span> (<span style="color: #010001;">hdcPrn</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteDC</span> (<span style="color: #010001;">hdcPrn</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ShowCursor</span> (<span style="color: #010001;">FALSE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SetCursor</span> (<span style="color: #010001;">LoadCursor</span> (<span style="color: #010001;">NULL</span>, <span style="color: #010001;">IDC_ARROW</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (!<span style="color: #010001;">fSuccess</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, </span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Error encountered during printing"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONEXCLAMATION</span> | <span style="color: #010001;">MB_OK</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">IDM_ABOUT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">MessageBox</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Font Demonstration Program/n"</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"(c) Charles Petzold, 1998"</span>),</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">szAppName</span>, <span style="color: #010001;">MB_ICONINFORMATION</span> | <span style="color: #010001;">MB_OK</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_SIZE</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cxClient</span> = <span style="color: #010001;">LOWORD</span> (<span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">cyClient</span> = <span style="color: #010001;">HIWORD</span> (<span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_PAINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">BeginPaint</span> (<span style="color: #010001;">hwnd</span>, &amp;<span style="color: #010001;">ps</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PaintRoutine</span>(<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdc</span>, <span style="color: #010001;">WND_WIDTH</span>, <span style="color: #010001;">WND_HEIGHT</span>, <span style="color: #010001;">iAnimateOrientation</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndPaint</span> (<span style="color: #010001;">hwnd</span>, &amp;<span style="color: #010001;">ps</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_TIMER</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">iAnimateOrientation</span> += 1;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">InvalidateRect</span>(<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">NULL</span>, <span style="color: #010001;">TRUE</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_DESTROY</span> :</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PostQuitMessage</span> (0) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">return</span> <span style="color: #010001;">DefWindowProc</span> (<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">message</span>, <span style="color: #010001;">wParam</span>, <span style="color: #010001;">lParam</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">#define</span><span lang="EN-US"> <span style="color: #010001;">BLACK_COLOR</span> (<span style="color: #010001;">RGB</span>(0,0,0))</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">TCHAR szAppName [] = TEXT (<span style="color: #a31515;">"FontRot"</span>) ;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">TCHAR szTitle<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>[] = TEXT (<span style="color: #a31515;">"FontRot: Rotated Fonts"</span>) ;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="color: blue;" lang="EN-US">void</span><span lang="EN-US"> <span style="color: #010001;">PaintRoutine</span> (<span style="color: #010001;">HWND</span> <span style="color: #010001;">hwnd</span>, <span style="color: #010001;">HDC</span> <span style="color: #010001;">hdc</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cxArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">cyArea</span>, <span style="color: blue;">int</span> <span style="color: #010001;">iAnimateOrientation</span>)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">static</span> <span style="color: #010001;">TCHAR</span> <span style="color: #010001;">szString</span> [] = <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>Rotation"</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">HFONT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">int</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">i</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">LOGFONT</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span> ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">hFont</span> = <span style="color: #010001;">EzCreateFont</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TEXT</span> (<span style="color: #a31515;">"Times New Roman"</span>), 540, 0, 0, <span style="color: #010001;">TRUE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">GetObject</span> (<span style="color: #010001;">hFont</span>, <span style="color: blue;">sizeof</span> (<span style="color: #010001;">LOGFONT</span>), &amp;<span style="color: #010001;">lf</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">DeleteObject</span> (<span style="color: #010001;">hFont</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetBkMode</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TRANSPARENT</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetTextAlign</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">TA_BASELINE</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetViewportOrgEx</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">cxArea</span> / 2, <span style="color: #010001;">cyArea</span> / 2, <span style="color: #010001;">NULL</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">SetTextColor</span>(<span style="color: #010001;">hdc</span>, <span style="color: #010001;">BLACK_COLOR</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">for</span> (<span style="color: #010001;">i</span> = 0 ; <span style="color: #010001;">i</span> &lt; 12 ; <span style="color: #010001;">i</span>++)</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>{</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">lf</span>.<span style="color: #010001;">lfEscapement</span> = <span style="color: #010001;">lf</span>.<span style="color: #010001;">lfOrientation</span> = <span style="color: #010001;">i</span> * 300 + <span style="color: #010001;">iAnimateOrientation</span>;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">CreateFontIndirect</span> (&amp;<span style="color: #010001;">lf</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">TextOut</span> (<span style="color: #010001;">hdc</span>, 0, 0, <span style="color: #010001;">szString</span>, <span style="color: #010001;">lstrlen</span> (<span style="color: #010001;">szString</span>)) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">DeleteObject</span> (<span style="color: #010001;">SelectObject</span> (<span style="color: #010001;">hdc</span>, <span style="color: #010001;">GetStockObject</span> (<span style="color: #010001;">SYSTEM_FONT</span>))) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span>}</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">注意几个改动的地方，其实这个版本应该是最先的思路。。。。。。及利用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Timer</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">及</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">消息机制来完成动画绘制，这样可以利用背景擦除消息来擦除背景，不需要重新自己用白色文字覆盖上一帧的文字，也不会有拖尾现象，但是，因为总是重复擦除然后重绘，所以会有闪烁。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">另外，从理论上来说，直接将绘制放在擦除背景消息中，如下：</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_PAINT</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">BeginPaint</span> (<span style="color: #010001;">hwnd</span>, &amp;<span style="color: #010001;">ps</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体; font-size: large;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">EndPaint</span> (<span style="color: #010001;">hwnd</span>, &amp;<span style="color: #010001;">ps</span>) ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0 ;</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: blue;">case</span> <span style="color: #010001;">WM_ERASEBKGND</span>:</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">hdc</span> = <span style="color: #010001;">GetDC</span>(<span style="color: #010001;">hwnd</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">Rectangle</span>(<span style="color: #010001;">hdc</span>, 0, 0, <span style="color: #010001;">WND_WIDTH</span>, <span style="color: #010001;">WND_HEIGHT</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">PaintRoutine</span>(<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdc</span>, <span style="color: #010001;">WND_WIDTH</span>, <span style="color: #010001;">WND_HEIGHT</span>, <span style="color: #010001;">iAnimateOrientation</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ReleaseDC</span>(<span style="color: #010001;">hwnd</span>, <span style="color: #010001;">hdc</span>);</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: large;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> 0;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">闪烁会小一点，因为擦除背景到重新绘制的间隔更短了（放在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">WM_PAINT</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">中还有个重新分配消息的过程），但是事实上看不怎么出来。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">随机文字的那个例子比较简单，这里不再实现了。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri; font-size: large;">&nbsp;</span></span></p>
<h1 style="text-indent: 0cm; margin: 24pt 0cm 0pt;"><span style="color: #365f91;"><span style="mso-bidi-font-family: 宋体; mso-bidi-theme-font: major-fareast;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-family: Cambria;">五、</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">参考：</span></span></h1>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">1. </span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">《</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows </span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">图形编程》第</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">14</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">15</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">章（原版名《</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows Graphics Programming Win32 GDI and DirectDraw</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">》，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Feng Yuan</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">著，机械工业出版社</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">2.</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">《</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Programming Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">》</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;"> Fifth Edition</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，</span><span style="font-family: Calibri;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">Chapter4,17 </span><span lang="EN-US">Charles Petzold</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">著，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Microsoft Press</span></span></span></p></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>插图1： </p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/555576/o_082609_1556_11.jpg" alt="" /> </p>
<p>&nbsp;</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/555576/o_082609_1556_12.jpg" alt="" /> </p>
<p>&nbsp;</p>
<p>插图3： </p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/555576/o_082609_1556_13.jpg" alt="" /> </p>
<p>&nbsp;</p>
<p style="text-align: right"><a href="http://www.jtianling.com"><strong>write by <span style="font-family:宋体">九天雁翎</span>(JTianLing) -- www.jtianling.com</strong></a> </p>
