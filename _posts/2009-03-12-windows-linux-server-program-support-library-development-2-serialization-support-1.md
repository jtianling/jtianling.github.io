---
layout: post
title: windows/linux服务器程序支持库的开发（2）--序列化支持(1)
categories:
- "网络技术"
tags:
- "序列化"
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '10'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---

序列化用于实现跨平台、跨进程的数据保存与传输，它将数据转为统一的二进制格式，是网络通信和程序交互的基础。

<!-- more -->

# [windows/linux服务器程序支持库的开发](/gnu的幽默.html)（2）--序列化支持(1)

[**write by 九天雁翎 (JTianLing) -- www.jtianling.com**](http://www.jtianling.com)

[**讨论新闻组及文件**](http://groups.google.com/group/jiutianfile/)

没有工作前，不知道序列化的作用。。。。虽然那时候学习《Programming with MFC》的时候，也知道CArchive，CObject等东西，但是没有太意识到其作用。但是，如前所述，我工作的第一件事情，就是了解公司的序列化类。从当时的一无所知，到现在也慢慢理解了一些序列化的作用了。说起来，自从工作以来因为当时做文件系统后后来的程序补丁，我应经在公司的序列化类以外额外实现了两个独立的序列化类了，分别是文件序列化和内存序列化。

这里也顺便讲讲序列化吧，虽然不算太难，也不算太复杂，但是这样越是基础的东西越是支持着程序：）没有还真不行。

序列化的作用包括，实现操作系统，硬件平台无关的数据保存和传输。从网络传输角度来讲解决诸如大头，小头等问题。目前我自己的感受还有，对于保存数据和读取数据使用同一套接口，简化了数据结构的管理，方便使用。虽然，序列化的作用一般是用来做永久保存的，在《深入浅出MFC》中，侯捷就将其中的序列化技术讲解称为“VC++六大关键技术”，事实上，序列化的作用不仅仅如此，比如我以前不就写过一个内存序列化类吧：）公司还有一个网络序列化类，即便在MFC中，也有可以序列化的CMemFile，事实上，序列化还是一种二进制的交流方式。：）

最典型的网络程序，就更好理解了，网络上交流的其实都是二进制的数据，从一端到另外一端，大家要有统一的格式支持才能和谐-_-！不仅仅是字符串的编码需要一致，字节的顺序需要一致，每个位置是什么值自然也需要一一指定好，一般而言，对于网络程序，在我们公司，对于序列化成一个包，我们叫打包，从一个网络包反序列化（似乎也有人叫串行化），我们叫解包。

这种二进制交流的方式不仅限于网络程序，任何程序间的交流都有可能用到，我碰到另外一个典型情况是一个Python脚本希望将一些数据经过一段C++程序，然后再放到另外一段Python脚本中去，这时当然可以通过Python的C API将所有的数据都一个一个转成C变量保存下来然后传出去，由C++程序运行时保存，然后再通过Python的C API一一转成Python的变量，这样做有很多不好的地方，其一是Python脚本间传递的数据对于C++程序来说不透明，任何改变都需要C++程序进行相应的更改，另外是每个变量都通过Python的C API去转换效率不高。其实这里就可以利用序列化成二进制数据来传输，其上两个缺点都会消失。顺便提一下，在Python中可以通过struct库的pack,unpack函数进行简单数据的序列化，通过marshal库来进行复杂对象的序列化（可是这个库好像已经不被推荐，但是我当时在实际工作中使用的就是这个），有更先进的pickle(有更快的C语言版本cPickle)，shelve可用。从这点来看，又会感叹Python的库实在是太多，往往不是没有你想要的库，而是由于库太多，你不知道哪个好用-_-!

[**write by 九天雁翎 (JTianLing) -- www.jtianling.com**](http://www.jtianling.com)
