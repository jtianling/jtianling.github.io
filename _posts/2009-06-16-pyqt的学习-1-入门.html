---
layout: post
title: PyQt的学习（1） 入门
categories:
- Python
tags:
- PyQt
- Qt
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '26'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---
<br />
<h1>PyQt的学习（1） 入门<br />
</h1>
<p style="text-align: right"><a href="http://www.jtianling.com">write by <span style="font-family:宋体">九天雁翎</span>(JTianLing) -- www.jtianling.com</a><span style="color:#c0504d; text-decoration:underline"><strong><br />
</strong></span></p>
<p style="text-align: right"><a href="http://groups.google.com/group/jiutianfile/">讨论新闻组及文件</a></p>
<p style="text-align: right">
 </p>
<h1>动机：<br />
</h1>
<p>刚学习完Python,借鉴以前学习C++时的经验，当时用MFC巩固了C++的学习，并且可以做出实际的程序，给了我继续学习的动力，学习Qt也是出于类似的目的。</p>
<p>为什么我要写，为了学习。不仅仅为了将来有个可以用的，好用的跨平台GUI库，也为了用Python快速开发时也能有个GUI库，但是又不喜欢TK，那么，综合考虑，Qt也就是不错的考虑了。</p>
<p>
 </p>
<h1>综述<br />
</h1>
<p>这些文章基本遵循《C++ GUI Qt 4编程》第2版（C++ GUI Programming with Qt4, Second Edition）的流程，文字可能会很少，除非自己想出的例子，不然例子就是书中C++例子的Python版本，<strong>基本上，可以以此书为蓝本对照这些文章中的例子来看。<br />
</strong></p>
<p>虽然用途不算太大，但是考虑到PyQt的好教材是如此的稀少，这样也不算完全没有价值吧，毕竟还有只明白Python不懂C++的人。</p>
<p>这里有一本PyQt的书《<a href="http://www.commandprompt.com/community/pyqt/"><span style="color:#4f81bd; text-decoration:underline">GUI Programming with Python: Qt Edition</span></a>》，但是老到基本上是属于Qt2时代的东西了。</p>
<p>至于PyQt 嘛，你不会不知道到google上搜索一下，取得其下载地址吧？安装方式如此简单，点击下一步以后，就可以在Python中通过import PyQt4来使用这个库了。</p>
<p>
 </p>
<h1>HelloWorld<br />
</h1>
<p>自从K&R;后，好像所有的程序语言讲解都是以HelloWorld开始，我们也不免俗吧,我们从HelloQT开始。并且，这个例子也可以作为一个测试程序，测试一下看看安装PyQt是否成功。</p>
<p>HelloQt.pyw</p>
<p><span style="font-family:新宋体; font-size:14pt">1 <span style="color:#a020f0">import</span> sys<br />2 <span style="color:#a020f0">from</span> PyQt4 <span style="color:#a020f0">import</span> QtGui<br />3 <br />4 <br />5 app = QtGui.QApplication(sys.argv)<br />6 label = QtGui.QLabel("<span style="color:fuchsia">Hello Qt!</span>")<br />7 label.show()<br />8 <br />9 sys.exit(app.exec_())<br />
</span></p>
<p>
 </p>
<p>这样，就是一个现实"Hello Qt"的窗口，利用了QLabel部件。--说明一下，Qt中将MFC中常常称作控件（control）的东西称作部件（Widget），其实一回事。</p>
<p>这里也可以看出Qt的足够简洁，我很欣赏，而其对象使用的风格和方式也是比较好的，不然，尝试用VS生成一个类似的MFC程序试试？^^</p>
<p>其实这里还不足以见证Qt的强大,看下面的例子，QLabel竟然至此HTML样式。。。。。-_-!</p>
<p>MoreHelloQt.pyw</p>
<p><span style="font-family:新宋体; font-size:14pt">1 <span style="color:#a020f0">import</span> sys<br />2 <span style="color:#a020f0">from</span> PyQt4 <span style="color:#a020f0">import</span> QtGui<br />3 <br />4 <br />5 app = QtGui.QApplication(sys.argv)<br />6 label = QtGui.QLabel("<span style="color:fuchsia"><br />
<h2><i>Hello </i><font color="red">QT!</font></h2>
<p></span>") #这里我没有办法让CSDN不将其解释为HTML。。。所以，参考界面的源代码看看是什么吧<br />7 label.show()<br />8 <br />9 sys.exit(app.exec_())<br />
</span></p>
<p>
 </p>
<p>强大吧：）</p>
<p>
 </p>
<h1>Qt(C++) VS PyQt<br />
</h1>
<p>这里，顺便比较一下PyQt与普通Qt（C++）生成程序的区别。一般而言，两者速度没有可比性，但是，速度在这里不是主要问题，原因在于PyQt的核心也就是Qt库，那是用C++写的，这样，一般而言不会占用太多时间的逻辑代码速度慢点，不会成为瓶颈，使得PyQt的程序可以跑得足够的快。但是，使用方式上，却没有失去Python的优雅语法，快速开发的能力，也结合了Qt的强大，呵呵，广告用语。。。。。。。。。。。来点实在的。</p>
<p><span style="color:#a020f0; font-family:Courier New"><br />
</span></p>
<p>左边的是用C++开发出来的Qt程序，右边是PyQt开发出来的程序，由于都是使用了同一个库，看不出两者的区别。基本上，多懂了一种语言，就多了一种选择。。。比如说这个时候的Python。</p>
<p>
 </p>
<h1>建立连接<br />
</h1>
<p>quit.pyw</p>
<p><span style="font-family:新宋体; font-size:14pt"><span style="color:#804040"> 1 </span>import sys<br /><span style="color:#804040"> 2 </span>from PyQt4 import QtCore, QtGui<br /><span style="color:#804040"> 3 </span><br /><span style="color:#804040"> 4 </span>app = QtGui.QApplication(sys.argv)<br /><span style="color:#804040"> 5 </span><br /><span style="color:#804040"> 6 </span>quit = QtGui.QPushButton("<span style="color:fuchsia">Quit</span>")<br /><span style="color:#804040"> 7 </span><br /><span style="color:#804040"> 8 </span>QtCore.QObject.connect(quit, QtCore.SIGNAL("<span style="color:fuchsia">clicked()</span>"),<br /><span style="color:#804040"> 9 </span>                       app, QtCore.SLOT("<span style="color:fuchsia">quit()</span>"))<br /><span style="color:#804040">10 </span><br /><span style="color:#804040">11 </span>quit.show()<br /><span style="color:#804040">12 </span>sys.exit(app.exec_())<br />
</span></p>
<p>
 </p>
<p>这里展示了Qt的信槽模式，有点怪异的是，在Python中，信号，槽，都是用字符串来表示-_-!这点似乎有点奇怪。</p>
<p>我还不懂Qt的原理，也没有看过Qt的源代码，但是总是感觉这里奇怪，于是我翻看了一下Qt的SIGNAL，SLOT宏，于是一切也就没有那么奇怪了。</p>
<p># define SLOT(a) qFlagLocation("1"#a QLOCATION)</p>
<p># define SIGNAL(a) qFlagLocation("2"#a QLOCATION)</p>
<p>本来，他们就是以字符串来表示的。。。。。。。。我原本还以为在Qt中这些都是通过回调函数的形式出现的呢。。。。。。。汗-_-!真那样，与一般的WxWidget原理有啥不同啊。。。呵呵，看来，Qt的原理还得好好理解理解。其实就现在的信息看，无非也就是Observer模式的一种扩展，再难也难不到哪儿去。</p>
<p>
 </p>
<p>在PyQt的安装包中，有个tutorial，展示了更复杂一点的button使用方法，可以参考参考</p>
<p>morequit.pyw</p>
<p><span style="font-family:新宋体; font-size:14pt"> 1 <span style="color:#a020f0">import</span> sys<br /> 2 <span style="color:#a020f0">from</span> PyQt4 <span style="color:#a020f0">import</span> QtCore, QtGui<br /> 3 <br /> 4 <br /> 5 app = QtGui.QApplication(sys.argv)<br /> 6 <br /> 7 quit = QtGui.QPushButton("<span style="color:fuchsia">Quit</span>")<br /> 8 quit.resize(75, 30)<br /> 9 quit.setFont(QtGui.QFont("<span style="color:fuchsia">Times</span>", 18, QtGui.QFont.Bold))<br />10 <br />11 QtCore.QObject.connect(quit, QtCore.SIGNAL("<span style="color:fuchsia">clicked()</span>"),<br />12                        app, QtCore.SLOT("<span style="color:fuchsia">quit()</span>"))<br />13 <br />14 quit.show()<br />15 sys.exit(app.exec_())<br />
</span></p>
<p>
 </p>
<p>分别是设置Button的大小和按钮文字的字体和样式，这个阶段就不深抠细节了，了解概念和Qt大概的风格就好。</p>
<p>
 </p>
<h1>窗口部件的布局<br />
</h1>
<p>用过MFC的人都知道在MFC中创建一个随窗口动态改变控件大小的程序的困难。。。。。。需要每次OnMove,OnSize的时候去重新计算控件的大小，为了保持布局合理，最好还得将所有控件的位置用百分比来计算，痛苦不言而喻，可以参考我写的正则表达式测试程序0.3版（要么就是更老的版本）。但是在Qt中好像就要简单的比较多。看看示例：</p>
<p>layout.pyw</p>
<p><span style="font-family:新宋体; font-size:14pt"> 1 <span style="color:#a020f0">import</span> sys<br /> 2 <span style="color:#a020f0">from</span> PyQt4 <span style="color:#a020f0">import</span> QtCore, QtGui<br /> 3 <br /> 4 app = QtGui.QApplication(sys.argv)<br /> 5 <br /> 6 window = QtGui.QWidget()<br /> 7 <br /> 8 spinBox = QtGui.QSpinBox()<br /> 9 slider = QtGui.QSlider(QtCore.Qt.Horizontal)<br />10 spinBox.setRange(0, 130)<br />11 slider.setRange(0, 130)<br />12 <br />13 QtCore.QObject.connect(spinBox, QtCore.SIGNAL("<span style="color:fuchsia">valueChanged(int)</span>"),<br />14                        slider, QtCore.SLOT("<span style="color:fuchsia">setValue(int)</span>"))<br />15 QtCore.QObject.connect(slider, QtCore.SIGNAL("<span style="color:fuchsia">valueChanged(int)</span>"),<br />16                        spinBox, QtCore.SLOT("<span style="color:fuchsia">setValue(int)</span>"))<br />17 spinBox.setValue(35)<br />18 <br />19 layout = QtGui.QHBoxLayout()<br />20 layout.addWidget(spinBox)<br />21 layout.addWidget(slider)<br />22 window.setLayout(layout)<br />23 <br />24 window.show()<br />25 sys.exit(app.exec_())<br />
</span></p>
<p>
 </p>
<p>行了，基本上PyQt的程序是怎么样子的，大概有个了解了：），下面就开始慢慢来了。我也需要睡觉去了。</p>
<p>
 </p>
<p>
 </p>
<p>
 </p>
<p style="text-align: right"><a href="http://www.jtianling.com">write by <span style="font-family:宋体">九天雁翎</span>(JTianLing) -- www.jtianling.com</a></p>
