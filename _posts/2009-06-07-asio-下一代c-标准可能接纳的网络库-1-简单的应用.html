---
layout: post
title: ASIO—下一代C++标准可能接纳的网络库（1）简单的应用
categories:
- "网络技术"
tags:
- ASIO
- Boost
- C++
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '31'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---
<br />
<h1 style="margin: 24pt 0cm 0pt 21pt; text-indent: 0cm; mso-list: none;"><span style="font-family: 宋体;"><span style="color: #365f91;"><span lang="EN-US">ASIO&mdash;</span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">下一代</span><span lang="EN-US">C++</span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">标准可能接纳的网络库（</span><span lang="EN-US">1</span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">）简单的应用</span></span></span></h1>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://www.jtianling.com"><span style="font-size: large;"><span style="color: #800080;"><span style="font-family: 宋体;"><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps;">write by </span></strong><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps;">九天雁翎</span><span style="letter-spacing: 0.25pt; font-variant: small-caps;">(JTianLing) -- www.jtianling.com</span></strong></span></span></span></a></span><strong><span style="text-decoration: underline;"><span style="color: #c0504d; letter-spacing: 0.25pt; font-variant: small-caps; mso-themecolor: accent2; mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://groups.google.com/group/jiutianfile/"><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US"><span style="font-size: large; color: #800080;">讨论新闻组及文件</span></span></span></strong></a></span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></p>
<h1 style="margin: 24pt 0cm 0pt 21pt;"><span style="color: #365f91;"><span style="mso-bidi-font-family: 宋体; mso-bidi-theme-font: major-fareast;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-family: 宋体;">一、</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">综述</span></span></h1>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">第一次看</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的文档，觉得非常详细，可是因为</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">库的惯例，与其他</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">库结合的比较紧密，而个人除了对一些很基础的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">库</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">,</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">比如智能指针，还有正则表达式</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::regex</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">有所了解外，以前对</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">库还是没有太多的了解的，为了很好的学习和了解</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，我做了很多前期工作，到今天，总算可以正式的开始</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的学习了，另外，今天，从使用开始，对</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的学习作为前段时间网络编程方面学习的一种延续，不是像其他</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">库一样，仅仅会使用即可，我要的是深入其原理及精髓。。。。（其实已经知道</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">windows</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下使用的是完成端口，在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">Linux</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下使用的是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">EPoll</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">）</span></span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">基本上，</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">的文档很详尽也是有道理的（从</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">Overview,</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">到</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">Tutorial</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">到</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">Examples</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">到</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">Reference</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">一共</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">870</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">页），作为一个封装良好的网络</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">(</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">接口？</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">)</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">库，虽然对普通的网络接口进行了很详尽的封装，但是因为网络程序本身的复杂性，</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">在使用方式上的复杂度还是比较大，这在</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">B.S.</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">的语言中是，绝对复杂的事情需要相对复杂的工具来解决。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: large; font-family: 宋体;">&nbsp;</span></span></p>
<h1 style="margin: 24pt 0cm 0pt 21pt;"><span style="color: #365f91;"><span style="mso-bidi-font-family: 宋体; mso-bidi-theme-font: major-fareast;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-family: 宋体;">二、</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp; </span></span></span><span lang="EN-US"><span style="font-family: 宋体;">Tutorial</span></span></span></h1>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">首先，从使用上对</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">ASIO</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">库进行一定的了解，因为文档如此的详尽，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">Tutorial</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">解释如此的精细，我就不再干</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">C-C,C-V</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的工作了，也就为</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">E</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">文不太好的兄弟们稍微解释一下各个例子，大家可以对照</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::asio</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的文档来看。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<h2 style="margin: 13pt 0cm 13pt 21pt;"><span style="mso-fareast-font-family: Cambria; mso-fareast-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Cambria; mso-bidi-theme-font: major-latin;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">1.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: large;"><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">Timer.1 - Using a timer synchronously</span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">（使用同步定时器）</span></span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></h2>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">就连</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">库</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">的使用也是从</span><span lang="EN-US">&rdquo;Hello world&rdquo;</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">开始，可见</span><span lang="EN-US">K&amp;R</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">影响之深远。此例解释了展示了</span><span lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">库的基本使用，包括包含</span><span lang="EN-US">boost/asio.hpp</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">头文件，使用</span><span lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">需要有</span><span lang="EN-US">boost::asio::io_service</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">对象。还有</span><span lang="EN-US">asio::deadline_timer</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">的使用（在此例中的使用和</span><span lang="EN-US">sleep</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">区别不大）</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: large; font-family: 宋体;">&nbsp;</span></span></p>
<h2 style="margin: 13pt 0cm 13pt 21pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-font-family: &squot;Courier New&squot;; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large;">2.</span><span style='font: 7pt "Times New Roman";'> </span></span></span><span style="font-size: large;"><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">Timer.2 - Using a timer asynchronously</span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">（使用异步定时器）</span></span><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></h2>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">异步定时就是你写好函数等其调用的方式了，这里比同步多的复杂性在于你的函数</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">/callable</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">对象（称为</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">handler</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">）的编写，其他基本一样，不同的在于</span><span lang="EN-US">asio::deadline_timer</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的成员函数调用从</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">wait</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">换成了</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">async_wait</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: large;">&nbsp;</span></span></p>
<h2 style="margin: 13pt 0cm 13pt 21pt;"><span style="mso-fareast-font-family: Cambria; mso-fareast-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Cambria; mso-bidi-theme-font: major-latin; mso-bidi-language: AR-SA;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">3.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: large;"><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">Timer.3 - Binding arguments to a handler</span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">（绑定参数到</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">handler</span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">）</span></span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></h2>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">已经是有点意思了的程序了，程序的复杂性上来了，在异步调用中继续异步调用，形成类似嵌套的结构，用</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">expires_at</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">来定位超时，用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">boost::bind</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">来绑定参数。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">bind</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">也算是比较有意思的</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">boost</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">库之一，也是几乎已经拍板进入下一代</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">C++</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">标准的东西了，值得大家去看看其文档：）</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: large; font-family: 宋体;">&nbsp;</span></span></p>
<h2 style="margin: 13pt 0cm 13pt 21pt;"><span style="mso-fareast-font-family: Cambria; mso-fareast-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Cambria; mso-bidi-theme-font: major-latin; mso-bidi-language: AR-SA;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">4.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: large;"><span style="font-family: 宋体;">Timer.4 - Using a member function as a handler</span></span></span></h2>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">基本上也就是例</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">3</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的一个类的翻版，展示的其实也就是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::bind</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">对于类成员函数的绑定功能，比起例三并没有太多新意（假如你熟悉</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::bind</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">库的话，呵呵，还好我扎实过</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">基本功），并且因为无端的使用了类结构，增加了很多程序的复杂性，当然，对于在一个类中组织类似的程序还是有一定的指导意义。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: large; font-family: 宋体;">&nbsp;</span></span></p>
<h2 style="margin: 13pt 0cm 13pt 21pt;"><span style="mso-fareast-font-family: Cambria; mso-fareast-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Cambria; mso-bidi-theme-font: major-latin;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">5.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: large;"><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US">Timer.5 - Synchronising handlers in multithreaded programs</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></span></h2>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">加入了多线程的实现，</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">展示了</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::asio::strand</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">类在多线程程序中同步回调</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">handler</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的用法。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">这里我看到几个关键点，首先，</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">保证，所有的回调函数只在调用了</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">io_service::run()</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">函数的线程中才可能被调用。其次，假如需要多个线程同时能调用回调函数</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">(</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">其实这里都不算太准，因为</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">callable</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的东西都行，这里用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">callback object</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">也许更好</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">)</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，可以再多个线程中调用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">io_service::run()</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，这样，可以形成一种类似线程池的效果。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">这里展示的同步方式是将多个</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">callback object</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">用一个</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">strand</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">包装起来实现的。其实，用其他的线程同步方式明显也是可行的。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">没有展示太多</span><span style="font-family: 宋体;"><span lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">的新东西（假如你熟悉</span><span lang="EN-US">boost::thread</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">的话，关于</span><span lang="EN-US">boost::thread</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">可以参考《</span></span><strong><span style='font-size: 11.5pt; color: black; line-height: 115%; font-family: "Verdana","sans-serif"; mso-font-kerning: 18.0pt;' lang="EN-US"><a href="http://www.jtianling.com/archive/2009/06/06/4246470.aspx"><span style="color: #770000; text-decoration: none; text-underline: none;">boost::thread</span><span style="color: #770000; font-family: 宋体; text-decoration: none; mso-ascii-font-family: Verdana; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Verdana; text-underline: none;">库，奇怪的文档没有</span><span style="color: #770000; text-decoration: none; text-underline: none;">Tutorial</span><span style="color: #770000; font-family: 宋体; text-decoration: none; mso-ascii-font-family: Verdana; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Verdana; text-underline: none;">的库，但是却仍然相当强大</span></a></span></strong><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">》</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，呵呵，关于</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的学习不是白学的：），懂的了一些相关库，看</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">asio</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的例子起码是没有难度的。。。。。想当年我第一次看的时候那个一头雾水啊。。。。。</span><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">其实按文档中的例子还可能让初学者有点不清楚，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">将原文中的两句改为（不会还要问我是哪两句吧？</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">-_-!</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">以下是在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">中的例子）</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>std::cout &lt;&lt;</span></span><span style="color: #a31515;" lang="EN-US">"ThreadID:"</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt;GetCurrentThreadId() &lt;&lt;</span></span><span style="color: #a31515;" lang="EN-US">" Timer 1: "</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; count_ &lt;&lt; </span></span><span style="color: #a31515;" lang="EN-US">"/n"</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>std::cout &lt;&lt;</span></span><span style="color: #a31515;" lang="EN-US">"ThreadID:"</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt;GetCurrentThreadId() &lt;&lt;</span></span><span style="color: #a31515;" lang="EN-US">" Timer 2: "</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; count_ &lt;&lt; </span></span><span style="color: #a31515;" lang="EN-US">"/n"</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">这样的形式，那么就能很显著的看到多个线程了。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: large;"><span style="font-family: 宋体;">boost::thread t(boost::bind(&amp;boost::asio::io_service::run, &amp;io));</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">这样的形式其实是利用</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">boost::thread</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">库创建了一个新的线程，创建新线程的回调又是利用了</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">boost::bind</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">库绑定类成员函数的用法，传递</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">&amp;io</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">作为成员函数的第一参数</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">this</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">，调用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">io_service::run</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">（），紧接着主线程又调用了</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">io.run()</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">，这样就形成了同时两个线程的情况。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: large; font-family: 宋体;">&nbsp;</span></span></p>
<h2 style="margin: 13pt 0cm 13pt 21pt;"><span style="mso-fareast-font-family: Cambria; mso-fareast-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Cambria; mso-bidi-theme-font: major-latin; mso-bidi-language: AR-SA;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">6.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family: 宋体;"><span style="font-size: large;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">MyExample1</span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">：</span></span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: large;">Synchronising handlers in multithreaded programs in normal way</span></span></span></h2>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">这里展示不用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-family: 宋体;">boost::asio::strand</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;">而是利用常规线程同步的手段来完成线程的同步。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: large; font-family: 宋体;">&nbsp;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">#include &lt;iostream&gt;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">#include &lt;boost/asio.hpp&gt;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">#include &lt;boost/thread.hpp&gt;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">#include &lt;boost/thread/mutex.hpp&gt;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">#include &lt;boost/bind.hpp&gt;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">#include &lt;boost/date_time/posix_time/posix_time.hpp&gt;</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;">class </span></span><span style="color: #010001;" lang="EN-US">printer</span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">public:</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">printer</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">asio</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">io_service</span><span lang="EN-US"><span style="color: #0000ff;">&amp; </span></span><span style="color: #010001;" lang="EN-US">io</span><span lang="EN-US"><span style="color: #0000ff;">):</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">timer1_</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">io</span><span lang="EN-US"><span style="color: #0000ff;">, </span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">posix_time</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">seconds</span><span lang="EN-US"><span style="color: #0000ff;">(1)),</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">timer2_</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">io</span><span lang="EN-US"><span style="color: #0000ff;">, </span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">posix_time</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">seconds</span><span lang="EN-US"><span style="color: #0000ff;">(1)),</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;">(0)</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">timer1_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">async_wait</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">bind</span><span lang="EN-US"><span style="color: #0000ff;">(&amp;</span></span><span style="color: #010001;" lang="EN-US">printer</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">print1</span><span lang="EN-US"><span style="color: #0000ff;">, this));</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">timer2_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">async_wait</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">bind</span><span lang="EN-US"><span style="color: #0000ff;">(&amp;</span></span><span style="color: #010001;" lang="EN-US">printer</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">print2</span><span lang="EN-US"><span style="color: #0000ff;">, this));</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>~</span></span><span style="color: #010001;" lang="EN-US">printer</span><span lang="EN-US"><span style="color: #0000ff;">()</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">std</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">cout</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; </span></span><span style="color: #a31515;" lang="EN-US">"Final count is "</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; </span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; </span></span><span style="color: #a31515;" lang="EN-US">"/n"</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>void </span></span><span style="color: #010001;" lang="EN-US">print1</span><span lang="EN-US"><span style="color: #0000ff;">()</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">mutex_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">lock</span><span lang="EN-US"><span style="color: #0000ff;">();</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (</span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;"> &lt; 10)</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 3;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">std</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">cout</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt;</span></span><span style="color: #a31515;" lang="EN-US">"ThreadID:"</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt;</span></span><span style="color: #010001;" lang="EN-US">GetCurrentThreadId</span><span lang="EN-US"><span style="color: #0000ff;">() &lt;&lt;</span></span><span style="color: #a31515;" lang="EN-US">" Timer 1: "</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; </span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; </span></span><span style="color: #a31515;" lang="EN-US">"/n"</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>++</span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 3;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">timer1_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">expires_at</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">timer1_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">expires_at</span><span lang="EN-US"><span style="color: #0000ff;">() + </span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">posix_time</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">seconds</span><span lang="EN-US"><span style="color: #0000ff;">(1));</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 3;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">timer1_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">async_wait</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">bind</span><span lang="EN-US"><span style="color: #0000ff;">(&amp;</span></span><span style="color: #010001;" lang="EN-US">printer</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">print1</span><span lang="EN-US"><span style="color: #0000ff;">, this));</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">mutex_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">unlock</span><span lang="EN-US"><span style="color: #0000ff;">();</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>void </span></span><span style="color: #010001;" lang="EN-US">print2</span><span lang="EN-US"><span style="color: #0000ff;">()</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">mutex_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">lock</span><span lang="EN-US"><span style="color: #0000ff;">();</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (</span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;"> &lt; 10)</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 3;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">std</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">cout</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt;</span></span><span style="color: #a31515;" lang="EN-US">"ThreadID:"</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt;</span></span><span style="color: #010001;" lang="EN-US">GetCurrentThreadId</span><span lang="EN-US"><span style="color: #0000ff;">() &lt;&lt;</span></span><span style="color: #a31515;" lang="EN-US">" Timer 2: "</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; </span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;"> &lt;&lt; </span></span><span style="color: #a31515;" lang="EN-US">"/n"</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>++</span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 3;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">timer2_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">expires_at</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">timer2_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">expires_at</span><span lang="EN-US"><span style="color: #0000ff;">() + </span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">posix_time</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">seconds</span><span lang="EN-US"><span style="color: #0000ff;">(1));</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 3;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">timer2_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">async_wait</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">bind</span><span lang="EN-US"><span style="color: #0000ff;">(&amp;</span></span><span style="color: #010001;" lang="EN-US">printer</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">print2</span><span lang="EN-US"><span style="color: #0000ff;">, this));</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 2;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">mutex_</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">unlock</span><span lang="EN-US"><span style="color: #0000ff;">();</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">private:</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">asio</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">deadline_timer</span><span lang="EN-US"><span style="color: #0000ff;"> </span></span><span style="color: #010001;" lang="EN-US">timer1_</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">asio</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">deadline_timer</span><span lang="EN-US"><span style="color: #0000ff;"> </span></span><span style="color: #010001;" lang="EN-US">timer2_</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>int </span></span><span style="color: #010001;" lang="EN-US">count_</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">mutex</span><span lang="EN-US"><span style="color: #0000ff;"> </span></span><span style="color: #010001;" lang="EN-US">mutex_</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">};</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="color: #0000ff;">int </span></span><span style="color: #010001;" lang="EN-US">main</span><span lang="EN-US"><span style="color: #0000ff;">()</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small; color: #0000ff; font-family: 新宋体;">{</span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">asio</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">io_service</span><span lang="EN-US"><span style="color: #0000ff;"> </span></span><span style="color: #010001;" lang="EN-US">io</span><span lang="EN-US"><span style="color: #0000ff;">;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">printer</span><span lang="EN-US"><span style="color: #0000ff;"> </span></span><span style="color: #010001;" lang="EN-US">p</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">io</span><span lang="EN-US"><span style="color: #0000ff;">);</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">thread</span><span lang="EN-US"><span style="color: #0000ff;"> </span></span><span style="color: #010001;" lang="EN-US">t</span><span lang="EN-US"><span style="color: #0000ff;">(</span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">bind</span><span lang="EN-US"><span style="color: #0000ff;">(&amp;</span></span><span style="color: #010001;" lang="EN-US">boost</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">asio</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">io_service</span><span lang="EN-US"><span style="color: #0000ff;">::</span></span><span style="color: #010001;" lang="EN-US">run</span><span lang="EN-US"><span style="color: #0000ff;">, &amp;</span></span><span style="color: #010001;" lang="EN-US">io</span><span lang="EN-US"><span style="color: #0000ff;">));</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">io</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">run</span><span lang="EN-US"><span style="color: #0000ff;">();</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="font-family: 新宋体;"><span lang="EN-US"><span style="mso-tab-count: 1;"><span style="color: #0000ff;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="color: #010001;" lang="EN-US">t</span><span lang="EN-US"><span style="color: #0000ff;">.</span></span><span style="color: #010001;" lang="EN-US">join</span><span lang="EN-US"><span style="color: #0000ff;">();</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span lang="EN-US"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>return 0;</span></span></span></span></p>
<p class="C" style="margin: 0cm 0cm 0pt;"><span style="font-size: small;"><span style="color: #0000ff;"><span style="font-family: 新宋体;"><span lang="EN-US">}</span><span style="color: #a020f0; mso-bidi-font-family: 'Courier New';" lang="EN-US"></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">这样的效果和原</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的例</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">5</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">是差不多的，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">boost::asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">除了支持原生的线程同步方式外还加入了新的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">asio::strand</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">是有意义的，因为这两种方式还是有区别的。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoListParagraph" style="margin: 0cm 0cm 10pt 18pt; text-indent: -18pt; mso-list: l1 level1 lfo3; mso-char-indent-count: 0;"><span style="mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">1.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">用</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">mutex</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的方式阻塞的位置是已经进入</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">printe</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">函数以后，而</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">strand</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">是阻塞在函数调用之前的。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoListParagraph" style="margin: 0cm 0cm 10pt 18pt; text-indent: -18pt; mso-list: l1 level1 lfo3; mso-char-indent-count: 0;"><span style="mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">2.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">相对来说，当大量的同样回调函数需要同步时，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: 宋体;">asio::strand</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的使用更为简单一些。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoListParagraph" style="margin: 0cm 0cm 10pt 18pt; text-indent: -18pt; mso-list: l1 level1 lfo3; mso-char-indent-count: 0;"><span style="mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">3.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: 宋体;">mutex</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的方式明显能够更加灵活，因为不仅可以让线程阻塞在函数的开始，也可以阻塞在中间，结尾。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoListParagraph" style="margin: 0cm 0cm 10pt 18pt; text-indent: -18pt; mso-list: l1 level1 lfo3; mso-char-indent-count: 0;"><span style="mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-font-family: Calibri; mso-bidi-theme-font: minor-latin;" lang="EN-US"><span style="mso-list: Ignore;"><span style="font-size: large; font-family: 宋体;">4.</span><span style='font: 7pt "Times New Roman";'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">对于同步的对象来说，</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">asio::strand</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">就是对其支持的回调对象，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">mutex</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">是对本身线程的一种同步。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: large; font-family: 宋体;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">基本上，两者是相辅相成的，各有用处，但是实际上，假如从通用性出发，从额外学习知识触发，个人感觉</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">strand</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">似乎是可有可无的，不知道有没有必须使用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">strand</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的情况。。。。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">到此，</span><span style="font-family: 宋体;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US">asio</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">文档中</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">tutorial</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">中的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">timer</span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">系列例子是结束了。其实这里展示的以</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US">asio</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">基本原理为主，甚至都还没有接触到任何与网络相关的东西，但是，这些却是进一步学习的基础。。。。。。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: large;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://www.jtianling.com"><span style="font-family: 宋体;"><span style="font-size: large;"><span style="color: #800080;"><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;">write by </span></strong><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US">九天雁翎</span></span></strong></span></span><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;"><span style="font-size: large; color: #800080;">(JTianLing) -- www.jtianling.com</span></span></strong></span></a></span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: large; font-family: 宋体;">&nbsp;</span></span></p>
