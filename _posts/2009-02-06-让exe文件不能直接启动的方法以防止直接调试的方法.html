---
layout: post
title: "让EXE文件不能直接启动的方法以防止直接调试的方法"
categories:
- "未分类"
tags: []
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '10'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---
<br />
<h1 style="margin: 24pt 0cm 0pt;"><span style="font-size: 18pt; color: #365f91; line-height: 115%; font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">让</span><span style="font-size: 18pt; color: #365f91; line-height: 115%; mso-ascii-font-family: Cambria; mso-hansi-font-family: Cambria;" lang="EN-US"><span style="font-family: Cambria;">EXE</span></span><span style="font-size: 18pt; color: #365f91; line-height: 115%; font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">文件不能直接启动的方法以防止直接调试的方法</span></h1>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://www.jtianling.com"><span style="font-size: small;"><span style="color: #800080;"><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps;"><span style="font-family: Calibri;">write by </span></span></strong><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps;">九天雁翎</span><span style="letter-spacing: 0.25pt; font-variant: small-caps;"><span style="font-family: Calibri;">(JTianLing) -- www.jtianling.com</span></span></strong></span></span></a></span><strong><span style="text-decoration: underline;"><span style="color: #c0504d; letter-spacing: 0.25pt; font-variant: small-caps; mso-themecolor: accent2; mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="ttp://groups.google.com/group/jiutianfile/"><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US"><span style="font-size: small;">讨论新闻组及文件</span></span></span></strong></a></span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt 258pt; text-indent: -258pt; line-height: normal;"><span style="font-family: 宋体; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 宋体; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">游戏中经常需要这样的技术，即让游戏主程序不能直接启动，通过这样的方式，可以在一定程序上达到防止调试的目的，虽然仅仅是最最简单的防止，但是仍然有一定的作用。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">这里讲讲这样的技术。。。。。其实研究甚浅。。。。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">基本思路有两种，其一就是直接破坏</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">PE</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">头，那么此文件根本无法加载，自然更没有办法加载了。但是我们自己必须的完全模拟系统加载</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">PE</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">文件的过程，代价有点大。所以，虽然此方案更好，但是我没有深入的研究。其二就是仅仅破坏一段有效的代码，只要你在程序必须执行的地方插入了一堆无效数据，程序自然一运行就崩溃。目的达到了。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">这里从破坏《</span><span lang="EN-US"><a href="http://www.jtianling.com/archive/2009/01/26/3853487.aspx" target="_blank"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US">从最简单的</span></span><span style="mso-fareast-language: ZH-CN;"><span style="font-family: Calibri;">Win32</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US">汇编程序，</span></span><span style="mso-fareast-language: ZH-CN;"><span style="font-family: Calibri;">HelloWorld</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US">说起</span></span></a></span><span class="title"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">》文中介绍的一个最简单的程序开始。</span></span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">原程序源代码：</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><strong><span style='color: #804040; font-family: "Courier New";' lang="EN-US"><span style="font-size: small;">.486</span></span></strong><span style="font-size: small;"><span style='font-family: "Courier New";' lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">; create 32 bit code</span><br /><strong><span style="color: #804040;">.model</span></strong>&nbsp;<span style="color: slateblue;">flat</span>, <strong><span style="color: seagreen;">stdcall</span></strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">; 32 bit memory model</span><br /><strong><span style="color: #804040;">option</span></strong>&nbsp;<span style="color: slateblue;">casemap</span>&nbsp;:<span style="color: slateblue;">none</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">; case sensitive</span></p>
<p><strong><span style="color: #804040;">include</span></strong>&nbsp;<span style="color: fuchsia;">windows.inc</span><br /><strong><span style="color: #804040;">include</span></strong>&nbsp;<span style="color: fuchsia;">masm32.inc</span><br /><strong><span style="color: #804040;">include</span></strong>&nbsp;<span style="color: fuchsia;">user32.inc</span><br /><strong><span style="color: #804040;">include</span></strong>&nbsp;<span style="color: fuchsia;">kernel32.inc</span></p>
<p><strong><span style="color: #804040;">includelib</span></strong>&nbsp;<span style="color: fuchsia;">masm32.lib</span><br /><strong><span style="color: #804040;">includelib</span></strong>&nbsp;<span style="color: fuchsia;">user32.lib</span><br /><strong><span style="color: #804040;">includelib</span></strong>&nbsp;<span style="color: fuchsia;">kernel32.lib</span></p>
<p><strong><span style="color: #804040;">.data</span></strong><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: teal;">szCaption</span>&nbsp;<strong><span style="color: #804040;">db</span></strong>&nbsp;<span style="color: fuchsia;">"A MessageBox !"</span>,<span style="color: fuchsia;">0</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: teal;">szText</span>&nbsp;<strong><span style="color: #804040;">db</span></strong>&nbsp;<span style="color: fuchsia;">"Hello,World !"</span>,<span style="color: fuchsia;">0</span></p>
<p><strong><span style="color: #804040;">.code</span></strong></p>
<p><span style="color: #a020f0;">start</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">invoke</span></strong>&nbsp;<span style="color: teal;">MessageBox</span>,<span style="color: teal;">NULL</span>,<strong><span style="color: seagreen;">offset</span></strong>&nbsp;<span style="color: teal;">szText</span>,/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">offset</span></strong>&nbsp;<span style="color: teal;">szCaption</span>,<span style="color: teal;">MB_OK</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">invoke</span></strong>&nbsp;<span style="color: teal;">ExitProcess</span>,<span style="color: teal;">NULL</span></p>
<p><strong><span style="color: #804040;">end</span></strong>&nbsp;<span style="color: teal;">start</span></span><span style='color: teal; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: teal; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin;" lang="EN-US">反汇编的代码</span><span style="color: teal; font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">：</span><span style='color: teal; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401000 &gt;/$<span style="mso-spacerun: yes;">&nbsp; </span>6A 00<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; /Style = MB_OK|MB_APPLMODAL</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401002<span style="mso-spacerun: yes;">&nbsp; </span>|.<span style="mso-spacerun: yes;">&nbsp; </span>68 00304000<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>helloWor.00403000<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; |Title = "A MessageBox !"</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401007<span style="mso-spacerun: yes;">&nbsp; </span>|.<span style="mso-spacerun: yes;">&nbsp; </span>68 0F304000<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>helloWor.0040300F<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; |Text = "Hello,World !"</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">0040100C<span style="mso-spacerun: yes;">&nbsp; </span>|.<span style="mso-spacerun: yes;">&nbsp; </span>6A 00<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>; |hOwner = NULL</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">0040100E<span style="mso-spacerun: yes;">&nbsp; </span>|.<span style="mso-spacerun: yes;">&nbsp; </span>E8 07000000<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>CALL<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>&lt;JMP.&amp;user32.MessageBoxA&gt;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; /MessageBoxA</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401013<span style="mso-spacerun: yes;">&nbsp; </span>|.<span style="mso-spacerun: yes;">&nbsp; </span>6A 00<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; /ExitCode = 0</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401015<span style="mso-spacerun: yes;">&nbsp; </span>/.<span style="mso-spacerun: yes;">&nbsp; </span>E8 06000000<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>CALL<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>&lt;JMP.&amp;kernel32.ExitProcess&gt;<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; /ExitProcess</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">0040101A<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>$- FF25 08204000 JMP<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>NEAR DWORD PTR [&lt;&amp;user32.Message&gt;;<span style="mso-spacerun: yes;">&nbsp; </span>user32.MessageBoxA</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401020<span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>.- FF25 00204000 JMP<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>NEAR DWORD PTR [&lt;&amp;kernel32.ExitP&gt;;<span style="mso-spacerun: yes;">&nbsp; </span>kernel32.ExitProcess</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">这里我将其前一个字节改为</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">55</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">，那么其前三句将会解析成如下形式：</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401000 &gt;/$<span style="mso-spacerun: yes;">&nbsp; </span>55<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span>EBP<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; |Title = ""</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401001<span style="mso-spacerun: yes;">&nbsp; </span>|.<span style="mso-spacerun: yes;">&nbsp; </span>0068 00<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ADD<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>BYTE PTR [EAX], CH<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; |</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">00401004<span style="mso-spacerun: yes;">&nbsp; </span>|.<span style="mso-spacerun: yes;">&nbsp; </span>3040 00<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XOR<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span>BYTE PTR [EAX], AL<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>; |</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">这是再运行这个程序必然是崩溃的。这里必须要我们自己的程序去修复它，然后再运行它才能运行成功，这里以一个字节的修改为例，其实实际中你愿意改多少，改多少段完全是由你自己决定的。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">启动程序基本思路及过程如下，首先用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">CreateProcess</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">启动刚才修改过的应用程序，但是将其挂起，然后用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">VirtualProctectEx</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">函数将挂起的进程需要修改的代码段属性设为可写，然后再用</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">WriteProcessMemroy</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">函数将正确的结果写入，然后再通过</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">ResumeThread</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">将挂起的进程运行。这时，就可以通过你的启动程序去启动被破坏的程序了，而正常情况下，被破坏的程序只能是由你的启动程序来启动。</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">全部启动源代码如下：</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style='color: #804040; font-family: "Courier New";' lang="EN-US">&nbsp;1 </span><span style='color: #a020f0; font-family: "Courier New";' lang="EN-US">#include </span><span style='color: fuchsia; font-family: "Courier New";' lang="EN-US">&lt;windows.h&gt;</span></span><span style='font-family: "Courier New";' lang="EN-US"><br /><span style="font-size: small;"><span style="color: #804040;">&nbsp;2 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;tchar.h&gt;</span><br /><span style="color: #804040;">&nbsp;3 </span><br /><span style="color: #804040;">&nbsp;4 </span><br /><span style="color: #804040;">&nbsp;5 </span><strong><span style="color: seagreen;">int</span></strong>&nbsp;main(<strong><span style="color: seagreen;">int</span></strong>&nbsp;argc, <strong><span style="color: seagreen;">char</span></strong>* argv[])<br /><span style="color: #804040;">&nbsp;6 </span>{<br /><span style="color: #804040;">&nbsp;7 </span>&nbsp;&nbsp;&nbsp;&nbsp;STARTUPINFO si;<br /><span style="color: #804040;">&nbsp;8 </span>&nbsp;&nbsp;&nbsp;&nbsp;PROCESS_INFORMATION pi;<br /><span style="color: #804040;">&nbsp;9 </span>&nbsp;&nbsp;&nbsp;&nbsp;LPTSTR szCmdline=_tcsdup(TEXT(<span style="color: fuchsia;">"HelloWorld2"</span>));<br /><span style="color: #804040;">10 </span>&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">11 </span>&nbsp;&nbsp;&nbsp;&nbsp;ZeroMemory( &amp;si, <strong><span style="color: #804040;">sizeof</span></strong>(si) );<br /><span style="color: #804040;">12 </span>&nbsp;&nbsp;&nbsp;&nbsp;si.cb = <strong><span style="color: #804040;">sizeof</span></strong>(si);<br /><span style="color: #804040;">13 </span>&nbsp;&nbsp;&nbsp;&nbsp;ZeroMemory( &amp;pi, <strong><span style="color: #804040;">sizeof</span></strong>(pi) );<br /><span style="color: #804040;">14 </span>&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">15 </span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Start the child process. </span><br /><span style="color: #804040;">16 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>( !CreateProcess( <span style="color: fuchsia;">NULL</span>,&nbsp;&nbsp; <span style="color: blue;">// No module name (use command line)</span><br /><span style="color: #804040;">17 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;szCmdline,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Command line</span><br /><span style="color: #804040;">18 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: fuchsia;">NULL</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">// Process handle not inheritable</span><br /><span style="color: #804040;">19 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: fuchsia;">NULL</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">// Thread handle not inheritable</span><br /><span style="color: #804040;">20 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FALSE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Set handle inheritance to FALSE</span><br /><span style="color: #804040;">21 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREATE_SUSPENDED,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Suspended the process, the key!</span><br /><span style="color: #804040;">22 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: fuchsia;">NULL</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">// Use parent's environment block</span><br /><span style="color: #804040;">23 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: fuchsia;">NULL</span>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">// Use parent's starting directory </span><br /><span style="color: #804040;">24 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;si,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Pointer to STARTUPINFO structure</span><br /><span style="color: #804040;">25 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;pi )&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">// Pointer to PROCESS_INFORMATION structure</span><br /><span style="color: #804040;">26 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <br /><span style="color: #804040;">27 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">28 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"CreateProcess failed (</span><span style="color: slateblue;">%d</span><span style="color: fuchsia;">).</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>, GetLastError() );<br /><span style="color: #804040;">29 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">30 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">31 </span>&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">32 </span>&nbsp;&nbsp;&nbsp;&nbsp;DWORD ldwOldPro = <span style="color: fuchsia;">0</span>;<br /><span style="color: #804040;">33 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>(!VirtualProtectEx(pi.hProcess, (<strong><span style="color: seagreen;">void</span></strong>*)<span style="color: fuchsia;">0x401000</span>, <span style="color: fuchsia;">1</span>, PAGE_EXECUTE_READWRITE, &amp;ldwOldPro))<br /><span style="color: #804040;">34 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">35 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"VirtualProtectEx failed (</span><span style="color: slateblue;">%d</span><span style="color: fuchsia;">).</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>, GetLastError() );<br /><span style="color: #804040;">36 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TerminateProcess(pi.hProcess, -<span style="color: fuchsia;">1</span>);<br /><span style="color: #804040;">37 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Close process and thread handles. </span><br /><span style="color: #804040;">38 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hProcess );<br /><span style="color: #804040;">39 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hThread );<br /><span style="color: #804040;">40 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">41 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">42 </span>&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">43 </span>&nbsp;&nbsp;&nbsp;&nbsp;DWORD ldwWritten = <span style="color: fuchsia;">0</span>;<br /><span style="color: #804040;">44 </span>&nbsp;&nbsp;&nbsp;&nbsp;BYTE lbt = <span style="color: fuchsia;">0x6A</span>;<br /><span style="color: #804040;">45 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>(!WriteProcessMemory(pi.hProcess, (<strong><span style="color: seagreen;">void</span></strong>*)<span style="color: fuchsia;">0x401000</span>, &amp;lbt, <span style="color: fuchsia;">1</span>, &amp;ldwWritten))<br /><span style="color: #804040;">46 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">47 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"WriteProcessMemory failed (</span><span style="color: slateblue;">%d</span><span style="color: fuchsia;">).</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>, GetLastError() );<br /><span style="color: #804040;">48 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TerminateProcess(pi.hProcess, -<span style="color: fuchsia;">1</span>);<br /><span style="color: #804040;">49 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Close process and thread handles. </span><br /><span style="color: #804040;">50 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hProcess );<br /><span style="color: #804040;">51 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hThread );<br /><span style="color: #804040;">52 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">53 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">54 </span>&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">55 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>(!VirtualProtectEx(pi.hProcess, (<strong><span style="color: seagreen;">void</span></strong>*)<span style="color: fuchsia;">0x401000</span>, <span style="color: fuchsia;">1</span>, ldwOldPro, &amp;ldwOldPro))<br /><span style="color: #804040;">56 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">57 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"VirtualProtectEx failed (</span><span style="color: slateblue;">%d</span><span style="color: fuchsia;">).</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>, GetLastError() );<br /><span style="color: #804040;">58 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TerminateProcess(pi.hProcess, -<span style="color: fuchsia;">1</span>);<br /><span style="color: #804040;">59 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Close process and thread handles. </span><br /><span style="color: #804040;">60 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hProcess );<br /><span style="color: #804040;">61 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hThread );<br /><span style="color: #804040;">62 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">63 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">64 </span>&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">65 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>(-<span style="color: fuchsia;">1</span>==ResumeThread(pi.hThread))<br /><span style="color: #804040;">66 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">67 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"ResumeThread failed (</span><span style="color: slateblue;">%d</span><span style="color: fuchsia;">).</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>, GetLastError() );<br /><span style="color: #804040;">68 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TerminateProcess(pi.hProcess, -<span style="color: fuchsia;">1</span>);<br /><span style="color: #804040;">69 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Close process and thread handles. </span><br /><span style="color: #804040;">70 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hProcess );<br /><span style="color: #804040;">71 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hThread );<br /><span style="color: #804040;">72 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">73 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">74 </span><br /><span style="color: #804040;">75 </span><br /><span style="color: #804040;">76 </span><br /><span style="color: #804040;">77 </span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Wait until child process exits.</span><br /><span style="color: #804040;">78 </span>&nbsp;&nbsp;&nbsp;&nbsp;WaitForSingleObject( pi.hProcess, INFINITE );<br /><span style="color: #804040;">79 </span><br /><span style="color: #804040;">80 </span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">// Close process and thread handles. </span><br /><span style="color: #804040;">81 </span>&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hProcess );<br /><span style="color: #804040;">82 </span>&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( pi.hThread );<br /><span style="color: #804040;">83 </span><br /><span style="color: #804040;">84 </span>&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">85 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;<span style="color: fuchsia;">0</span>;<br /><span style="color: #804040;">86 </span>}</span></span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">再次说明，这里仅仅是示例，所以仅仅修改了一个字节，假如你改动字节比较多的话，直接通过</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">OD</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">或者</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">SoftIce</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">来调试你的应用程序就没有办法了，当然，假如你的启动程序没有任何防护，是可以先调试你的启动程序的。</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">但是方法有个完全的破坏方法，那就是</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">。</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">方法：</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">因为此例实在是太过于简单，所以在程序运行后，也就是弹出对话框后，再调用</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">LordPE</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">载入进程</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">也完全可以，但是在实际中，可能因为程序在启动时修改该了一些全局的数据，此时</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">会有问题。</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">正确的</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">步骤应该是在程序恢复运行的一瞬间，也就是将要启动却还未启动的时候。以前在一个程序将要启动却还未启动时</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">有个小技巧，那就是将其前一个字节修改为</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">0xCC,</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">那么，启动的一瞬间就会出现调试中断，然后将</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">OD</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">等调试工具设为默认调试工具，就可以在此时中断进程，并进行</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">，但是在此例中比较特殊，因为第一个字节本来就是由程序写入的，所以你没有办法通过修改文件首字节的办法来完成工作：）而且就我注意到，目前所有可以</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">的程序（也许是我见得不多，</span><span lang="EN-US"><a href="http://www.pediy.com/bbshtml/bbs7/pediy7-659-5.htm"><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;'>http://www.pediy.com/bbshtml/bbs7/pediy7-659-5.htm</span></a></span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">一文中介绍的</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">工具我都用过）</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">都是先遍历进程，然后再</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">的，但是挂起还没有运行的进程它们竟然都检查不出来</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">-_-!</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">这点我很奇怪，我也不知道他们都是用什么来遍历进程的，但是</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">windows</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">的任务管理器就可以遍历出来（</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Windows</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">的任务管理器其实相当的强悍，以前我做了一个进程占用</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">CPU</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">，内存资源百分比的监视工具，才知道要做好那么多任务不是那么简单的）。</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">呵呵，可以进行的办法是动态修改首字节，或者自己写一个给出进程</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">ID</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">就可以进行</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">的工具。。。。或者直接修改我比较习惯的</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">LordPE</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">的遍历进程方式，让其可以遍历出挂起的进程。。。。</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">这里我做个程序用于</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">上述程序。</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">此程序用于将指定进程</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">ID</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的进程首字节动态改为</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">CC</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">以出现调试中断，并且将原有的首字节读取出来，并输出，以方便中断出现后，在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">OD</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">中将其改为原有值，然后</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Dump</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">。经测试，此方式的确可以做到</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Dump</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">上述动态修改的挂起进程的目的：）</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">此程序也起到了很方便的作用：）</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">源代码如下：</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style='color: #804040; font-family: "Courier New";' lang="EN-US">&nbsp;1 </span><span style='color: blue; font-family: "Courier New";' lang="EN-US">#include "windows.h"</span></span><span style='font-family: "Courier New";' lang="EN-US"><br /><span style="font-size: small;"><span style="color: #804040;">&nbsp;2 </span>int main(int argc, char* argv[])<br /><span style="color: #804040;">&nbsp;3 </span>{<br /><span style="color: #804040;">&nbsp;4 </span>&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"Give me a Process ID: "</span>);<br /><span style="color: #804040;">&nbsp;5 </span><br /><span style="color: #804040;">&nbsp;6 </span>&nbsp;&nbsp;&nbsp;&nbsp;DWORD ldwPid = 0;<br /><span style="color: #804040;">&nbsp;7 </span>&nbsp;&nbsp;&nbsp;&nbsp;scanf(<span style="color: fuchsia;">"%d"</span>, &amp;ldwPid);<br /><span style="color: #804040;">&nbsp;8 </span><br /><span style="color: #804040;">&nbsp;9 </span>&nbsp;&nbsp;&nbsp;&nbsp;HANDLE lhPro = OpenProcess(PROCESS_VM_OPERATION | PROCESS_VM_WRITE | PROCESS_VM_READ,<br /><span style="color: #804040;">10 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FALSE, ldwPid);<br /><span style="color: #804040;">11 </span><br /><span style="color: #804040;">12 </span>&nbsp;&nbsp;&nbsp;&nbsp;if(lhPro == NULL)<br /><span style="color: #804040;">13 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">14 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"Error Process ID(%u) or OpenProcess failed (%d)./n"</span>,ldwPid, GetLastError() );<br /><span style="color: #804040;">15 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return -1;<br /><span style="color: #804040;">16 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">17 </span><br /><span style="color: #804040;">18 </span>&nbsp;&nbsp;&nbsp;&nbsp;DWORD ldwOldPro = 0;<br /><span style="color: #804040;">19 </span>&nbsp;&nbsp;&nbsp;&nbsp;if(!VirtualProtectEx(lhPro, (void*)0x401000, 1, PAGE_EXECUTE_READWRITE, &amp;ldwOldPro))<br /><span style="color: #804040;">20 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">21 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"VirtualProtectEx failed (%d)./n"</span>, GetLastError() );<br /><span style="color: #804040;">22 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( lhPro );<br /><span style="color: #804040;">23 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return -1;<br /><span style="color: #804040;">24 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">25 </span><br /><span style="color: #804040;">26 </span>&nbsp;&nbsp;&nbsp;&nbsp;DWORD ldwReaded = 0;<br /><span style="color: #804040;">27 </span>&nbsp;&nbsp;&nbsp;&nbsp;BYTE lbtFirst = 0;<br /><span style="color: #804040;">28 </span>&nbsp;&nbsp;&nbsp;&nbsp;if(!ReadProcessMemory(lhPro, (void*)0x401000, &amp;lbtFirst, 1, &amp;ldwReaded))<br /><span style="color: #804040;">29 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">30 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"ReadProcessMemory failed (%d)./n"</span>, GetLastError() );<br /><span style="color: #804040;">31 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( lhPro );<br /><span style="color: #804040;">32 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return -1;<br /><span style="color: #804040;">33 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">34 </span><br /><span style="color: #804040;">35 </span><br /><span style="color: #804040;">36 </span>&nbsp;&nbsp;&nbsp;&nbsp;DWORD ldwWritten = 0;<br /><span style="color: #804040;">37 </span>&nbsp;&nbsp;&nbsp;&nbsp;BYTE lbt = 0xcc;<br /><span style="color: #804040;">38 </span>&nbsp;&nbsp;&nbsp;&nbsp;if(!WriteProcessMemory(lhPro, (void*)0x401000, &amp;lbt, 1, &amp;ldwWritten))<br /><span style="color: #804040;">39 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">40 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"WriteProcessMemory failed (%d)./n"</span>, GetLastError() );<br /><span style="color: #804040;">41 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( lhPro );<br /><span style="color: #804040;">42 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return -1;<br /><span style="color: #804040;">43 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">44 </span><br /><span style="color: #804040;">45 </span>&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"First BYTE Changed to CC,and origin first BYTE is %X./n"</span>, lbtFirst);<br /><span style="color: #804040;">46 </span><br /><span style="color: #804040;">47 </span>&nbsp;&nbsp;&nbsp;&nbsp;if(!VirtualProtectEx(lhPro, (void*)0x401000, 1, ldwOldPro, &amp;ldwOldPro))<br /><span style="color: #804040;">48 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">49 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf( <span style="color: fuchsia;">"VirtualProtectEx failed (%d)./n"</span>, GetLastError() );<br /><span style="color: #804040;">50 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( lhPro );<br /><span style="color: #804040;">51 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return -1;<br /><span style="color: #804040;">52 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">53 </span>&nbsp;&nbsp;&nbsp;&nbsp;// Close process handles. <br /><span style="color: #804040;">54 </span>&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle( lhPro );<br /><span style="color: #804040;">55 </span><br /><span style="color: #804040;">56 </span><br /><span style="color: #804040;">57 </span>&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">58 </span>&nbsp;&nbsp;&nbsp;&nbsp;return 0;<br /><span style="color: #804040;">59 </span>}</span></span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">因为此程序已经有一定的实用性，方便了目前不是太方便的动态修改头字节为</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">CC</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">以实现</span><span style='font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US">Dump</span><span style="font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">动态修改并挂起的进程，为了方便不喜欢编译的兄弟，我将其编译后放到</span><span lang="EN-US"><a href="ttp://groups.google.com/group/jiutianfile/"><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US">讨论新闻组及文件</span></span></strong></a></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，名字为</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">DynamicChangeFirstBYTE.exe</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://www.jtianling.com"><span style="font-size: small;"><span style="color: #800080;"><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;"><span style="font-family: Calibri;">write by </span></span></strong><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US">九天雁翎</span></span></strong><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;"><span style="font-family: Calibri;">(JTianLing) -- www.jtianling.com</span></span></strong></span></span></a></span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
