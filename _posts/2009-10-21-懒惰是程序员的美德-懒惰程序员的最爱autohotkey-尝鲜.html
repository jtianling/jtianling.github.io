---
layout: post
title: "懒惰是程序员的美德! 懒惰程序员的最爱AutoHotkey 尝鲜"
categories:
- "未分类"
tags:
- AutoHotkey
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '38'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---
<br />
<h3 align="center">懒惰是程序员的美德! 懒惰程序员的最爱AutoHotkey 尝鲜</h3>
<p align="right"><b><a href="http://www.jtianling.com">write by 九天雁翎(JTianLing) -- www.jtianling.com</a></b><b></b><b><u></u></b></p>
<p align="right"><a href="http://groups.google.com/group/jiutianfile/"><b>讨论新闻组及文件</b></a></p>
<p align="left">Don’t Repeat yourself在编程领域成为DRY原则，是知道我们编写强壮代码的重要指导原则之一，但是，事实上在其他领域也是一样的（我也不知道此原则是否最先出现在编程领域）。Larry Wall的懒惰是程序员的美德的话我是记忆深刻。作为一个对计算机着迷，对程序无比投入的人，深知学海无涯，但是，正是因为学无止尽，更迫切的需要我们做追求效率的程序员，将重复的工作交给最擅长做重复工作的电脑去做，只有这样，我们才能将更多的时间节省下来，去干我们自己想干的事情。（虽然工作时不太可能-_-!但是起码能赢得一句手快的评价，再次-_-!）学习VIM，Bash，Python，Lua，Qt，SQL都是如此，在这条路上已经走了这么远的我们，又何惧为了更加提高效率，再多学AutoHotkey这样一个小工具呢？既然选择了远方，就只顾风雨兼程，既然选择了编程，就只能忘了远方。-_-!敲自己的键盘，让别人走路去吧。</p>
<p align="left"><a href="http://www.autohotkey.com/" target="_blank">AutoHotkey</a>的名字大家说不上如雷贯耳，久仰大名，起码也是早有耳闻了吧。让我们不惧艰险（又是一种脚本语言-_-!）将AutoHotkey作为饭后甜点好好品尝一下吧吧^^</p>
<p align="left"> </p>
<h2>AutoHotkey是什么</h2>
<p align="left">AutoHotkey简单来说是一个附带键盘宏录制的脚本工具，但是因为功能太过强大了，叫做自动化工具也许较为合适。从自动化工作这一点来看，AutoHotkey类似Linux下的Bash，都不以脚本语言的逻辑表达能力取胜，专门针对自动化工作设计，只不过Bash是命令行下的，对窗口一无所知，而AutoHotkey可以说是专门针对Windows的窗口平台的，有对快捷键和窗口环境的强大支持。（我见人将其称作GUI-Scripting，实在贴切）也许可以说AutoHotkey就是GUI环境下的Bash。既然Linux下Bash是必学的（的确应该学），那么AutoHotkey也就顺面学了吧。</p>
<p align="left"> </p>
<h2>安装配置</h2>
<p align="left">下载安装我就不多说了，真的不知道这里有个地址可以去<a href="http://xbeta.info/autohotkey-guide.htm" target="_blank">看看</a>。善用佳软的AutoHotkey 0级教程，顺面推荐下<a href="http://xbeta.info/" target="_blank">善用佳软</a>，推崇并介绍了很多好用的免费软件，个人很喜欢。</p>
<p align="left">AutoHotkey的脚本是以ahk为后缀的文本文件，用你自己最喜欢的编辑器编辑吧，对于vim来说，已经内置了对ahk的语法高亮，我习惯将AutoHotkey的安装目录添加进环境的PATH中，这样用vim编辑脚本的时候可以直接简单的通过!Autohotkey %来运行脚本。（事实上我将其map到了F5上）但是愿意的话，其实.ahk文件在AutoHotkey安装后是与其关联的，直接双击也可以运行此脚本。</p>
<p align="left"> </p>
<h2>初步</h2>
<p>首先编个最简单的脚本，看看效果先。</p>
<p>Run <a href="http://www.jtianling.com">http://www.jtianling.com</a></p>
<p>将上一行的代码保存成文本，双击运行，或者用autohotkey运行之，会自动开启你机器上的默认浏览器登录我的博客，建议大家每天运行100次以上^^这个功能有点像Python的os模块的startfile函数，通过解析后面的字符串来判断应该使用什么与其关联的程序运行。当年工作的时候我有个开机脚本就是用Python此函数做的，功能就是开启工作需要的一大堆程序，VS,MSDN,TotalCommand自动一个一个开启并打开合适的工程或目录。现在这个功能也可以交由autohotkey来完成了。就是一条Run命名。</p>
<p>相对来说，对于特定用途的工具（比如Bash，autohotkey）来完成其擅长的事情是会比通用工具（比如Python）来的简洁的，此即一例，Python中虽然也能完成这样的工作（在没有学习Bash前，在linux下它都是我的脚本工具），但是，需要进行import模块，函数调用等一堆难看的东西，autohotkey只需要一个Run。这里之所以讲的多点，是想说明一个特定工具哪怕并不是完成了什么不可能完成的任务，也许仅仅是将任务完成的更加简洁高效和优雅，也是一个工具的用途体现。至于值不值得为了这份优雅付出学习的代价，那就见仁见智了。</p>
<p>再看个例子：</p>
<p>Run c:/DirTest.txt</p>
<p>此脚本会自动的用你机器配置的文本编辑器开启此文件。（文件必须存在）</p>
<p>但是以下脚本</p>
<p>Run notepad.exe c:/DirTest.txt</p>
<p>无论文件存在不存在都会开始记事本，其中的区别，大家自己体会一下。事实上解析的强度比一般人能够想象的还要厉害，帮助文件中有这个示例：</p>
<p>Run <a href="mailto:someone@somedomain.com">mailto:someone@somedomain.com</a></p>
<p>呵呵，什么意思大家都知道，牛吧。可惜我一般不用客户端写邮件-_-!</p>
<p> </p>
<h2>快捷键</h2>
<p>AutoHotkey自然对Hotkey又特别支持啦，脚本中用符号表示快捷键，一次排列，几个常见的修饰键对应符号是<strong>#Win, !</strong>Alt，<strong>^</strong>Control，<strong>+</strong>Shift。那么什么叫依次排列呢？看下面的例子。</p>
<p>#space::Run <a href="http://www.jtianling.com">http://www.jtianling.com</a></p>
<p>以上的例子即将Win + space 键设定为访问我的博客，运行后发现没有直接的反应，不像上述例子，此时AutoHotkey以trayicon小图标的形式运行于右下角，当你输入Win + space的时候会触发其运行默认的浏览器开启网站，并且一直有效，直到你将其关闭。（此例也推荐大家每日运行100遍^^与前面第一个例子结合交叉运行效果更佳）同理，要ctrl+space就是^space，要ctrl+alt+space就是^!space。</p>
<p>事实上，一个快捷键可以对应多个命令，也可以多个快捷键对应一个命令，格式有点不多，见下例。</p>
<p>#space::    <br />Run <a href="http://www.jtianling.com">http://www.jtianling.com</a> <br />Run <a href="http://hi.csdn.net/vagrxie">http://hi.csdn.net/vagrxie</a> <br />return </p>
<p>#^a::    <br />#^b::     <br />Run <a href="http://www.jtianling.com">http://www.jtianling.com</a> <br />return</p>
<p>此例即是在按下Win + space时打开我的CSDN博客和空间两个网页，并且CTRL + WIN + A与CTRL + WIN + B都是打开我的博客。举这两个例子主要是告诉大家AutoHotkey的格式相对比较灵活，比如这里的一对多和多对一。当不是一对一并且写在一行时，需要以return来表示脚本的结束。</p>
<p> </p>
<h2>信息窗口</h2>
<p>这也许是最先应该说的，MsgBox</p>
<p>MsgBox Text</p>
<p>即可以通过MessageBox弹出Text的信息，比较方便</p>
<p>可以通过MsgBox弹出Yes Or No等选项，并获取，以判断分支执行程序。</p>
<p>MsgBox, 4,?,Yes or No?    <br />ifMsgBox Yes     <br />    MsgBox You Said Yes!     <br />else     <br />    MsgBox You Said No?</p>
<p>分支执行的语法比较奇怪，通过if结合MsgBox构成一个IfMsgBox特别应对MsgBox的选择。</p>
<p> </p>
<h2>对窗口的控制</h2>
<p>个人感觉，对窗口的控制是AutoHotkey的精髓所在，这也是为什么我将其比作GUI下的bash。这里我还是通过从简单到复杂的例子来描述。比如，我现在在编辑文档的时候常常会需要打开AutoHotkey的帮助文档查看，一般我的操作是用鼠标点击其最小化的窗口以激活，或者我也会需要开启gvim以编辑示例程序，也是需要用鼠标去激活，因为用atl+Tab的方式还不如用鼠标快，有了AutoHotkey，我们就有更方便的Hotkey去完成这样的任务了。</p>
<p>SetTitleMatchMode 2    <br />#tab::     <br />ifWinNotExist, GVIM     <br />{     <br />    MsgBox GVIM is not running     <br />    return     <br />}     <br />IfWinNotActive,GVIM     <br />    WinActivate,GVIM     <br />else     <br />    WinActivate,Windows Live Writer     <br />return</p>
<p>如上脚本，先判断是否有标题包含GVIM的窗口存在，不存在则报告GVIM没有运行，不然WIN+TAB键的效果就是在GVim与Windows Live Writer之间切换，非常方便。ifWinNotExist如其名，用于判断一个窗口是否存在，ifWinNotActive也如其名用于判断一个窗口是否激活，第一个参数都是表示窗口标题文字的匹配，匹配模式由SetTitleMatchMode决定。</p>
<p><strong>1</strong>: A window's title must start with the specified <em>WinTitle</em> to be a match.     <br /><strong>2</strong>: A window's title can contain <em>WinTitle </em>anywhere inside it to be a match.     <br /><strong>3</strong>: A window's title must exactly match <em>WinTitle</em> to be a match.</p>
<p>我们使用的是2，表示任意位置都匹配，默认是1，速度最快，必须是开始位置匹配。if一组的函数都还支持其他参数，具体的请查看帮助文档了，我这里主要是展示一下用途。</p>
<p>实际上AutoHotkey对窗口的控制还有很多强大的功能，一篇小文无法一一尽数，这里再举个例子：</p>
<p>SetTitleMatchMode 2    <br />Loop, 10     <br />{     <br />    Random, x, 0, 50     <br />    Random, y, 0, 50     <br />    WinMove,GVIM,, %x%, %y%     <br />    WinHide,GVIM     <br />    Sleep, 100     <br />    WinShow,GVIM     <br />}</p>
<p>上述程序运行后，GVIM窗口会变的疯狂。。。WinMove,WinHide,WinShow的意思都很明显，分别是移动，隐藏，显示窗口，这里有两个有新意的地方，一个是Random和x,y，有点编程知识的人都看出来了，AutoHotkey是允许设定变量的，此处的x,y就是，引用变量的方式是前后各1个百分号，与windows批处理程序的一样。另外就是Loop,10表示的循环结构了。</p>
<p> </p>
<h2>操作记录器</h2>
<p>这个功能有点像国内一个也比较强大的软件键盘精灵的功能（当年玩那种泡菜网络游戏没有少用过它，单纯的键盘鼠标模拟功能不比AutoHotkey差），就是将键盘鼠标操作记录下来，自动生成AutoHotkey的脚本。省去了重复工作的脚本编写之苦。带GUI界面，截图如下：</p>
<p><a href="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/555576/o_image_2_633917609392965000.png"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="image" border="0" alt="image" src="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/555576/o_image_thumb_633917609499527500.png" width="469" height="338" /></a> 点击左上角的Record按钮就开始记录键盘鼠标的操作了。然后通过点击录制时屏幕左上角的Stop停止录制。上面的脚本是我录制的一段激活Windows live Writer和最小化Windows live Writer的过程。</p>
<p>WinWait, ,    <br />IfWinNotActive, , , WinActivate, ,     <br />WinWaitActive, ,     <br />MouseClick, left,  1159,  889     <br />Sleep, 100     <br />WinWait, xfsdlaf.ahk (E:/work) - GVIM,     <br />IfWinNotActive, xfsdlaf.ahk (E:/work) - GVIM, , WinActivate, xfsdlaf.ahk (E:/work) - GVIM,     <br />WinWaitActive, xfsdlaf.ahk (E:/work) - GVIM,     <br />MouseClick, left,  908,  17     <br />Sleep, 100     <br />WinWait, ,     <br />IfWinNotActive, , , WinActivate, ,     <br />WinWaitActive, ,     <br />MouseClick, left,  33216,  32891     <br />Sleep, 100     <br />WinWait, Don’t Repeat yourself 懒惰是程序员的美德 AutoHotkey 尝鲜 - Windows Live Writer,     <br />IfWinNotActive, Don’t Repeat yourself 懒惰是程序员的美德 AutoHotkey 尝鲜 - Windows Live Writer, , WinActivate, Don’t Repeat yourself 懒惰是程序员的美德 AutoHotkey 尝鲜 - Windows Live Writer,     <br />WinWaitActive, Don’t Repeat yourself 懒惰是程序员的美德 AutoHotkey 尝鲜 - Windows Live Writer,     <br />MouseClick, left,  1362,  10     <br />Sleep, 100     <br />MouseClick, left,  1387,  10     <br />Sleep, 100 </p>
<p>会发现自动生成的代码较人工的代码还是乱了很多-_-!机器嘛，不是那么聪明。上面代码很重要的一个就是通过MouseClick来模拟鼠标的点击，有了这个功能，想干什么都可以了………………顺面提及一下，也可以通过</p>
<p>Send Keys    <br />SendRaw Keys     <br />SendInput Keys     <br />SendPlay Keys     <br />SendEvent Keys</p>
<p>来模拟键盘的输入。下面是一个当你暂时离开机器却有不想锁屏时可以提出警告的脚本。：）</p>
<p>SetTitleMatchMode 2    <br />SetKeyDelay 50     <br />Words = WARNING{!} DO NOT OPERATE MY COMPUTER{!} </p>
<p>KeyWait, LButton, D    <br />run,gvim YouAreUnderMonitored,,Max     <br />WinWait,YouAreUnderMonitored     <br />Send i%Words%{Esc}</p>
<p>此脚本等待鼠标左键单击，然后自动开启gvim并最大化，然后一个字一个字输入警告信息^^不明就里的人一看估计碰鬼了。</p>
<p> </p>
<h2>小结</h2>
<p>对于AutoHotkey这样强大的东西，一篇3000来字的小文实在是无法详细尽数其功能，而本人的目的也就是提供给觉得AutoHotKey复杂而不去学习的人尝个鲜，知道了AutoHotkey没有那么难以后，伴随着使用，参考着帮助文档，慢慢的会发现AutoHotkey也是一个离不开的工具了。我就在网上看到很多人狂喊，Linux下什么都好，就是没有AutoHotkey-_-!（其实类似的言论非常多，比如也没有Windows Live Writer equivalent）</p>
<p align="right">原创文章作者保留版权 转载请注明原作者 并给出链接<b></b></p>
<p align="right"><b><a href="http://www.jtianling.com">write by 九天雁翎(JTianLing) -- www.jtianling.com</a></b></p>
<p align="right"><strong></strong></p>
<p> <script type="text/javascript">var sitebro_tracker_atc_kw = {u:'http://www.sitebot.com.cn/754892/',w:'NzU0ODky',bt:'#804000',bg:'#EEEEDD',fs:1,ca:'#770000',bh:'#f4f4c6',cp:'',l:10,s:1,lang:'zh_CN'};</script><script type="text/javascript" src="http://www.sitebot.com.cn/js/widget_track2/tracker_atc_kw.js"></script><script type="text/javascript">&lt;!--<br />
var sitebro_tracker_atc={u:'http://www.sitebot.com.cn/754892/',w:'NzU0ODky',bt:'#804000',bg:'#EEEEDD',cf:'#ffffff',ca:'#770000',bh:'#DDDDCC',cp:'%E6%9C%AC%E7%AB%99%E7%83%AD%E9%97%A8%E6%96%87%E7%AB%A0',l:10,s:0,lang:'zh_CN'};<br />
// --&gt;</script><script src="http://www.sitebot.com.cn/js/widget_track2/tracker_atc.js" type="text/javascript"></script></p>
