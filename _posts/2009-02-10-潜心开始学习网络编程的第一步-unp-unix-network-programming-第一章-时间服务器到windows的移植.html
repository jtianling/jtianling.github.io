---
layout: post
title: "潜心开始学习网络编程的第一步 ，UNP(Unix Network Programming)第一章，时间服务器到windows的移植"
categories:
- "网络技术"
tags:
- C++
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '8'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---
<br />
<h1 style="margin: 24pt 0cm 0pt;"><span style="color: #365f91;"><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">潜心开始学习网络编程的第一步</span><span style="font-family: Cambria;"> </span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">，</span><span lang="EN-US"><span style="font-family: Cambria;">UNP(Unix Network Programming)</span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">第一章，时间服务器到</span><span lang="EN-US"><span style="font-family: Cambria;">windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">的移植</span></span></h1>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://www.jtianling.com"><span style="font-size: small;"><span style="color: #800080;"><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps;"><span style="font-family: Calibri;">write by </span></span></strong><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps;">九天雁翎</span><span style="letter-spacing: 0.25pt; font-variant: small-caps;"><span style="font-family: Calibri;">(JTianLing) -- www.jtianling.com</span></span></strong></span></span></a></span><strong><span style="text-decoration: underline;"></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="ttp://groups.google.com/group/jiutianfile/"><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US"><span style="font-size: small;">讨论新闻组及文件</span></span></span></strong></a></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt 258pt; text-indent: -258pt; line-height: normal;"><span style="font-family: 宋体; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 宋体; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt 258pt; text-indent: -258pt; line-height: normal;"><span style="font-family: 宋体; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 宋体; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">学的如此之杂，绝不是我的初衷，但是事实已经形成了，还是按照刚工作时的计划，好好的学习网络技术吧。虽说我已远不是以前服务器组的成员了。。。虽说我其实开发了好几个服务器了，但是那是在公司的框架之上的，连套接字使用的机会都及其之少。。。实在谈不上什么网络编程的经验，那种开发基本上做好的包的映射和</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">MFC</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">的消息机制区别都不大了。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">今天是调整心态并转换方向的第一天，本来以为没有什么好说的</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">但是却给我碰到意外了。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">UNPv1</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">中最前面的时间客户端</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">/</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">服务器程序在我的</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Ubuntu</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">中跑的没有效果</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">而且调试的时候都是直接分别在</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">connect</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">和</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">accept</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">上阻塞了，估计是网络可能没有调好，郁闷死了。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">于是我将其中的时间服务器程序移植到</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">下了</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">基本上相当于搬</span><span style="mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-family: Calibri;">....</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA;">更改后源代码如下：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#include</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #a31515;">&lt;time.h&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#include</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #a31515;">"Winsock2.h"</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: #a31515; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#define</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #010001;">MAXLINE</span> 1000</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">int</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: #010001; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">main</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">(<span style="color: blue;">int</span> <span style="color: #010001;">argc</span>, <span style="color: blue;">char</span> **<span style="color: #010001;">argv</span>)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WORD</span> <span style="color: #010001;">wVersionRequested</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WSADATA</span> <span style="color: #010001;">wsaData</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">err</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wVersionRequested</span> = <span style="color: #010001;">MAKEWORD</span>( 2, 2 );</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// windows</span></span><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;">下此初始化为必须</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">err</span> = <span style="color: #010001;">WSAStartup</span>( <span style="color: #010001;">wVersionRequested</span>, &amp;<span style="color: #010001;">wsaData</span> );</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> ( <span style="color: #010001;">err</span> != 0 ) {</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> -1;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SOCKET</span><span style="mso-tab-count: 1;"> </span><span style="color: #010001;">listenfd</span>, <span style="color: #010001;">connfd</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">struct</span> <span style="color: #010001;">sockaddr_in</span><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">char</span><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">buff</span>[<span style="color: #010001;">MAXLINE</span>];</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">time_t</span><span style="mso-tab-count: 1;"> </span><span style="color: #010001;">ticks</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">listenfd</span> = <span style="color: #010001;">socket</span>(<span style="color: #010001;">AF_INET</span>, <span style="color: #010001;">SOCK_STREAM</span>, 0);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span>(<span style="color: #010001;">INVALID_SOCKET</span> == <span style="color: #010001;">listenfd</span>)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">printf</span>(<span style="color: #a31515;">"socket Error: %d"</span>,<span style="color: #010001;">WSAGetLastError</span>());</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> -1;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ZeroMemory</span>(&amp;<span style="color: #010001;">servaddr</span>, <span style="color: blue;">sizeof</span>(<span style="color: #010001;">servaddr</span>));</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_family</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">AF_INET</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_addr</span>.<span style="color: #010001;">s_addr</span> = <span style="color: #010001;">htonl</span>(<span style="color: #010001;">INADDR_ANY</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_port</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">htons</span>(13);<span style="mso-tab-count: 1;">&nbsp; </span><span style="color: green;">/* daytime server */</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">bind</span>(<span style="color: #010001;">listenfd</span>, (<span style="color: blue;">struct</span> <span style="color: #010001;">sockaddr</span>*)&amp;<span style="color: #010001;">servaddr</span>, <span style="color: blue;">sizeof</span>(<span style="color: #010001;">servaddr</span>));</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">listen</span>(<span style="color: #010001;">listenfd</span>, <span style="color: #010001;">SOMAXCONN</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">for</span> ( ; ; ) {</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">connfd</span> = <span style="color: #010001;">accept</span>(<span style="color: #010001;">listenfd</span>, (<span style="color: blue;">struct</span> <span style="color: #010001;">sockaddr</span>*)<span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ticks</span> = <span style="color: #010001;">time</span>(<span style="color: #010001;">NULL</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">_snprintf</span>(<span style="color: #010001;">buff</span>, <span style="color: blue;">sizeof</span>(<span style="color: #010001;">buff</span>), <span style="color: #a31515;">"%.24s/r"</span>, <span style="color: #010001;">ctime</span>(&amp;<span style="color: #010001;">ticks</span>));</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// </span></span><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;">相当诡异的<span lang="EN-US">write</span>换成了<span lang="EN-US">send</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">send</span>(<span style="color: #010001;">connfd</span>, <span style="color: #010001;">buff</span>, <span style="color: #010001;">strlen</span>(<span style="color: #010001;">buff</span>),<span style="color: #010001;">MSG_OOB</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">closesocket</span>(<span style="color: #010001;">connfd</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="line-height: 115%; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="line-height: 115%; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="line-height: 115%; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;"><span style="font-size: small;">然后通过<span lang="EN-US">Ubuntu</span>上跑的客户端来连接这台<span lang="EN-US">windows</span>上的服务器就好了<span lang="EN-US">-_-!</span>莫名其妙。。。。。。可能还是属于我<span lang="EN-US">Linux</span>下的配置和管理不太熟悉吧。。。但是运行服务器后，<span lang="EN-US">netstat</span>却的确也没有看到服务器有监听端口啊。。。程序又没有问题<span lang="EN-US">....</span>无奈了。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="line-height: 115%; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="line-height: 115%; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;"><span style="font-size: small;">对于<span lang="EN-US">windows</span>下的套接口使用源程序，有几点想说一下，因为我进入公司当时分配在服务器组，学的第一课是序列化，第二课就是网络基础啦，当时看的也是这本<span lang="EN-US">Stevens</span>的经典著作。。。呵呵，都是将<span lang="EN-US">Unix</span>环境的，所以当时在公司调试自己的<span lang="EN-US">Windows</span>程序，光是因为没有使用<span style="color: #010001;" lang="EN-US">WSAStartup</span><span style="color: #010001;">初始化就卡了我大半天<span lang="EN-US">-_-!</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="color: #010001; line-height: 115%; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;"><span style="font-size: small;">的确是很诡异的用法，<span lang="EN-US">MS</span>自己突发奇想加上的东西，我当时看的是<span lang="EN-US">UNP</span>。。怎么会知道呢。。。。。那时候光是<span lang="EN-US">htonl, htons</span>这种函数需要调用都不知道。。。。也不知道为什么要调用。。。。光是蒙着头乱蒙<span lang="EN-US">-_-!</span>还好，现在还懂点皮毛了。呵呵</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="color: #010001; line-height: 115%; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;">另外，原有的包装函数我都是直接用原始的函数替换了，也没有加错误判断，不是什么好习惯。仅作学习使用。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://www.jtianling.com"><span style="font-size: small;"><span style="color: #800080;"><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;"><span style="font-family: Calibri;">write by </span></span></strong><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US">九天雁翎</span></span></strong><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;"><span style="font-family: Calibri;">(JTianLing) -- www.jtianling.com</span></span></strong></span></span></a></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
