---
layout: post
title: C++ 中的DOS命令调用（1）——还可以记起什么？从DIR开始
categories:
- C++
tags:
- C++
- DOS
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '17'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---

<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">不要搞错了，我是讲怎么在<span lang="EN-US" xml:lang="EN-US">C++</span>中利用<span lang="EN-US" xml:lang="EN-US">DOS</span>命令，不是准备讲<span lang="EN-US" xml:lang="EN-US">DOS</span>编程。以下都以<span lang="EN-US" xml:lang="EN-US">Windows XP</span>中的<span lang="EN-US" xml:lang="EN-US">MS-DOS</span>为例，程序一般也以<span lang="EN-US" xml:lang="EN-US">MFC</span>程序为实例，在<span lang="EN-US" xml:lang="EN-US">VS 2005</span>下编译通过。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">很久以前用电脑的时候还属于蛮荒时代，那时候都是黑屏白字的<span lang="EN-US" xml:lang="EN-US">DOS</span>，怎么说都是一种回忆了，现在谁还用那东西啊？呵呵，似乎以前用电脑的经验都是等于废了，记得我前两年考的<span lang="EN-US" xml:lang="EN-US">C</span>二级是最后一届需要考<span lang="EN-US" xml:lang="EN-US">DOS</span>的，虽然那时<span lang="EN-US" xml:lang="EN-US">DOS</span>也只在里面占了几分而已。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">难道现在<span lang="EN-US" xml:lang="EN-US">DOS</span>真的没有一点用了吗？其实也不全是，对于个人操作来说，高手会告诉你命令行操作虽然复杂的多，但是永远比<span lang="EN-US" xml:lang="EN-US">GUI</span>操作来的快。在<span lang="EN-US" xml:lang="EN-US">C++</span>中调用<span lang="EN-US" xml:lang="EN-US">DOS</span>命令虽然感觉上可移植性能不是太好，但是有的时候的便利实在是无法言喻，避开了一大堆的<span lang="EN-US" xml:lang="EN-US">API</span>学习，让以前学习的<span lang="EN-US" xml:lang="EN-US">DOS</span>知识发挥余热，何乐而不为呢？</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">下面本人列举一些在<span lang="EN-US" xml:lang="EN-US">C++</span>中<span lang="EN-US" xml:lang="EN-US">DOS</span>命令的调用，让以前也熟悉<span lang="EN-US" xml:lang="EN-US">DOS</span>的同辈中人一起回到<span lang="EN-US" xml:lang="EN-US">DOS</span>时代，看看<span lang="EN-US" xml:lang="EN-US">DOS</span>时代的命令其实也是有很大学问的啊：）--至于以前没有学过<span lang="EN-US" xml:lang="EN-US">DOS</span>的人，就没有太大必要再来学习了，因为个人感觉重新学<span lang="EN-US" xml:lang="EN-US">DOS</span>和重新学<span lang="EN-US" xml:lang="EN-US">Windows API</span>区别不是很大，一般来说<span lang="EN-US" xml:lang="EN-US">windows API</span>还有更大的通用性和安全性，用<span lang="EN-US" xml:lang="EN-US">DOS</span>命令可以说很大程度上都没有办法调试源程序，因为大量的命令都是<span lang="EN-US" xml:lang="EN-US">const char*</span>形式调用的，编译器没有办法来帮你查错误，这些可以说是<span lang="EN-US" xml:lang="EN-US">DOS</span>命令在<span lang="EN-US" xml:lang="EN-US">C++</span>中调用的缺点，但是，假如有时间，<span lang="EN-US" xml:lang="EN-US">DOS</span>命令很多时候的便利也是值得学习的，另外，因为<span lang="EN-US" xml:lang="EN-US">dos</span>以前可是一个操作系统，所以从理论上来说，光用<span lang="EN-US" xml:lang="EN-US">dos</span>命令可以完成的任务都是数不清的。。。。。。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">废话说多了，下面让我们重新回到<span lang="EN-US" xml:lang="EN-US">DOS</span>时代，看看我们能怎么用<span lang="EN-US" xml:lang="EN-US">DOS</span>命令简化我们的编程。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">基础：在<span lang="EN-US" xml:lang="EN-US">C++</span>中调用<span lang="EN-US" xml:lang="EN-US">DOS</span>命令的基本方法，就是<span lang="EN-US" xml:lang="EN-US">system(const char*);</span>形式；比如，<span lang="EN-US" xml:lang="EN-US">DEVC++</span>中最常用的<span lang="EN-US" xml:lang="EN-US">system("PAUSE")</span>，其实就是<span lang="EN-US" xml:lang="EN-US">DOS</span>中的一个命令，用来暂停程序，并输出"按任意键继续"，那可就是一个<span lang="EN-US" xml:lang="EN-US">DOS</span>命令的调用啊，呵呵，以前还不知道吧。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">下面一边回顾<span lang="EN-US" xml:lang="EN-US">DOS</span>的命令，一边让我们来看看他们都能干什么吧。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">首先，最常用的<span lang="EN-US" xml:lang="EN-US">DOS</span>命令自然是<span lang="EN-US" xml:lang="EN-US">DIR</span>了，呵呵，虽然现在有的时候习惯<span lang="EN-US" xml:lang="EN-US">LS</span>了，不过<span lang="EN-US" xml:lang="EN-US">DIR</span>也很好用啊。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">这里要讲的是，光<span lang="EN-US" xml:lang="EN-US">system("dir")</span>在程序中仅仅是输出在屏幕上而已，对于编程的实际帮助不是很大，该怎么调用呢？这里有个小的技巧，用"<span lang="EN-US" xml:lang="EN-US">&gt;</span>"操作，使用<span lang="EN-US" xml:lang="EN-US">dir &gt;xxx.txt</span>的时候，<span lang="EN-US" xml:lang="EN-US">dir</span>的屏幕输出就被输出到<span lang="EN-US" xml:lang="EN-US">xxx.txt</span>文件中了，然后可以在程序中分析调用。当你需要看某个目录的时候其实一条命令也够用，用<span lang="EN-US" xml:lang="EN-US">dir x:/xxx/xxx &gt;xxx.txt</span>的形式就可以了，这些其实都属于<span lang="EN-US" xml:lang="EN-US">DOS</span>知识。以下都以<span lang="EN-US" xml:lang="EN-US">MFC</span>程序为例，看看怎么使用<span lang="EN-US" xml:lang="EN-US">DOS</span>命令。呵呵，再次申明，用<span lang="EN-US" xml:lang="EN-US">DOS</span>命令仅仅是一条路而已，不要抱怨其他问题。我不是说没有别的办法啊，但是起码要另外学习，在没有学习之前用<span lang="EN-US" xml:lang="EN-US">DOS</span>命令作为替代也是不错的。谁说的来着，"<span lang="EN-US" xml:lang="EN-US">There are more then one way</span>"。剩下的就是对于输出文件的字符分析了，这个比一般的方法难点，不过，我们有正则表达式嘛，一切能够难道哪里去？对了，忘了说，假如是<span lang="EN-US" xml:lang="EN-US">Unicode</span>程序的话，是要用<span lang="EN-US" xml:lang="EN-US">_wsystem</span>的。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">比如现在有个需要，在对话框的一个编辑栏中输入某个目录，我们用一个列表框输出该目录下的所有目录或者文件，由一个单选按钮控制。似乎好像有点复杂。。。。，让我们完成他。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">先建立一个<span lang="EN-US" xml:lang="EN-US">MFC</span>对话框程序，然后建立一个编辑框，一个列表框，三个<span lang="EN-US" xml:lang="EN-US">Radio</span>按钮和一个普通的按键，最后程序界面大概如下：</span></p>
<p><a href="http://www.jtianling.com/dos1.jpg" rel="lightbox" title="dos1.jpg"><img src="http://www.jtianling.com/dos1_tn.jpg" title="dos1.jpg" height="136" width="200" alt="dos1.jpg" border="0" id="urn:zoundry:jid:dos1.jpg" /></a></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">首先我们完成<span lang="EN-US" xml:lang="EN-US">DIR</span>的调用。为编辑框添加一个<span lang="EN-US" xml:lang="EN-US">CString</span>类型的控件变量取名为<span lang="EN-US" xml:lang="EN-US">m_directory</span>，最后只需要下面三行就可以了。</span></p>
<p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">UpdateData();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">CString dir = _T(<span style="COLOR: #a31515">"dir /""</span>) + m_directory + _T(<span style="COLOR: #a31515">"/" &gt;dir.txt"</span>);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">_wsystem(dir);</span></p>
<p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-no-proof: yes; mso-bidi-font-family: 'Times New Roman'">需要解释的就是<span lang="EN-US" xml:lang="EN-US">dir</span>的构成了，因为在<span lang="EN-US" xml:lang="EN-US">dos</span>下调用命令，<span lang="EN-US" xml:lang="EN-US">dir</span>后面的目录参数假如有空格是不行的，比如最常见的<span lang="EN-US" xml:lang="EN-US">program files</span>目录就不行，所以为目录参数加上引号，这样就算有空格也没有任何问题，在<span lang="EN-US" xml:lang="EN-US">C++</span>中引号用转义字符后加引号表示，另外，后面用管道把内容传给<span lang="EN-US" xml:lang="EN-US">dir.txt</span>文件。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast; mso-no-proof: yes; mso-bidi-font-family: 'Times New Roman'">这里完成一个<span lang="EN-US" xml:lang="EN-US">MFC</span>的函数封装，最后将文件内容保存为<span lang="EN-US" xml:lang="EN-US">string</span>。以下面函数完成任务：</span></p>
<p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string CTestDialogDlg::ReadFromDir()</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">UpdateData();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">CString dir = L<span style="COLOR: #a31515">"dir /""</span> + m_directory + L<span style="COLOR: #a31515">"/" &gt;dir.txt"</span>;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">_wsystem(dir);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string strFile,strTemp;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::ifstream infile(<span style="COLOR: #a31515">"dir.txt"</span>);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">while</span>(std::getline(infile, strTemp))</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">strFile += strTemp + <span style="COLOR: #a31515">"/n"</span>;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">infile.close();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">return</span> strFile;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">现在最麻烦的就是处理<span lang="EN-US" xml:lang="EN-US">dir.txt</span>文件了。恩，的确比较麻烦，假如没有正则表达式的话。当然有了正则表达式就没有那么麻烦了。这里我以我最习惯的<span lang="EN-US" xml:lang="EN-US">boost</span>库正则表达式为例，假如你还不会的话可能看不懂，可以到</span><span lang="EN-US" xml:lang="EN-US"><a href="http://www.boost.org/"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">www.boost.org</span></a></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">去看看在线文档。我建立以下函数来分析目录：</span></p>
<p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string CTestDialogDlg::MatchDirectory(<span style="COLOR: blue">const</span> std::string &amp;strFile)</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">boost::regex re(<span style="COLOR: #a31515">"&lt;DIR&gt;//s+([_//w][^//r//n]+)"</span>);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">boost::smatch result;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string::const_iterator start = strFile.begin();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string::const_iterator end = strFile.end();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">boost::match_flag_type flags = boost::match_default;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string strDir;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">while</span>(boost::regex_search(start, end, result, re, flags))</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">strDir += <span style="COLOR: #a31515">"&lt;DIR&gt;"</span> + result[1] + <span style="COLOR: #a31515">"/n"</span>;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">start = result[0].second;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">flags |= boost::match_prev_avail;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">flags |= boost::match_not_bob;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">return</span> strDir;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">其他的不多说了，不然不知道多浪费时间，至于正则表达式<span lang="EN-US" xml:lang="EN-US">re</span>的构成主要看到<span lang="EN-US" xml:lang="EN-US">dir</span>命令出来的文件格式中，目录都由<span lang="EN-US" xml:lang="EN-US">&lt;DIR&gt;</span>后面跟具体目录名，这里就匹配这一点，然后取<span lang="EN-US" xml:lang="EN-US">&lt;DIR&gt;</span>后面空白字符的第一个字符到最后一个字符即匹配后的<span lang="EN-US" xml:lang="EN-US">result[1]</span>为一个目录名，这里为了方便区分，也和<span lang="EN-US" xml:lang="EN-US">dir</span>一样，为目录加上<span lang="EN-US" xml:lang="EN-US">&lt;DIR&gt;</span>前缀。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-fareast-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-fareast">文件名的匹配也基本类似。</span></p>
<p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string CTestDialogDlg::MatchFile(<span style="COLOR: blue">const</span> std::string &amp;strFile)</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">boost::regex re(<span style="COLOR: #a31515">"//d{4}-//d{2}-//d{2}//s+//d{0,2}://d{0,2}//s+[//d,]+//s([^//r//n]+)"</span>);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">boost::smatch result;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string::const_iterator start = strFile.begin();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string::const_iterator end = strFile.end();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">boost::match_flag_type flags = boost::match_default;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string strDir;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">while</span>(boost::regex_search(start, end, result, re, flags))</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">strDir += result[1] + <span style="COLOR: #a31515">"/n"</span>;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">start = result[0].second;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">flags |= boost::match_prev_avail;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">flags |= boost::match_not_bob;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">return</span> strDir;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">匹配文件名的正则表达式之所以这么复杂，主要是为了避免在<span lang="EN-US" xml:lang="EN-US">dir.txt</span>文件的前面有类似的文字，所以才完全的匹配了一行，当然，最后留下需要的文件名就可以了。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">然后在搞个函数将字符串内容写入列表框就可以了。首先为列表框建立一个相关的控件变量，取名<span lang="EN-US" xml:lang="EN-US">m_list</span>。</span></p>
<p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">void</span> <span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">CTestDialogDlg::WriteToList(<span style="COLOR: blue">const</span> std::string &amp;strList)</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">m_list.ResetContent();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::stringstream strStream(strList);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string strTemp;</span></p>
<p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">while</span>(std::getline(strStream, strTemp))</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">CString str(strTemp.c_str());</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">m_list.AddString(str);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">UpdateData(<span style="COLOR: blue">false</span>);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">这里利用了<span lang="EN-US" xml:lang="EN-US">stringstream</span>的特性来完成每行的读取。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">最后为按键添加一个按键处理程序，就可以完成任务了。这里为<span lang="EN-US" xml:lang="EN-US">radio</span>控件添加一个相关变量<span lang="EN-US" xml:lang="EN-US">m_radio</span>，以此用<span lang="EN-US" xml:lang="EN-US">switch</span>决定完成什么功能。</span></p>
<p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">void</span> <span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">CTestDialogDlg::OnBnClickedButton1()</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string strFile = ReadFromDir();</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">if</span>(strFile.empty())</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">return</span>;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">std::string strList;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">switch</span>(m_radio)</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">{</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">case</span> 0: <span style="COLOR: green">//</span></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">目录</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">strList = MatchDirectory(strFile);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">break</span>;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">case</span> 1: <span style="COLOR: green">//</span></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">文件</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">strList = MatchFile(strFile);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">break</span>;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">case</span> 2: <span style="COLOR: green">//</span></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">全部</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">strList = MatchDirectory(strFile);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">strList += MatchFile(strFile);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US"><span style="COLOR: blue">break</span>;</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">WriteToList(strList);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">UpdateData(<span style="COLOR: blue">false</span>);</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'" xml:lang="EN-US">}</span></p>
<p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">好了，这样一个程序就完成了全部想要的功能<span lang="EN-US" xml:lang="EN-US">,</span>看看运行效果：</span> <a href="http://www.jtianling.com/dos2.jpg" rel="lightbox" title="dos2.jpg"><img src="http://www.jtianling.com/dos2_tn.jpg" title="dos2.jpg" height="136" width="200" alt="dos2.jpg" border="0" id="urn:zoundry:jid:dos2.jpg" /></a></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 新宋体; mso-no-proof: yes; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-family: 'Times New Roman'">其实程序的最主要部分就是<span lang="EN-US" xml:lang="EN-US">DOS</span>命令<span lang="EN-US" xml:lang="EN-US">dir</span>的调用了，所有的程序都是围绕此命令完成。当然，这时候完美主义者可能会发现两个问题。首先就是程序运行后留下了<span lang="EN-US" xml:lang="EN-US">dir.txt</span>文件，调用<span lang="EN-US" xml:lang="EN-US">dir</span>命令的痕迹太明显，另外就是<span lang="EN-US" xml:lang="EN-US">DIR</span>调用的时候会在<span lang="EN-US" xml:lang="EN-US">MFC</span>程序运行的时候弹出一个黑色命令行窗口，虽然此窗口由于<span lang="EN-US" xml:lang="EN-US">DIR</span>的调用速度很快所以一下就关闭了，还是有点影响程序的效果，起码别人知道你是调用了命令行了，其实也不是没有解决办法，请看下节，<a href="http://www.jtianling.com/archive/2008/01/04/2025132.aspx">瞒天过海--隐藏<span lang="EN-US" xml:lang="EN-US">DOS</span>调用的命令行窗口</a></span></p>
<p></p>
