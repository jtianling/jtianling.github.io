---
layout: post
title: "以此纪念刚开始在linux上学习网络编程的失败-_-!"
categories:
- "网络技术"
tags:
- C++
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '14'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---
<br />
<h1 style="margin: 24pt 0cm 0pt;"><span style="color: #365f91;"><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">以此纪念刚开始在</span><span lang="EN-US"><span style="font-family: Cambria;">linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin;">上学习网络编程的失败</span><span lang="EN-US"><span style="font-family: Cambria;">-_-!</span></span></span></h1>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://www.jtianling.com"><span style="font-size: small;"><span style="color: #800080;"><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps;"><span style="font-family: Calibri;">write by </span></span></strong><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps;">九天雁翎</span><span style="letter-spacing: 0.25pt; font-variant: small-caps;"><span style="font-family: Calibri;">(JTianLing) -- www.jtianling.com</span></span></strong></span></span></a></span><strong><span style="text-decoration: underline;"></span></strong></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://groups.google.com/group/jiutianfile/"><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US"><span style="font-size: small;">讨论新闻组及文件</span></span></span></strong></a></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt 258pt; text-indent: -258pt; line-height: normal;"><span style="font-family: 宋体; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 宋体; mso-bidi-language: AR-SA;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">从一开始的学习到现在，我的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Ubuntu 8.04</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">服务器版本就从来没有正常的跑过一个服务器程序，亏它还是服务器版本的，郁闷的我要死。目前为止的正常的服务器端网络程序都是在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下运行成功的，比如第一次那个</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">daytime</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">服务器，都是靠着移植到</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下才能成功，不过不停的调试啊，调试啊，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">gdb</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">倒是熟悉了不少，还顺便熟悉了一堆的网络调试工具，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">netstat,tcpdump</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Wireshark</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">（</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">因为没有</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">X window</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，所以用不了）倒是真熟悉了很多，我都真不知道这样的死</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Ubuntu</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">对于学习是好是坏了，假如没有碰到这么多问题的话，我不会调试一个那样简单的程序那么多次，不会这样的进一步熟悉那些特别简单的套接口</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">API,</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">真是，郁闷了。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">中间发帖求救，有人说是防火墙，我配置了半天也没有反应，直接将</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">ufw,iptables</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">什么的都卸载了，结果还是不行！</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">最新的调试结果就是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">netstat</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">显示的确服务器端</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">listen</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">成功了，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;"> tcpdump</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">可以看到客户端的发送的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">SYN</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">包，但是就是服务器不回</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">ACK</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">包，郁闷的客户端所以总是不停的发送几次</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">SYN</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">包，然后</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">connect failed</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">了，奇怪的家伙，我今晚准备下个</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">ubuntu</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的普通版本试一下，服务器版本可能为了安全做了太多的手脚，我配置</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的能力又那么弱</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">光学些</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">bash,makefile</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">什么的，对于配置文件的修改实在是不行，不然我也不会为了</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">samba</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的配置郁闷到死，然后干脆传输文件都直接改用</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">WinSCP</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，通过</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">SSH</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">传输，而不是通过共享了。唉。。。。。还是公司好，有管理员。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">ubuntu</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">普通版本还不行，我就只好换回</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">FC</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">了。。。。刚才看了一下已经到</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">10</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">了</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">我上一次用的时候还是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">FC6</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">呢，那时候</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">4</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">5</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">张盘，现在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">FC10</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">只有</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">1CD</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">了，最近的操作系统瘦身工程进行的还挺彻底。要知道，连最最老的经典的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">RH9</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">那时候都是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">4</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">张盘。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">呵呵，其实想起来，看的其实是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">UNIX</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的书，弄个真正的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">UNIX</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，比如</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">FreeBSD</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">什么的应该也挺不错的，可惜最近工作那个忙的啊。。。。都快吐血了，游戏快要上大规模的内测了，老总，总监催进度催的我一天头是大的，刚开始弄游戏的主逻辑服务器，第二天就要我设计并添加模块</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">实在是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">@#%#$^@#$^$%@&amp;$%</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">基本上就那句话，不能上硬着头皮眯着眼睛也要上！唉。。。。所以嘛，还是暂时收收心吧。。。好好把网络编程学好都不错了，连</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">都没有弄转，呵呵，还是老实点好。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">以下是我痛苦的调试经历：</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">@ubuntu:~$ netstat -a</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">Active Internet connections (servers and established)</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">Proto Recv-Q Send-Q Local Address<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Foreign Address<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>State</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">tcp<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0 *:13000<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*:*<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LISTEN</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">@ubuntu:~$ netstat -a</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">Active Internet connections (servers and established)</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">Proto Recv-Q Send-Q Local Address<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Foreign Address<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>State</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">tcp<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0 *:daytime<span style="mso-spacerun: yes;">&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>*:*<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LISTEN</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">@ubuntu:~$ netstat -a</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">Active Internet connections (servers and established)</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">Proto Recv-Q Send-Q Local Address<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Foreign Address<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>State</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">tcp<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0 *:9877<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*:*<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>LISTEN</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">三个不同的程序，都是卡在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">listen</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">上。。。。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">@ubuntu:~/test/testclient$ ./test 127.0.0.1</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">connet failed.</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">@ubuntu:~/test/testclient$ ./test 127.0.0.1</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">connet failed.</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">可怜的客户端啊。。。一次一次的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">connet failed</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">其实它实在不停的尝试的。。。。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">一次：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">@ubuntu:~$ sudo tcpdump port 9877</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">tcpdump: verbose output suppressed, use -v or -vv for full protocol decode</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:04:03.173472 IP 192.168.0.158.46269 &gt; localhost.9877: S 1088742785:1088742785(0) win 5840 &lt;mss 1460,sackOK,timestamp 95154 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:04:06.171580 IP 192.168.0.158.46269 &gt; localhost.9877: S 1088742785:1088742785(0) win 5840 &lt;mss 1460,sackOK,timestamp 95904 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">两次：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">@ubuntu:~$ sudo tcpdump port 9877 -vv</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:05:09.022315 IP (tos 0x0, ttl 64, id 16507, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.46270 &gt; localhost.9877: S, cksum 0xef4b (correct), 2110715003:2110715003(0) win 5840 &lt;mss 1460,sackOK,timestamp 111616 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:05:12.019572 IP (tos 0x0, ttl 64, id 16508, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.46270 &gt; localhost.9877: S, cksum 0xec5d (correct), 2110715003:2110715003(0) win 5840 &lt;mss 1460,sackOK,timestamp 112366 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:05:18.019572 IP (tos 0x0, ttl 64, id 16509, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.46270 &gt; localhost.9877: S, cksum 0xe681 (correct), 2110715003:2110715003(0) win 5840 &lt;mss 1460,sackOK,timestamp 113866 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:05:30.019593 IP (tos 0x0, ttl 64, id 16510, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.46270 &gt; localhost.9877: S, cksum 0xdac9 (correct), 2110715003:2110715003(0) win 5840 &lt;mss 1460,sackOK,timestamp 116866 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:05:54.019575 IP (tos 0x0, ttl 64, id 16511, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.46270 &gt; localhost.9877: S, cksum 0xc359 (correct), 2110715003:2110715003(0) win 5840 &lt;mss 1460,sackOK,timestamp 122866 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:06:42.019581 IP (tos 0x0, ttl 64, id 16512, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.46270 &gt; localhost.9877: S, cksum 0x9479 (correct), 2110715003:2110715003(0) win 5840 &lt;mss 1460,sackOK,timestamp 134866 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">6 packets captured</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">6 packets received by filter</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">0 packets dropped by kernel</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="color: #a020f0; font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">三次：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">@ubuntu:~$ sudo tcpdump port 13000 -vv</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">[sudo] password for xqh:</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:44:49.480945 IP (tos 0x0, ttl 64, id 10118, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.60205 &gt; localhost.13000: S, cksum 0xebc4 (correct), 793636653:793636653(0) win 5840 &lt;mss 1460,sackOK,timestamp 706731 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:44:52.479579 IP (tos 0x0, ttl 64, id 10119, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.60205 &gt; localhost.13000: S, cksum 0xe8d6 (correct), 793636653:793636653(0) win 5840 &lt;mss 1460,sackOK,timestamp 707481 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:44:58.479574 IP (tos 0x0, ttl 64, id 10120, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.60205 &gt; localhost.13000: S, cksum 0xe2fa (correct), 793636653:793636653(0) win 5840 &lt;mss 1460,sackOK,timestamp 708981 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:45:10.479576 IP (tos 0x0, ttl 64, id 10121, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.60205 &gt; localhost.13000: S, cksum 0xd742 (correct), 793636653:793636653(0) win 5840 &lt;mss 1460,sackOK,timestamp 711981 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:45:34.479596 IP (tos 0x0, ttl 64, id 10122, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.60205 &gt; localhost.13000: S, cksum 0xbfd2 (correct), 793636653:793636653(0) win 5840 &lt;mss 1460,sackOK,timestamp 717981 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:46:22.479584 IP (tos 0x0, ttl 64, id 10123, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.60205 &gt; localhost.13000: S, cksum 0x90f2 (correct), 793636653:793636653(0) win 5840 &lt;mss 1460,sackOK,timestamp 729981 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:49:22.209124 IP (tos 0x0, ttl 64, id 2573, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.49879 &gt; localhost.13000: S, cksum 0x20c8 (correct), 778754316:778754316(0) win 5840 &lt;mss 1460,sackOK,timestamp 774913 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:49:25.207577 IP (tos 0x0, ttl 64, id 2574, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.49879 &gt; localhost.13000: S, cksum 0x1dda (correct), 778754316:778754316(0) win 5840 &lt;mss 1460,sackOK,timestamp 775663 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:49:31.207570 IP (tos 0x0, ttl 64, id 2575, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.49879 &gt; localhost.13000: S, cksum 0x17fe (correct), 778754316:778754316(0) win 5840 &lt;mss 1460,sackOK,timestamp 777163 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:49:43.207579 IP (tos 0x0, ttl 64, id 2576, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.49879 &gt; localhost.13000: S, cksum 0x0c46 (correct), 778754316:778754316(0) win 5840 &lt;mss 1460,sackOK,timestamp 780163 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:50:07.207588 IP (tos 0x0, ttl 64, id 2577, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.49879 &gt; localhost.13000: S, cksum 0xf4d5 (correct), 778754316:778754316(0) win 5840 &lt;mss 1460,sackOK,timestamp 786163 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small;"><span style="font-family: Calibri;">22:50:55.207580 IP (tos 0x0, ttl 64, id 2578, offset 0, flags [DF], proto TCP (6), length 60) 192.168.0.158.49879 &gt; localhost.13000: S, cksum 0xc5f5 (correct), 778754316:778754316(0) win 5840 &lt;mss 1460,sackOK,timestamp 798163 0,nop,wscale 4&gt;</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">记住，就算我不改一个字，原《</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">UNIX Network Programming</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">》第一卷第三版一书的源程序（我试过</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">4</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">5</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">个前面几章的例子了），都是可以编译，可以运行，但是状况都是同样的。。。那就是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">connect</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">不会成功。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">处于对于原程序的一丝不信任，我自己重写了一些程序，但是几乎同样的程序，在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下相当的正常，但是在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Ubuntu 8.04</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">服务器版本上，还是同样的状况！！有没有人可以给我个解释啊。。。。。朝闻道夕死可矣。。。。。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">举个例子，比如，</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下的两个程序：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">服务器端：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style='color: #804040; font-family: "Courier New";' lang="EN-US">&nbsp;1 </span><span style='color: #a020f0; font-family: "Courier New";' lang="EN-US">#include </span><span style='color: fuchsia; font-family: "Courier New";' lang="EN-US">&lt;stdio.h&gt;</span></span><span style='font-family: "Courier New";' lang="EN-US"><br /><span style="font-size: small;"><span style="color: #804040;">&nbsp;2 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;stdlib.h&gt;</span><br /><span style="color: #804040;">&nbsp;3 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;sys/socket.h&gt;</span><br /><span style="color: #804040;">&nbsp;4 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;sys/time.h&gt;</span><br /><span style="color: #804040;">&nbsp;5 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;time.h&gt;</span><br /><span style="color: #804040;">&nbsp;6 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;netinet/in.h&gt;</span><br /><span style="color: #804040;">&nbsp;7 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;errno.h&gt;</span><br /><span style="color: #804040;">&nbsp;8 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;string.h&gt;</span><br /><span style="color: #804040;">&nbsp;9 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;unistd.h&gt;</span><br /><span style="color: #804040;">10 </span><br /><span style="color: #804040;">11 </span><br /><span style="color: #804040;">12 </span><span style="color: #a020f0;">#define MAXLINE </span><span style="color: fuchsia;">1000</span><br /><span style="color: #804040;">13 </span><strong><span style="color: seagreen;">int</span></strong>&nbsp;main(<strong><span style="color: seagreen;">int</span></strong>&nbsp;argc, <strong><span style="color: seagreen;">char</span></strong>* argv[])<br /><span style="color: #804040;">14 </span>{<br /><span style="color: #804040;">15 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">int</span></strong>&nbsp;&nbsp;&nbsp;&nbsp;listenfd, connfd;<br /><span style="color: #804040;">16 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">struct</span></strong>&nbsp;sockaddr_in servaddr;<br /><span style="color: #804040;">17 </span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">//char buff[MAXLINE] = {0};</span><br /><span style="color: #804040;">18 </span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">//time_t&nbsp;&nbsp; ticks;</span><br /><span style="color: #804040;">19 </span><br /><span style="color: #804040;">20 </span>&nbsp;&nbsp;&nbsp;&nbsp;listenfd = socket(AF_INET, SOCK_STREAM, <span style="color: fuchsia;">0</span>);<br /><span style="color: #804040;">21 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>(<span style="color: fuchsia;">0</span>&nbsp;== listenfd)<br /><span style="color: #804040;">22 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">23 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"socket Error.</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">24 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">25 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">26 </span><br /><span style="color: #804040;">27 </span>&nbsp;&nbsp;&nbsp;&nbsp;memset(&amp;servaddr, <span style="color: fuchsia;">0</span>, <strong><span style="color: #804040;">sizeof</span></strong>(servaddr));<br /><span style="color: #804040;">28 </span>&nbsp;&nbsp;&nbsp;&nbsp;servaddr.sin_family&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= AF_INET;<br /><span style="color: #804040;">29 </span>&nbsp;&nbsp;&nbsp;&nbsp;servaddr.sin_addr.s_addr = htonl(INADDR_ANY);<br /><span style="color: #804040;">30 </span>&nbsp;&nbsp;&nbsp;&nbsp;servaddr.sin_port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= htons(<span style="color: fuchsia;">13000</span>);&nbsp;&nbsp; <span style="color: blue;">/*&nbsp;daytime server */</span><br /><span style="color: #804040;">31 </span><br /><span style="color: #804040;">32 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>( <span style="color: fuchsia;">0</span>&nbsp;!= bind(listenfd, (<strong><span style="color: seagreen;">struct</span></strong>&nbsp;sockaddr*)&amp;servaddr, <strong><span style="color: #804040;">sizeof</span></strong>(servaddr)))<br /><span style="color: #804040;">33 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">34 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"bind error.</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">35 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(listenfd);<br /><span style="color: #804040;">36 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">37 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">38 </span><br /><span style="color: #804040;">39 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>( <span style="color: fuchsia;">0</span>&nbsp;!= listen(listenfd, <span style="color: fuchsia;">10</span>))<br /><span style="color: #804040;">40 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">41 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"listen error.</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">42 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(listenfd);<br /><span style="color: #804040;">43 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">44 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">45 </span><br /><span style="color: #804040;">46 </span>&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"listen right.</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">47 </span><br /><span style="color: #804040;">48 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">char</span></strong>&nbsp;buffRecv[MAXLINE] = {<span style="color: fuchsia;">0</span>};<br /><span style="color: #804040;">49 </span>&nbsp;&nbsp;&nbsp;&nbsp;connfd = accept(listenfd, (<strong><span style="color: seagreen;">struct</span></strong>&nbsp;sockaddr*)<span style="color: fuchsia;">NULL</span>, <span style="color: fuchsia;">NULL</span>);<br /><span style="color: #804040;">50 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color: #804040;">51 </span>&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"have accept.</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">52 </span><br /><span style="color: #804040;">53 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">while</span></strong>(<span style="color: fuchsia;">true</span>)<br /><span style="color: #804040;">54 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">55 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">int</span></strong>&nbsp;n = <span style="color: fuchsia;">0</span>;<br /><span style="color: #804040;">56 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>( <span style="color: fuchsia;">0</span>&nbsp;== (n = read(connfd, buffRecv, MAXLINE)) )<br /><span style="color: #804040;">57 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">58 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"recv failed</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">59 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">break</span></strong>;<br /><span style="color: #804040;">60 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">61 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffRecv[n] = <span style="color: fuchsia;">0</span>;<br /><span style="color: #804040;">62 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>( <span style="color: fuchsia;">0</span>&nbsp;== (n = write(connfd, buffRecv, strlen(buffRecv))) )<br /><span style="color: #804040;">63 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">64 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"send failed.</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">65 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">break</span></strong>;<br /><span style="color: #804040;">66 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">67 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fputs(buffRecv, <span style="color: fuchsia;">stdout</span>);<br /><span style="color: #804040;">68 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">69 </span>&nbsp;&nbsp;&nbsp;&nbsp;close(connfd);<br /><span style="color: #804040;">70 </span>&nbsp;&nbsp;&nbsp;&nbsp;exit(<span style="color: fuchsia;">0</span>);<br /><span style="color: #804040;">71 </span>}<br /><span style="color: #804040;">72</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #804040; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="color: #804040; font-family: 宋体; mso-ascii-font-family: 'Courier New'; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: 'Courier New'; mso-fareast-language: ZH-CN; mso-bidi-font-family: 'Courier New';">客户端：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style='color: #804040; font-family: "Courier New";' lang="EN-US">&nbsp;1 </span><span style='color: #a020f0; font-family: "Courier New";' lang="EN-US">#include </span><span style='color: fuchsia; font-family: "Courier New";' lang="EN-US">&lt;stdio.h&gt;</span></span><span style='font-family: "Courier New";' lang="EN-US"><br /><span style="font-size: small;"><span style="color: #804040;">&nbsp;2 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;stdlib.h&gt;</span><br /><span style="color: #804040;">&nbsp;3 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;sys/socket.h&gt;</span><br /><span style="color: #804040;">&nbsp;4 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;sys/time.h&gt;</span><br /><span style="color: #804040;">&nbsp;5 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;time.h&gt;</span><br /><span style="color: #804040;">&nbsp;6 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;netinet/in.h&gt;</span><br /><span style="color: #804040;">&nbsp;7 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;errno.h&gt;</span><br /><span style="color: #804040;">&nbsp;8 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;string.h&gt;</span><br /><span style="color: #804040;">&nbsp;9 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;unistd.h&gt;</span><br /><span style="color: #804040;">10 </span><span style="color: #a020f0;">#include </span><span style="color: fuchsia;">&lt;arpa/inet.h&gt;</span><br /><span style="color: #804040;">11 </span><br /><span style="color: #804040;">12 </span><span style="color: #a020f0;">#define MAXLINE </span><span style="color: fuchsia;">1000</span><br /><span style="color: #804040;">13 </span><br /><span style="color: #804040;">14 </span><strong><span style="color: seagreen;">void</span></strong>&nbsp;str_cli(<strong><span style="color: seagreen;">FILE</span></strong>&nbsp;*fp, <strong><span style="color: seagreen;">int</span></strong>&nbsp;sockfd)<br /><span style="color: #804040;">15 </span>{<br /><span style="color: #804040;">16 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">char</span></strong>&nbsp;sendline[MAXLINE] = {<span style="color: fuchsia;">0</span>};<br /><span style="color: #804040;">17 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">char</span></strong>&nbsp;recvline[MAXLINE] = {<span style="color: fuchsia;">0</span>};<br /><span style="color: #804040;">18 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">while</span></strong>&nbsp;( (fgets(sendline, MAXLINE, fp)) != <span style="color: fuchsia;">NULL</span>) <br /><span style="color: #804040;">19 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">20 </span><br /><span style="color: #804040;">21 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>(<span style="color: fuchsia;">0</span>&nbsp;== send(sockfd, sendline, strlen(sendline), <span style="color: fuchsia;">0</span>))<br /><span style="color: #804040;">22 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">23 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"send failed.</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">24 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">break</span></strong>&nbsp;;<br /><span style="color: #804040;">25 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">26 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">27 </span>&nbsp;&nbsp;&nbsp;&nbsp;close(sockfd);<br /><span style="color: #804040;">28 </span>}<br /><span style="color: #804040;">29 </span><br /><span style="color: #804040;">30 </span><strong><span style="color: seagreen;">int</span></strong>&nbsp;main(<strong><span style="color: seagreen;">int</span></strong>&nbsp;argc, <strong><span style="color: seagreen;">char</span></strong>* argv[])<br /><span style="color: #804040;">31 </span>{<br /><span style="color: #804040;">32 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>&nbsp;(argc != <span style="color: fuchsia;">2</span>)<br /><span style="color: #804040;">33 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">34 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"usage: tcpcli &lt;IPaddress&gt;"</span>);<br /><span style="color: #804040;">35 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span style="color: fuchsia;">1</span>);<br /><span style="color: #804040;">36 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">37 </span><br /><span style="color: #804040;">38 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">int</span></strong>&nbsp;&nbsp;&nbsp;&nbsp;sockfd = <span style="color: fuchsia;">0</span>;<br /><span style="color: #804040;">39 </span>&nbsp;&nbsp;&nbsp;&nbsp;sockfd = socket(AF_INET, SOCK_STREAM, <span style="color: fuchsia;">0</span>);<br /><span style="color: #804040;">40 </span><br /><span style="color: #804040;">41 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: seagreen;">struct</span></strong>&nbsp;sockaddr_in servaddr;<br /><span style="color: #804040;">42 </span>&nbsp;&nbsp;&nbsp;&nbsp;memset(&amp;servaddr, <span style="color: fuchsia;">0</span>, <strong><span style="color: #804040;">sizeof</span></strong>(servaddr));<br /><span style="color: #804040;">43 </span>&nbsp;&nbsp;&nbsp;&nbsp;servaddr.sin_family&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= AF_INET;<br /><span style="color: #804040;">44 </span>&nbsp;&nbsp;&nbsp;&nbsp;servaddr.sin_addr.s_addr = inet_addr(argv[<span style="color: fuchsia;">1</span>]);<br /><span style="color: #804040;">45 </span>&nbsp;&nbsp;&nbsp;&nbsp;servaddr.sin_port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= htons(<span style="color: fuchsia;">13000</span>);&nbsp;&nbsp; <span style="color: blue;">/*&nbsp;daytime server */</span><br /><span style="color: #804040;">46 </span><br /><span style="color: #804040;">47 </span>&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">if</span></strong>( <span style="color: fuchsia;">0</span>&nbsp;!= connect(sockfd, (<strong><span style="color: seagreen;">struct</span></strong>&nbsp;sockaddr *)&amp;servaddr, <strong><span style="color: #804040;">sizeof</span></strong>(servaddr)))<br /><span style="color: #804040;">48 </span>&nbsp;&nbsp;&nbsp;&nbsp;{<br /><span style="color: #804040;">49 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(<span style="color: fuchsia;">"connet failed.</span><span style="color: slateblue;">/n</span><span style="color: fuchsia;">"</span>);<br /><span style="color: #804040;">50 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(sockfd);<br /><span style="color: #804040;">51 </span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color: #804040;">return</span></strong>&nbsp;-<span style="color: fuchsia;">1</span>;<br /><span style="color: #804040;">52 </span>&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="color: #804040;">53 </span><br /><span style="color: #804040;">54 </span>&nbsp;&nbsp;&nbsp;&nbsp;str_cli(<span style="color: fuchsia;">stdin</span>, sockfd);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue;">/*&nbsp;do it all */</span><br /><span style="color: #804040;">55 </span>&nbsp;&nbsp;&nbsp;&nbsp;exit(<span style="color: fuchsia;">0</span>);<br /><span style="color: #804040;">56 </span>}<br /><span style="color: #804040;">57</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #804040; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #804040; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">就这么简单的程序，硬是成功不了，何解？</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">几乎同样的程序，比如：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">服务器端：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#include</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #a31515;">"Winsock2.h"</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//#include "python.h"</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//void CallPython(const char* apszPy)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//<span style="mso-tab-count: 1;">&nbsp; </span>Py_Initialize();</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//<span style="mso-tab-count: 1;">&nbsp; </span>PyRun_SimpleString(apszPy);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//<span style="mso-tab-count: 1;">&nbsp; </span>Py_Finalize();</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#define</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #010001;">MAXLINE</span> 1000</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">int</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;"> </span><span style="color: #010001;">main</span>(<span style="color: blue;">int</span> <span style="color: #010001;">argc</span>, <span style="color: blue;">char</span> **<span style="color: #010001;">argv</span>)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WORD</span> <span style="color: #010001;">wVersionRequested</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WSADATA</span> <span style="color: #010001;">wsaData</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">err</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wVersionRequested</span> = <span style="color: #010001;">MAKEWORD</span>( 2, 2 );</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// windows</span></span><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;">下此初始化为必须</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">err</span> = <span style="color: #010001;">WSAStartup</span>( <span style="color: #010001;">wVersionRequested</span>, &amp;<span style="color: #010001;">wsaData</span> );</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> ( <span style="color: #010001;">err</span> != 0 ) {</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> -1;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SOCKET</span><span style="mso-tab-count: 1;"> </span><span style="color: #010001;">listenfd</span>, <span style="color: #010001;">connfd</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">struct</span> <span style="color: #010001;">sockaddr_in</span><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">char</span><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">buff</span>[<span style="color: #010001;">MAXLINE</span>];</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">time_t</span><span style="mso-tab-count: 1;"> </span><span style="color: #010001;">ticks</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">listenfd</span> = <span style="color: #010001;">socket</span>(<span style="color: #010001;">AF_INET</span>, <span style="color: #010001;">SOCK_STREAM</span>, 0);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span>(<span style="color: #010001;">INVALID_SOCKET</span> == <span style="color: #010001;">listenfd</span>)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">printf</span>(<span style="color: #a31515;">"socket Error: %d"</span>,<span style="color: #010001;">WSAGetLastError</span>());</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> -1;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ZeroMemory</span>(&amp;<span style="color: #010001;">servaddr</span>, <span style="color: blue;">sizeof</span>(<span style="color: #010001;">servaddr</span>));</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_family</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">AF_INET</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_addr</span>.<span style="color: #010001;">s_addr</span> = <span style="color: #010001;">htonl</span>(<span style="color: #010001;">INADDR_ANY</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_port</span><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>= <span style="color: #010001;">htons</span>(13);<span style="mso-tab-count: 1;">&nbsp; </span><span style="color: green;">/* daytime server */</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">bind</span>(<span style="color: #010001;">listenfd</span>, (<span style="color: blue;">struct</span> <span style="color: #010001;">sockaddr</span>*)&amp;<span style="color: #010001;">servaddr</span>, <span style="color: blue;">sizeof</span>(<span style="color: #010001;">servaddr</span>));</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">listen</span>(<span style="color: #010001;">listenfd</span>, <span style="color: #010001;">SOMAXCONN</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">char</span><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">buffRecv</span>[<span style="color: #010001;">MAXLINE</span>] = {0};</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">connfd</span> = <span style="color: #010001;">accept</span>(<span style="color: #010001;">listenfd</span>, (<span style="color: blue;">struct</span> <span style="color: #010001;">sockaddr</span>*)<span style="color: #010001;">NULL</span>, <span style="color: #010001;">NULL</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">while</span>(<span style="color: blue;">true</span>)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">n</span> = 0;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span>( 0 == (<span style="color: #010001;">n</span> = <span style="color: #010001;">recv</span>(<span style="color: #010001;">connfd</span>, <span style="color: #010001;">buffRecv</span>, <span style="color: #010001;">MAXLINE</span>,0)) )</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">printf</span>(<span style="color: #a31515;">"recv failed, Error Code: %d"</span>, <span style="color: #010001;">WSAGetLastError</span>());</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">buffRecv</span>[<span style="color: #010001;">n</span>] = 0;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">//<span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp; </span>CallPython(buffRecv);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span>( 0 == (<span style="color: #010001;">n</span> = <span style="color: #010001;">send</span>(<span style="color: #010001;">connfd</span>, <span style="color: #010001;">buffRecv</span>, <span style="color: #010001;">strlen</span>(<span style="color: #010001;">buffRecv</span>),0)) )</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">printf</span>(<span style="color: #a31515;">"send failed, Error Code: %d"</span>, <span style="color: #010001;">WSAGetLastError</span>());</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">fputs</span>(<span style="color: #010001;">buffRecv</span>, <span style="color: #010001;">stdout</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">closesocket</span>(<span style="color: #010001;">connfd</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">客户端：</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#include</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #a31515;">"Winsock2.h"</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#include</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #a31515;">"errno.h"</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#include</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #a31515;">"stdlib.h"</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: #a31515; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">#define</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #010001;">MAXLINE</span> 1000</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">void</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #010001;">str_cli</span>(<span style="color: #010001;">FILE</span> *<span style="color: #010001;">fp</span>, <span style="color: #010001;">SOCKET</span> <span style="color: #010001;">sockfd</span>)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">char</span> <span style="color: #010001;">sendline</span>[<span style="color: #010001;">MAXLINE</span>] = {0};</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">char</span> <span style="color: #010001;">recvline</span>[<span style="color: #010001;">MAXLINE</span>] = {0};</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">while</span> ( (<span style="color: #010001;">fgets</span>(<span style="color: #010001;">sendline</span>, <span style="color: #010001;">MAXLINE</span>, <span style="color: #010001;">fp</span>)) != <span style="color: #010001;">NULL</span>) </span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span>(<span style="color: #010001;">SOCKET_ERROR</span> == <span style="color: #010001;">send</span>(<span style="color: #010001;">sockfd</span>, <span style="color: #010001;">sendline</span>, <span style="color: #010001;">strlen</span>(<span style="color: #010001;">sendline</span>), 0))</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">printf</span>(<span style="color: #a31515;">"send failed, Error Code: %d"</span>, <span style="color: #010001;">WSAGetLastError</span>());</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">break</span> ;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">closesocket</span>(<span style="color: #010001;">sockfd</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="color: blue; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US">int</span><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"> <span style="color: #010001;">main</span>(<span style="color: blue;">int</span> <span style="color: #010001;">argc</span>, <span style="color: blue;">char</span> **<span style="color: #010001;">argv</span>)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WORD</span> <span style="color: #010001;">wVersionRequested</span> = 0;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">WSADATA</span> <span style="color: #010001;">wsaData</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">int</span> <span style="color: #010001;">err</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">wVersionRequested</span> = <span style="color: #010001;">MAKEWORD</span>( 2, 2 );</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-size: small;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// windows</span></span><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;">下此初始化为必须，实际包含加载<span lang="EN-US">WinsockDLL</span>的过程</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">err</span> = <span style="color: #010001;">WSAStartup</span>( <span style="color: #010001;">wVersionRequested</span>, &amp;<span style="color: #010001;">wsaData</span> );</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> ( <span style="color: #010001;">err</span> != 0 ) {</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> -1;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">SOCKET</span><span style="mso-tab-count: 5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">sockfd</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">struct</span> <span style="color: #010001;">sockaddr_in</span><span style="mso-tab-count: 1;">&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (<span style="color: #010001;">argc</span> != 2)</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">printf</span>(<span style="color: #a31515;">"usage: tcpcli &lt;IPaddress&gt;"</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">exit</span>(1);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">sockfd</span> = <span style="color: #010001;">socket</span>(<span style="color: #010001;">AF_INET</span>, <span style="color: #010001;">SOCK_STREAM</span>, 0);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">ZeroMemory</span>(&amp;<span style="color: #010001;">servaddr</span>, <span style="color: blue;">sizeof</span>(<span style="color: #010001;">servaddr</span>));</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_family</span> = <span style="color: #010001;">AF_INET</span>;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_port</span> = <span style="color: #010001;">htons</span>(13);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">servaddr</span>.<span style="color: #010001;">sin_addr</span>.<span style="color: #010001;">s_addr</span> = <span style="color: #010001;">inet_addr</span>(<span style="color: #010001;">argv</span>[1]);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span>( <span style="color: #010001;">SOCKET_ERROR</span> == <span style="color: #010001;">connect</span>(<span style="color: #010001;">sockfd</span>, (<span style="color: blue;">struct</span> <span style="color: #010001;">sockaddr</span> *) &amp;<span style="color: #010001;">servaddr</span>, <span style="color: blue;">sizeof</span>(<span style="color: #010001;">servaddr</span>)))</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">printf</span>(<span style="color: #a31515;">"connet failed, Error Code: %d"</span>, <span style="color: #010001;">WSAGetLastError</span>());</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">closesocket</span>(<span style="color: #010001;">sockfd</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">return</span> -1;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">str_cli</span>(<span style="color: #010001;">stdin</span>, <span style="color: #010001;">sockfd</span>);<span style="mso-tab-count: 1;">&nbsp; </span><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: green;">/* do it all */</span></span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="color: green; font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">system</span>(<span style="color: #a31515;">"pause"</span>);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp; </span><span style="color: #010001;">exit</span>(0);</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 0pt; line-height: normal; mso-pagination: none; mso-layout-grid-align: none;"><span style="font-family: 新宋体; mso-hansi-font-family: 'Times New Roman'; mso-fareast-language: ZH-CN; mso-bidi-font-size: 12.0pt; mso-bidi-font-family: 'Times New Roman'; mso-bidi-language: AR-SA; mso-no-proof: yes;" lang="EN-US"><span style="font-size: small;">}</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">就是运行的那么正常</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">给我个解释？。。。。。另外，虽然做了写了好几个服务器了，我最近才知道。。原来。。。</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">recv,send</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">本来就是标准的套接口</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">API</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">。。。。我一直以为这些都是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">扩展的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">《</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Unix Network Programming</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">》书以前只看了前面一点，因为前面用的都是</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">read,write</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">接口来写套接字，所以嘛。。。呵呵，误解了，以前还常喊</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">windows</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">下用的</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">recv,send</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">很奇怪呢</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">-_-!</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">太无知了，所以嘛，还是要好好学习底层知识才行。。。不能太依赖于公司的网络框架了，虽然那个框架写的真是不赖。。。好用的很。。。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="font-size: small;"><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">有在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">Ubuntu 8.04</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">版本上成功</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Calibri;">accept</span></span><span style="font-family: 宋体; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-fareast-language: ZH-CN;">的兄弟，请告知怎么样配置的。。。。</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<h2 style="margin: 13pt 0cm;"><span style="font-size: large;"><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin; mso-fareast-language: ZH-CN;">以此纪念刚开始在</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Cambria;">linux</span></span><span style="font-family: 宋体; mso-ascii-font-family: Cambria; mso-ascii-theme-font: major-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: major-fareast; mso-hansi-font-family: Cambria; mso-hansi-theme-font: major-latin; mso-fareast-language: ZH-CN;">上学习网络编程的失败</span><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-family: Cambria;">-_-!</span></span></span></h2>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style='color: #a020f0; font-family: "Courier New"; mso-fareast-language: ZH-CN;' lang="EN-US"><span style="font-size: small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt; text-align: right;" align="right"><span lang="EN-US"><a href="http://www.jtianling.com"><span style="font-size: small;"><span style="color: #800080;"><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;"><span style="font-family: Calibri;">write by </span></span></strong><strong><span style="font-family: 宋体; letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;" lang="EN-US"><span lang="EN-US">九天雁翎</span></span></strong><strong><span style="letter-spacing: 0.25pt; font-variant: small-caps; mso-fareast-language: ZH-CN;"><span style="font-family: Calibri;">(JTianLing) -- www.jtianling.com</span></span></strong></span></span></a></span></p>
<p class="MsoNormal" style="margin: 0cm 0cm 10pt;"><span style="mso-fareast-language: ZH-CN;" lang="EN-US"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></span></p>
