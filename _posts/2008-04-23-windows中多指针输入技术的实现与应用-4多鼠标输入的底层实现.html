---
layout: post
title: Windows中多指针输入技术的实现与应用(4多鼠标输入的底层实现)
categories:
- "我的程序"
tags:
- Windows
- "多鼠标"
status: publish
type: post
published: true
meta:
  ratings_users: '0'
  ratings_score: '0'
  ratings_average: '0'
  views: '17'
author:
  login: jtianling
  email: jtianling@gmail.com
  display_name: jtianling
  first_name: ''
  last_name: ''
---

<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 18pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体"><font face="Times New Roman">Windows</font></span><span style="FONT-SIZE: 18pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-ascii-font-family: 'Times New Roman'">中多指针输入技术的实现与应用</span><span lang="EN-US" style="FONT-SIZE: 18pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体"><font face="Times New Roman">(4</font></span><span style="FONT-SIZE: 16pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold">多鼠标输入的底层实现<span lang="EN-US">)</span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%" align="right"><span style="FONT-SIZE: 16pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><span lang="EN-US"><o:p>湖南大学 谢祁衡</o:p></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 16pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">2</font></span><span lang="EN-US" style="FONT-SIZE: 16pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"> </span><span style="FONT-SIZE: 16pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold">多鼠标输入的底层实现<span lang="EN-US"><o:p></o:p></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">2.1</font></span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"> </span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold">通过开发过滤式鼠标驱动的实现<span lang="EN-US"><o:p></o:p></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 21pt; LINE-HEIGHT: 150%"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">此技术最先由</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">M.Westergaard</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">[9]</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中提出，此技术主要思路为从驱动程序层面解决</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">Windows</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">本身不能识别多个指针设备的问题。通过设计单独的一套鼠标驱动程序和</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman"> <span lang="EN-US">API</span></font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">完成硬件与用户层应用程序的通信。主要的技术可以用图</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">2.1</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">来描述。</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 21pt; LINE-HEIGHT: 150%" align="center"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p><img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/翻译示意1.JPG" /></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: center" align="center"><strong><span lang="EN-US" style="FONT-SIZE: 9pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><v:shapetype id="_x0000_t75" stroked="f" filled="f" path="m@4@5l@4@11@9@11@9@5xe" o:preferrelative="t" o:spt="75" coordsize="21600,21600"><v:stroke joinstyle="miter"></v:stroke><v:formulas><v:f eqn="if lineDrawn pixelLineWidth 0"></v:f><v:f eqn="sum @0 1 0"></v:f><v:f eqn="sum 0 0 @1"></v:f><v:f eqn="prod @2 1 2"></v:f><v:f eqn="prod @3 21600 pixelWidth"></v:f><v:f eqn="prod @3 21600 pixelHeight"></v:f><v:f eqn="sum @0 0 1"></v:f><v:f eqn="prod @6 1 2"></v:f><v:f eqn="prod @7 21600 pixelWidth"></v:f><v:f eqn="sum @8 21600 0"></v:f><v:f eqn="prod @7 21600 pixelHeight"></v:f><v:f eqn="sum @10 21600 0"></v:f></v:formulas><v:path o:connecttype="rect" gradientshapeok="t" o:extrusionok="f"></v:path><o:lock aspectratio="t" v:ext="edit"></o:lock></v:shapetype><v:shape id="_x0000_i1025" style="WIDTH: 106.5pt; HEIGHT: 196.5pt" type="#_x0000_t75"><v:imagedata o:title="filtermouse1" src="file:///C:/DOCUME~1/ADMINI~1/LOCALS~1/Temp/msohtml1/01/clip_image001.jpg"></v:imagedata></v:shape><o:p></o:p></span></strong></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: center" align="center"><span style="FONT-SIZE: 9pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">注：图左边为过滤式鼠标驱动程序的工作方式，右边为通常程序的运行方式，它们可以共存。</span><span lang="EN-US" style="FONT-SIZE: 9pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: center" align="center"><font size="3"><span style="LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">图</span><span lang="EN-US" style="LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">2.1 </font></span><span style="LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">过滤式鼠标驱动实现原理图</span><font face="Times New Roman"><sup><span lang="EN-US" style="LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-weight: bold">[9]</span></sup><span lang="EN-US" style="LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><o:p></o:p></span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 21pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 21pt; LINE-HEIGHT: 150%"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">此驱动程序是通过过滤鼠标的输入，所有的鼠标输入信息都在通过此驱动程序的时候加入</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman"> ID</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">信息，使得系统辨识不同鼠标，就像从各种不同的独立的驱动程序中接收数据一样。低层</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">API</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">主管在各驱动程序之间的通信和处理上一个层面的反馈。高层的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">API</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">允许用户层的应用程序在一个有效的途径上接受鼠标的输入。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-INDENT: 21pt; LINE-HEIGHT: 150%"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这个技术解决了支持多鼠标输入的原理问题，最主要的优点是开发人员拥有对鼠标输入最完全的控制，也可以进行最彻底的优化，不受他人开发程序效率的限制。并且当低层系统有改变，比如当</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">Windows</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">决定从低层开始支持多鼠标输入的时候，上层的软件可以几乎不改变就正常使用。但是缺点也很明显，进行核心编程和驱动程序的开发都</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">太过于复杂且难以控制。另外，虽然对于鼠标有着较为通用的驱动程序，但是对于不同的指针设备还必须提供不同的驱动程序，所以对于新的指针设备的识别也将会成为难点，使得此技术仅仅只能被框架级程序的专业开发所利用，比如</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">Octopus framework</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">和</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">CPNmouse</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><sup><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><font face="Times New Roman">[9]</font></span></sup><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">而且仅仅对于鼠标等有限的设备有着很好的支持。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 10pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><strong><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt">2.2</span></strong><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt">用户层利用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold">的实现<span lang="EN-US"><o:p></o:p></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">微软在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">Windows XP</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">中在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">RawInput API</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">中加入了鼠标的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">ID</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">信息数据，因此，使得在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">Windows XP</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">中通过直接分辨</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">RawInput API</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">中的鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">ID</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">信息非常方便地来识别不同的鼠标输入。</span><span lang="EN-US" style="FONT-SIZE: 9pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">虽然能够识别不同数据，但是对于不同鼠标指针的绘制完全要由编程人员控制。此技术有着对鼠标输入比较完全的控制，识别不同鼠标输入的数据较为容易，且仅仅通过微软的底层程序，因此效率很高。而且对于新加入的指针设备能有较快的反应，可以不考虑驱动程序就对新的指针设备提供直接支持。值得一提的是，微软对于</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">提供了文档支持，且网上实现此技术的相关资料较为丰富，这点对于开发工作来说，必不可少。缺点是用户层上的开发工作并不是很容易，特别是很好的多鼠标输入数据处理方式和多鼠标指针的绘制技术比较难以掌握，而利用较为容易实现的时分方式会带来一些副作用，比如当多个虚拟指针同时拖动窗口的时候，将导致未定义的行为。</span><sup><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">[5] </font></span></sup><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">而且，此技术只能在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">Windows 2000/XP</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">中运用，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">Windows 9x&nbsp;</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">下已确认无法使用。但是因为此方法的优点明显，缺点却难以用其他方法弥补，使得很多各层次的程序都是利用此技术完成，比如</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">SDG Toolkit</font></span><strong><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span></strong><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">MAME:Analog+</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'">，以及</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">Reflexive Entertainment, Inc</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'">的大部分符合</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">Mouse-Party</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'">的游戏。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-hansi-font-family: 宋体"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-hansi-font-family: 宋体"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">2.3 RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold">实现的原理<span lang="EN-US"><o:p></o:p></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 10pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">在此节，分各鼠标输入数据的识别和各鼠标独立指针的绘制两方面详细介绍了</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">实现的原理。</span><span lang="EN-US" style="FONT-SIZE: 10pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><st1:chsdate w:st="on" isrocdate="False" islunardate="False" day="30" month="12" year="1899"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%">2.3.1</span></st1:chsdate><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"> </span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体">RawInput</span></font><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-ascii-font-family: 'Times New Roman'">各鼠标输入数据的识别原理</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">虽然</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">Windows</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">并不直接支持多指针输入设备，但是通过原始的输入数据识别还是可以分辨不同的鼠标输入，在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">Windows XP</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中提供原始输入数据处理的方法是通过注册使用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备以获得</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构类型数据的方式。具体流程图如下：</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="center"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/RawInput各鼠标输入数据识别流程图.JPG" /></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: center; mso-layout-grid-align: none" align="center"><span lang="EN-US"><v:group id="_x0000_s1026" style="WIDTH: 389.45pt; HEIGHT: 407.8pt; mso-position-horizontal-relative: char; mso-position-vertical-relative: line" coordsize="7789,8156" editas="canvas"><o:lock aspectratio="t" v:ext="edit"></o:lock><v:shape id="_x0000_s1027" style="WIDTH: 7789px; POSITION: absolute; HEIGHT: 8156px" o:preferrelative="f" type="#_x0000_t75"><v:fill o:detectmouseclick="t"></v:fill><v:path o:connecttype="none" o:extrusionok="t"></v:path><o:lock v:ext="edit" text="t"></o:lock></v:shape><v:shape id="_x0000_s1028" style="LEFT: 818px; WIDTH: 1245px; POSITION: absolute; TOP: 24px; HEIGHT: 558px" path="m,376hdc,169,377,,840,hal840,hdc1304,,1680,169,1680,376v,,,,,hal1680,376hdc1680,584,1304,752,840,752v,,,,,hal840,752hdc377,752,,584,,376v,,,,,xe" coordsize="1680,752" strokeweight="0"><v:path arrowok="t"></v:path></v:shape><v:shape id="_x0000_s1029" style="LEFT: 800px; WIDTH: 1281px; POSITION: absolute; TOP: 6px; HEIGHT: 594px" path="m1,403hdc,401,,400,1,398hal5,360hdc5,358,5,356,6,355hal19,317hdc19,315,20,314,21,312hal42,276hdc42,275,43,274,44,273hal72,239r38,-35l154,171r50,-30l260,113,387,66,532,31,692,9,863,r172,8l1195,31r145,34l1467,112r56,28l1574,170r44,32l1655,237r30,36hdc1686,274,1687,275,1687,276hal1708,312hdc1709,314,1710,315,1710,317hal1723,355hdc1724,356,1724,358,1724,360hal1728,398hdc1729,400,1729,401,1728,403hal1724,442hdc1724,444,1724,446,1723,447hal1710,484hdc1710,486,1709,487,1708,489hal1687,525hdc1687,526,1686,527,1685,527hal1657,562hdc1656,563,1656,564,1655,565hal1620,597r-44,33l1525,660r-56,28l1343,735r-146,36l1037,792r-171,8l694,792,534,771,390,736,262,689,206,661,156,631,112,599,75,565hdc74,565,73,564,72,562hal44,527hdc43,527,42,526,42,525hal21,489hdc20,487,19,486,19,484hal6,447hdc5,446,5,444,5,442hal1,403hdxm52,437hal51,432r13,37l62,464r21,36l81,497r28,35l106,530r35,30l181,590r46,28l279,644r122,45l541,724r156,20l863,752r167,-7l1186,724r140,-34l1448,645r52,-26l1547,591r40,-29l1622,530r-2,2l1648,497r-2,3l1667,464r-2,5l1678,432r-1,5l1681,398r,5l1677,365r1,5l1665,332r2,5l1646,301r2,3l1622,272r-33,-31l1549,211r-47,-28l1450,157,1329,112,1188,78,1032,56,866,48,699,56,543,78,404,111,281,156r-52,26l183,210r-40,29l109,270,81,304r2,-3l62,337r2,-5l51,370r1,-5l48,403r,-5l52,437hdxe" coordsize="1729,800" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1030" style="LEFT: 1274px; WIDTH: 330px; POSITION: absolute; TOP: 213px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">开始</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1031" style="LEFT: 379px; WIDTH: 2241px; POSITION: absolute; TOP: 914px; HEIGHT: 712px" stroked="f"></v:rect><v:shape id="_x0000_s1032" style="LEFT: 362px; WIDTH: 2276px; POSITION: absolute; TOP: 896px; HEIGHT: 748px" path="m,24hdc,11,11,,24,hal3048,hdc3062,,3072,11,3072,24hal3072,984hdc3072,998,3062,1008,3048,1008hal24,1008hdc11,1008,,998,,984hal,24hdxm48,984hal24,960r3024,l3024,984r,-960l3048,48,24,48,48,24r,960hdxe" coordsize="3072,1008" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1033" style="LEFT: 541px; WIDTH: 165px; POSITION: absolute; TOP: 1086px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">用</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1034" style="LEFT: 707px; WIDTH: 1770px; POSITION: absolute; TOP: 1074px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">GetRawInputDeviceList</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1035" style="LEFT: 2296px; WIDTH: 165px; POSITION: absolute; TOP: 1086px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">函</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1036" style="LEFT: 589px; WIDTH: 495px; POSITION: absolute; TOP: 1287px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">数获取</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1037" style="LEFT: 1087px; WIDTH: 705px; POSITION: absolute; TOP: 1275px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">RawInput</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1038" style="LEFT: 1739px; WIDTH: 660px; POSITION: absolute; TOP: 1287px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">设备数量</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1039" style="LEFT: 379px; WIDTH: 2241px; POSITION: absolute; TOP: 2066px; HEIGHT: 724px" stroked="f"></v:rect><v:shape id="_x0000_s1040" style="LEFT: 362px; WIDTH: 2276px; POSITION: absolute; TOP: 2048px; HEIGHT: 760px" path="m,24hdc,11,11,,24,hal3048,hdc3062,,3072,11,3072,24hal3072,1000hdc3072,1014,3062,1024,3048,1024hal24,1024hdc11,1024,,1014,,1000hal,24hdxm48,1000hal24,976r3024,l3024,1000r,-976l3048,48,24,48,48,24r,976hdxe" coordsize="3072,1024" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1041" style="LEFT: 541px; WIDTH: 165px; POSITION: absolute; TOP: 2242px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">用</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1042" style="LEFT: 707px; WIDTH: 1920px; POSITION: absolute; TOP: 2231px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">RegisterRawInputDevices</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1043" style="LEFT: 672px; WIDTH: 660px; POSITION: absolute; TOP: 2445px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">函数注册</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1044" style="LEFT: 1336px; WIDTH: 705px; POSITION: absolute; TOP: 2433px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">RawInput</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1045" style="LEFT: 1988px; WIDTH: 330px; POSITION: absolute; TOP: 2445px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">设备</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1046" style="LEFT: 379px; WIDTH: 2241px; POSITION: absolute; TOP: 3229px; HEIGHT: 712px" stroked="f"></v:rect><v:shape id="_x0000_s1047" style="LEFT: 362px; WIDTH: 2276px; POSITION: absolute; TOP: 3211px; HEIGHT: 748px" path="m,24hdc,11,11,,24,hal3048,hdc3062,,3072,11,3072,24hal3072,984hdc3072,998,3062,1008,3048,1008hal24,1008hdc11,1008,,998,,984hal,24hdxm48,984hal24,960r3024,l3024,984r,-960l3048,48,24,48,48,24r,960hdxe" coordsize="3072,1008" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1048" style="LEFT: 553px; WIDTH: 330px; POSITION: absolute; TOP: 3401px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">调用</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1049" style="LEFT: 885px; WIDTH: 1335px; POSITION: absolute; TOP: 3389px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">GetRawInputData</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1050" style="LEFT: 2118px; WIDTH: 330px; POSITION: absolute; TOP: 3401px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">函数</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1051" style="LEFT: 956px; WIDTH: 330px; POSITION: absolute; TOP: 3602px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">获得</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1052" style="LEFT: 1288px; WIDTH: 450px; POSITION: absolute; TOP: 3602px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><em><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">pData</font></span></em></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1053" style="LEFT: 1703px; WIDTH: 375px; POSITION: absolute; TOP: 3602px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><em><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">大小</span></em></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1054" style="LEFT: 379px; WIDTH: 2241px; POSITION: absolute; TOP: 4381px; HEIGHT: 724px" stroked="f"></v:rect><v:shape id="_x0000_s1055" style="LEFT: 362px; WIDTH: 2276px; POSITION: absolute; TOP: 4363px; HEIGHT: 760px" path="m,24hdc,11,11,,24,hal3048,hdc3062,,3072,11,3072,24hal3072,1000hdc3072,1014,3062,1024,3048,1024hal24,1024hdc11,1024,,1014,,1000hal,24hdxm48,1000hal24,976r3024,l3024,1000r,-976l3048,48,24,48,48,24r,976hdxe" coordsize="3072,1024" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1056" style="LEFT: 553px; WIDTH: 330px; POSITION: absolute; TOP: 4557px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">调用</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1057" style="LEFT: 885px; WIDTH: 1335px; POSITION: absolute; TOP: 4546px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">GetRawInputData</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1058" style="LEFT: 2118px; WIDTH: 330px; POSITION: absolute; TOP: 4557px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">函数</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1059" style="LEFT: 790px; WIDTH: 330px; POSITION: absolute; TOP: 4760px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">获得</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1060" style="LEFT: 1122px; WIDTH: 765px; POSITION: absolute; TOP: 4748px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">RAWINPUT</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1061" style="LEFT: 1881px; WIDTH: 330px; POSITION: absolute; TOP: 4760px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">数据</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:shape id="_x0000_s1062" style="LEFT: 24px; WIDTH: 2928px; POSITION: absolute; TOP: 5639px; HEIGHT: 974px" stroked="f" path="m,487l1464,,2928,487,1464,974,,487xe" coordsize="2928,974"><v:path arrowok="t"></v:path></v:shape><v:shape id="_x0000_s1063" style="LEFT: 6px; WIDTH: 2964px; POSITION: absolute; TOP: 5621px; HEIGHT: 1010px" path="m17,703hdc7,700,,691,,680,,670,7,661,17,658hal1993,2hdc1998,,2003,,2008,2hal3984,658hdc3994,661,4000,670,4000,680v,11,-6,20,-16,23hal2008,1359hdc2003,1361,1998,1361,1993,1359hal17,703hdxm2008,1314hal1993,1314,3969,658r,45l1993,47r15,l32,703r,-45l2008,1314hdxe" coordsize="4000,1361" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1064" style="LEFT: 966px; WIDTH: 1125px; POSITION: absolute; TOP: 5824px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">header.dwType</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1065" style="LEFT: 1405px; WIDTH: 180px; POSITION: absolute; TOP: 6026px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">== </font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1066" style="LEFT: 883px; WIDTH: 1245px; POSITION: absolute; TOP: 6227px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">RIM_TYPEMOUSE</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:shape id="_x0000_s1067" style="LEFT: 1432px; WIDTH: 124px; POSITION: absolute; TOP: 6613px; HEIGHT: 624px" path="m91,r,825l75,825,75,,91,xm165,701l83,841,2,701hdc,697,1,692,5,690v4,-3,8,-1,11,2hal90,821r-13,l151,692hdc154,689,158,687,162,690v4,2,5,7,3,11haxe" coordsize="167,841" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><font face="Times New Roman"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></font></v:shape><v:shape id="_x0000_s1068" style="LEFT: 2952px; WIDTH: 534px; POSITION: absolute; TOP: 6053px; HEIGHT: 124px" path="m,79l705,75r,16l1,95,,79xm580,2l721,82,581,165hdc577,167,572,166,570,162v-2,-4,-1,-8,3,-11hal701,76r,14l572,16hdc568,13,567,9,569,5v2,-4,7,-5,11,-3haxe" coordsize="721,167" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><font face="Times New Roman"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></font></v:shape><v:rect id="_x0000_s1069" style="LEFT: 3486px; WIDTH: 1695px; POSITION: absolute; TOP: 5639px; HEIGHT: 962px" stroked="f"><font face="Times New Roman"></font></v:rect><v:shape id="_x0000_s1070" style="LEFT: 3468px; WIDTH: 1731px; POSITION: absolute; TOP: 5621px; HEIGHT: 998px" path="m,24hdc,11,11,,24,hal2312,hdc2326,,2336,11,2336,24hal2336,1320hdc2336,1334,2326,1344,2312,1344hal24,1344hdc11,1344,,1334,,1320hal,24hdxm48,1320hal24,1296r2288,l2288,1320r,-1296l2312,48,24,48,48,24r,1296hdxe" coordsize="2336,1344" strokeweight=".05pt" fillcolor="black"><font face="Times New Roman"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></font></v:shape><v:rect id="_x0000_s1071" style="LEFT: 3677px; WIDTH: 330px; POSITION: absolute; TOP: 5932px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">保存</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1072" style="LEFT: 4009px; WIDTH: 705px; POSITION: absolute; TOP: 5920px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">RawInput</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1073" style="LEFT: 4661px; WIDTH: 330px; POSITION: absolute; TOP: 5932px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">中的</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1074" style="LEFT: 3760px; WIDTH: 870px; POSITION: absolute; TOP: 6122px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">data.mouse</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1075" style="LEFT: 4566px; WIDTH: 330px; POSITION: absolute; TOP: 6134px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">数据</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1076" style="LEFT: 5631px; WIDTH: 1601px; POSITION: absolute; TOP: 5639px; HEIGHT: 962px" stroked="f"></v:rect><v:shape id="_x0000_s1077" style="LEFT: 5614px; WIDTH: 1636px; POSITION: absolute; TOP: 5621px; HEIGHT: 998px" path="m,24hdc,11,11,,24,hal2184,hdc2198,,2208,11,2208,24hal2208,1320hdc2208,1334,2198,1344,2184,1344hal24,1344hdc11,1344,,1334,,1320hal,24hdxm48,1320hal24,1296r2160,l2160,1320r,-1296l2184,48,24,48,48,24r,1296hdxe" coordsize="2208,1344" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1078" style="LEFT: 5776px; WIDTH: 330px; POSITION: absolute; TOP: 5932px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">检查</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1079" style="LEFT: 6108px; WIDTH: 870px; POSITION: absolute; TOP: 5920px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">data.mouse</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1080" style="LEFT: 6914px; WIDTH: 165px; POSITION: absolute; TOP: 5932px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">数</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1081" style="LEFT: 5847px; WIDTH: 1155px; POSITION: absolute; TOP: 6134px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">据中的坐标边界</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1082" style="LEFT: 3486px; WIDTH: 1339px; POSITION: absolute; TOP: 7147px; HEIGHT: 712px" stroked="f"></v:rect><v:shape id="_x0000_s1083" style="LEFT: 3468px; WIDTH: 1375px; POSITION: absolute; TOP: 7129px; HEIGHT: 748px" path="m,24hdc,11,11,,24,hal1832,hdc1846,,1856,11,1856,24hal1856,984hdc1856,998,1846,1008,1832,1008hal24,1008hdc11,1008,,998,,984hal,24hdxm48,984hal24,960r1808,l1808,984r,-960l1832,48,24,48,48,24r,960hdxe" coordsize="1856,1008" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1084" style="LEFT: 3653px; WIDTH: 990px; POSITION: absolute; TOP: 7328px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">重新以新坐标</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1085" style="LEFT: 3653px; WIDTH: 990px; POSITION: absolute; TOP: 7517px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">定位鼠标指针</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:shape id="_x0000_s1086" style="LEFT: 1385px; WIDTH: 124px; POSITION: absolute; TOP: 582px; HEIGHT: 337px" path="m94,1l92,438r-16,l78,,94,1xm166,314l83,454,3,313hdc,310,2,305,6,302v3,-2,8,,11,3hal91,434r-14,l152,306hdc154,302,159,301,163,303v4,3,5,8,3,11haxe" coordsize="168,454" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:shape id="_x0000_s1087" style="LEFT: 1432px; WIDTH: 125px; POSITION: absolute; TOP: 1638px; HEIGHT: 440px" path="m94,1l92,577r-16,l78,,94,1xm166,453l83,593,2,453hdc,449,2,444,5,442v4,-3,9,-1,11,3hal90,573r-13,l152,445hdc154,441,159,440,163,442v4,3,5,8,3,11haxe" coordsize="168,593" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:shape id="_x0000_s1088" style="LEFT: 1432px; WIDTH: 125px; POSITION: absolute; TOP: 2790px; HEIGHT: 440px" path="m94,1l92,577r-16,l78,,94,1xm166,453l83,593,2,453hdc,449,2,444,5,442v4,-3,9,-1,11,3hal90,573r-13,l152,445hdc154,441,159,440,163,442v4,3,5,8,3,11haxe" coordsize="168,593" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:shape id="_x0000_s1089" style="LEFT: 1432px; WIDTH: 125px; POSITION: absolute; TOP: 3953px; HEIGHT: 440px" path="m94,1l92,577r-16,l78,,94,1xm166,453l83,593,2,453hdc,449,2,444,5,442v4,-3,9,-1,11,3hal90,573r-13,l152,445hdc154,441,159,440,163,442v4,3,5,8,3,11haxe" coordsize="168,593" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:shape id="_x0000_s1090" style="LEFT: 1434px; WIDTH: 124px; POSITION: absolute; TOP: 5105px; HEIGHT: 529px" path="m101,1l90,697r-16,l85,r16,1xm165,574l81,713,2,572hdc,568,1,563,5,561v4,-2,9,-1,11,3hal89,693r-14,l152,566hdc154,562,159,561,163,563v4,3,5,8,2,11haxe" coordsize="168,713" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:shape id="_x0000_s1091" style="LEFT: 5181px; WIDTH: 445px; POSITION: absolute; TOP: 6054px; HEIGHT: 124px" path="m1,73r584,3l585,92,,89,1,73xm461,2l601,84,460,165hdc456,167,451,166,449,162v-2,-4,-1,-8,3,-11hal581,77r,14l453,16hdc449,13,448,8,450,5v2,-4,7,-5,11,-3haxe" coordsize="601,167" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:shape id="_x0000_s1092" style="LEFT: 818px; WIDTH: 1257px; POSITION: absolute; TOP: 7242px; HEIGHT: 546px" path="m,368hdc,165,380,,848,hal848,hdc1317,,1696,165,1696,368v,,,,,hal1696,368hdc1696,572,1317,736,848,736v,,,,,hal848,736hdc380,736,,572,,368v,,,,,xe" coordsize="1696,736" strokeweight="0"><v:path arrowok="t"></v:path></v:shape><v:shape id="_x0000_s1093" style="LEFT: 800px; WIDTH: 1293px; POSITION: absolute; TOP: 7224px; HEIGHT: 582px" path="m1,395hdc,393,,392,1,390hal5,352hdc5,350,5,348,6,346hal19,310hdc19,309,20,307,21,306hal42,271hdc43,270,43,269,44,268hal73,234r37,-34l155,167r52,-29l263,111,390,65,537,30,698,8,871,r173,7l1206,30r146,34l1481,110r57,27l1588,166r45,32l1670,232r31,36hdc1702,269,1702,270,1703,271hal1724,306hdc1725,307,1726,309,1726,310hal1739,346hdc1740,348,1740,350,1740,352hal1744,390hdc1745,392,1745,393,1744,395hal1740,433hdc1740,435,1740,437,1739,439hal1726,475hdc1726,476,1725,477,1724,479hal1703,515hdc1702,516,1702,517,1701,518hal1672,552r-37,34l1589,618r-49,29l1483,675r-129,45l1208,755r-161,22l873,784,700,777,539,755,393,721,265,676,208,648,158,619,113,588,75,554,44,518hdc43,517,42,516,42,515hal21,479hdc20,477,19,476,19,475hal6,439hdc5,437,5,435,5,433hal1,395hdxm52,428hal51,422r13,36l62,454r21,36l81,487r27,32l140,549r41,29l229,605r52,26l404,674r142,34l702,729r169,7l1040,730r157,-22l1339,675r123,-43l1515,606r47,-27l1602,551r33,-30l1664,487r-2,3l1683,454r-2,4l1694,422r-1,6l1697,390r,5l1693,357r1,6l1681,327r2,4l1662,296r2,3l1637,267r-33,-30l1563,207r-46,-27l1464,155,1341,111,1199,77,1042,55,873,48,705,55,548,77,407,110,284,154r-54,25l184,206r-41,29l110,265,81,299r2,-3l62,331r2,-4l51,363r1,-6l48,395r,-5l52,428hdxe" coordsize="1745,784" strokeweight=".05pt" fillcolor="black"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><v:rect id="_x0000_s1094" style="LEFT: 1275px; WIDTH: 330px; POSITION: absolute; TOP: 7426px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">结束</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1095" style="LEFT: 3072px; WIDTH: 165px; POSITION: absolute; TOP: 5779px; HEIGHT: 600px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">T</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1096" style="LEFT: 1205px; WIDTH: 150px; POSITION: absolute; TOP: 6848px; HEIGHT: 600px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-SIZE: 14pt; COLOR: black; FONT-FAMILY: Calibri; mso-bidi-font-family: Calibri"><font face="Times New Roman">F</font></span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:shape id="_x0000_s1097" style="LEFT: 2075px; WIDTH: 1422px; POSITION: absolute; TOP: 7451px; HEIGHT: 125px" path="m1919,78l16,93r,-16l1919,62r,16xm141,166l,85,140,3hdc144,,148,2,151,5v2,4,1,9,-3,11hal20,92r,-14l149,152hdc153,154,154,159,152,163v-2,4,-7,5,-11,3haxe" coordsize="1919,168" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><font face="Times New Roman"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></font></v:shape><v:shape id="_x0000_s1098" style="LEFT: 4825px; WIDTH: 2692px; POSITION: absolute; TOP: 6108px; HEIGHT: 1452px" path="m3240,r384,hdc3629,,3633,4,3633,8hal3633,1873hdc3633,1878,3629,1881,3624,1881hal16,1881r,-16l3624,1865r-8,8l3616,8r8,8l3240,16r,-16xm140,1955l,1873r140,-81hdc144,1789,149,1791,151,1795v3,3,1,8,-3,11hal20,1880r,-14l148,1941hdc152,1943,154,1948,151,1952v-2,4,-7,5,-11,3haxe" coordsize="3633,1957" strokeweight=".05pt" fillcolor="#4a7ebb" strokecolor="#4a7ebb"><font face="Times New Roman"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></font></v:shape><v:rect id="_x0000_s1099" style="LEFT: 3072px; WIDTH: 495px; POSITION: absolute; TOP: 1160px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">第一步</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1100" style="LEFT: 3072px; WIDTH: 495px; POSITION: absolute; TOP: 2319px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">第二步</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1101" style="LEFT: 3072px; WIDTH: 495px; POSITION: absolute; TOP: 3476px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">第三步</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1102" style="LEFT: 3072px; WIDTH: 495px; POSITION: absolute; TOP: 4634px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">第四步</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:rect id="_x0000_s1103" style="LEFT: 3872px; WIDTH: 495px; POSITION: absolute; TOP: 5168px; HEIGHT: 300px; mso-wrap-style: none; v-text-anchor: top" stroked="f" filled="f"><v:textbox style="mso-fit-shape-to-text: t" inset="0,0,0,0"></p>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="BORDER-RIGHT: #ece9d8; BORDER-TOP: #ece9d8; BORDER-LEFT: #ece9d8; BORDER-BOTTOM: #ece9d8; BACKGROUND-COLOR: transparent">
<div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 8pt; COLOR: black; FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">第五步</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p></v:textbox></v:rect><v:shape id="_x0000_s1104" style="LEFT: 6px; WIDTH: 7777px; POSITION: absolute; TOP: 5431px; HEIGHT: 2719px" path="m,3038r,-48l48,2990r,48l,3038xm,2942r,-48l48,2894r,48l,2942xm,2846r,-48l48,2798r,48l,2846xm,2750r,-48l48,2702r,48l,2750xm,2654r,-48l48,2606r,48l,2654xm,2558r,-48l48,2510r,48l,2558xm,2462r,-48l48,2414r,48l,2462xm,2366r,-48l48,2318r,48l,2366xm,2270r,-48l48,2222r,48l,2270xm,2174r,-48l48,2126r,48l,2174xm,2078r,-48l48,2030r,48l,2078xm,1982r,-48l48,1934r,48l,1982xm,1886r,-48l48,1838r,48l,1886xm,1790r,-48l48,1742r,48l,1790xm,1694r,-48l48,1646r,48l,1694xm,1598r,-48l48,1550r,48l,1598xm,1502r,-48l48,1454r,48l,1502xm,1406r,-48l48,1358r,48l,1406xm,1310r,-48l48,1262r,48l,1310xm,1214r,-48l48,1166r,48l,1214xm,1118r,-48l48,1070r,48l,1118xm,1022l,974r48,l48,1022r-48,xm,926l,878r48,l48,926,,926xm,830l,782r48,l48,830,,830xm,734l,686r48,l48,734,,734xm,638l,627,2,589r48,3l48,627r,11l,638xm7,539r6,-37hdc13,501,13,500,14,498hal17,489r45,14l59,513r1,-4l55,546,7,539xm31,443l45,397r46,14l77,457,31,443xm68,349l91,307r42,23l110,372,68,349xm119,263r31,-37l187,257r-31,37l119,263xm180,189r3,-3hdc184,185,185,184,186,183hal220,155r31,37l217,220r3,-3l217,220,180,189xm257,124r18,-15hdc276,108,278,107,279,106hal300,95r23,42l302,149r4,-3l287,161,257,124xm342,72l381,50hdc382,50,384,49,385,49hal389,47r14,46l400,94r4,-1l365,114,342,72xm435,33l481,19r14,46l449,79,435,33xm531,8l562,4,581,3r2,48l569,51r-31,5l531,8xm630,r48,l678,48r-48,l630,xm726,r48,l774,48r-48,l726,xm822,r48,l870,48r-48,l822,xm918,r48,l966,48r-48,l918,xm1014,r48,l1062,48r-48,l1014,xm1110,r48,l1158,48r-48,l1110,xm1206,r48,l1254,48r-48,l1206,xm1302,r48,l1350,48r-48,l1302,xm1398,r48,l1446,48r-48,l1398,xm1494,r48,l1542,48r-48,l1494,xm1590,r48,l1638,48r-48,l1590,xm1686,r48,l1734,48r-48,l1686,xm1782,r48,l1830,48r-48,l1782,xm1878,r48,l1926,48r-48,l1878,xm1974,r48,l2022,48r-48,l1974,xm2070,r48,l2118,48r-48,l2070,xm2166,r48,l2214,48r-48,l2166,xm2262,r48,l2310,48r-48,l2262,xm2358,r48,l2406,48r-48,l2358,xm2454,r48,l2502,48r-48,l2454,xm2550,r48,l2598,48r-48,l2550,xm2646,r48,l2694,48r-48,l2646,xm2742,r48,l2790,48r-48,l2742,xm2838,r48,l2886,48r-48,l2838,xm2934,r48,l2982,48r-48,l2934,xm3030,r48,l3078,48r-48,l3030,xm3126,r48,l3174,48r-48,l3126,xm3222,r48,l3270,48r-48,l3222,xm3318,r48,l3366,48r-48,l3318,xm3414,r48,l3462,48r-48,l3414,xm3510,r48,l3558,48r-48,l3510,xm3606,r48,l3654,48r-48,l3606,xm3702,r48,l3750,48r-48,l3702,xm3798,r48,l3846,48r-48,l3798,xm3894,r48,l3942,48r-48,l3894,xm3990,r48,l4038,48r-48,l3990,xm4086,r48,l4134,48r-48,l4086,xm4182,r48,l4230,48r-48,l4182,xm4278,r48,l4326,48r-48,l4278,xm4374,r48,l4422,48r-48,l4374,xm4470,r48,l4518,48r-48,l4470,xm4566,r48,l4614,48r-48,l4566,xm4662,r48,l4710,48r-48,l4662,xm4758,r48,l4806,48r-48,l4758,xm4854,r48,l4902,48r-48,l4854,xm4950,r48,l4998,48r-48,l4950,xm5046,r48,l5094,48r-48,l5046,xm5142,r48,l5190,48r-48,l5142,xm5238,r48,l5286,48r-48,l5238,xm5334,r48,l5382,48r-48,l5334,xm5430,r48,l5478,48r-48,l5430,xm5526,r48,l5574,48r-48,l5526,xm5622,r48,l5670,48r-48,l5622,xm5718,r48,l5766,48r-48,l5718,xm5814,r48,l5862,48r-48,l5814,xm5910,r48,l5958,48r-48,l5910,xm6006,r48,l6054,48r-48,l6006,xm6102,r48,l6150,48r-48,l6102,xm6198,r48,l6246,48r-48,l6198,xm6294,r48,l6342,48r-48,l6294,xm6390,r48,l6438,48r-48,l6390,xm6486,r48,l6534,48r-48,l6486,xm6582,r48,l6630,48r-48,l6582,xm6678,r48,l6726,48r-48,l6678,xm6774,r48,l6822,48r-48,l6774,xm6870,r48,l6918,48r-48,l6870,xm6966,r48,l7014,48r-48,l6966,xm7062,r48,l7110,48r-48,l7062,xm7158,r48,l7206,48r-48,l7158,xm7254,r48,l7302,48r-48,l7254,xm7350,r48,l7398,48r-48,l7350,xm7446,r48,l7494,48r-48,l7446,xm7542,r48,l7590,48r-48,l7542,xm7638,r48,l7686,48r-48,l7638,xm7734,r48,l7782,48r-48,l7734,xm7830,r48,l7878,48r-48,l7830,xm7926,r48,l7974,48r-48,l7926,xm8022,r48,l8070,48r-48,l8022,xm8118,r48,l8166,48r-48,l8118,xm8214,r48,l8262,48r-48,l8214,xm8310,r48,l8358,48r-48,l8310,xm8406,r48,l8454,48r-48,l8406,xm8502,r48,l8550,48r-48,l8502,xm8598,r48,l8646,48r-48,l8598,xm8694,r48,l8742,48r-48,l8694,xm8790,r48,l8838,48r-48,l8790,xm8886,r48,l8934,48r-48,l8886,xm8982,r48,l9030,48r-48,l8982,xm9078,r48,l9126,48r-48,l9078,xm9174,r48,l9222,48r-48,l9174,xm9270,r48,l9318,48r-48,l9270,xm9366,r48,l9414,48r-48,l9366,xm9462,r48,l9510,48r-48,l9462,xm9558,r48,l9606,48r-48,l9558,xm9654,r48,l9702,48r-48,l9654,xm9750,r48,l9798,48r-48,l9750,xm9846,r24,l9870,48r-24,l9846,xm9872,r23,2l9893,50r-24,-2l9872,xm9946,5r47,7l9986,60r-48,-7l9946,5xm10042,27r46,14l10074,87r-46,-14l10042,27xm10137,61r42,23l10156,127r-42,-24l10137,61xm10225,111r37,30l10231,178r-37,-31l10225,111xm10298,172r14,11hdc10313,184,10314,185,10315,186hal10334,210r-37,30l10278,217r3,3l10268,209r30,-37xm10365,247r23,28hdc10389,276,10390,278,10391,279hal10396,289r-42,23l10348,302r3,4l10328,277r37,-30xm10419,331r23,42l10400,396r-23,-42l10419,331xm10460,423r14,46l10428,483r-14,-46l10460,423xm10487,519r6,43l10494,568r-48,3l10446,569r-7,-43l10487,519xm10496,616r,10l10448,629r,-10l10496,616xm10496,627r,39l10448,666r,-39l10496,627xm10496,714r,48l10448,762r,-48l10496,714xm10496,810r,48l10448,858r,-48l10496,810xm10496,906r,48l10448,954r,-48l10496,906xm10496,1002r,48l10448,1050r,-48l10496,1002xm10496,1098r,48l10448,1146r,-48l10496,1098xm10496,1194r,48l10448,1242r,-48l10496,1194xm10496,1290r,48l10448,1338r,-48l10496,1290xm10496,1386r,48l10448,1434r,-48l10496,1386xm10496,1482r,48l10448,1530r,-48l10496,1482xm10496,1578r,48l10448,1626r,-48l10496,1578xm10496,1674r,48l10448,1722r,-48l10496,1674xm10496,1770r,48l10448,1818r,-48l10496,1770xm10496,1866r,48l10448,1914r,-48l10496,1866xm10496,1962r,48l10448,2010r,-48l10496,1962xm10496,2058r,48l10448,2106r,-48l10496,2058xm10496,2154r,48l10448,2202r,-48l10496,2154xm10496,2250r,48l10448,2298r,-48l10496,2250xm10496,2346r,48l10448,2394r,-48l10496,2346xm10496,2442r,48l10448,2490r,-48l10496,2442xm10496,2538r,48l10448,2586r,-48l10496,2538xm10496,2634r,48l10448,2682r,-48l10496,2634xm10496,2730r,48l10448,2778r,-48l10496,2730xm10496,2826r,48l10448,2874r,-48l10496,2826xm10496,2922r,48l10448,2970r,-48l10496,2922xm10496,3018r,20l10448,3038r,-20l10496,3018xm10496,3040r-1,27l10447,3064r1,-27l10496,3040xm10491,3117r-7,46hdc10484,3164,10484,3165,10483,3167hal10483,3168r-46,-14l10438,3152r-1,4l10444,3110r47,7xm10469,3214r-14,46l10409,3245r14,-45l10469,3214xm10434,3308r-23,42l10369,3327r23,-42l10434,3308xm10384,3395r-30,37l10317,3402r30,-37l10384,3395xm10324,3469r-9,11hdc10314,3481,10313,3482,10312,3483hal10285,3505r-31,-37l10281,3446r-3,3l10286,3439r38,30xm10248,3535r-25,21hdc10222,3557,10220,3558,10219,3558hal10205,3566r-23,-42l10196,3516r-4,3l10217,3498r31,37xm10163,3589r-42,23l10098,3570r42,-23l10163,3589xm10071,3629r-46,14l10011,3597r46,-14l10071,3629xm9975,3655r-39,6l9925,3662r-2,-48l9929,3614r39,-6l9975,3655xm9877,3664r-5,l9869,3616r6,l9877,3664xm9870,3664r-42,l9828,3616r42,l9870,3664xm9780,3664r-48,l9732,3616r48,l9780,3664xm9684,3664r-48,l9636,3616r48,l9684,3664xm9588,3664r-48,l9540,3616r48,l9588,3664xm9492,3664r-48,l9444,3616r48,l9492,3664xm9396,3664r-48,l9348,3616r48,l9396,3664xm9300,3664r-48,l9252,3616r48,l9300,3664xm9204,3664r-48,l9156,3616r48,l9204,3664xm9108,3664r-48,l9060,3616r48,l9108,3664xm9012,3664r-48,l8964,3616r48,l9012,3664xm8916,3664r-48,l8868,3616r48,l8916,3664xm8820,3664r-48,l8772,3616r48,l8820,3664xm8724,3664r-48,l8676,3616r48,l8724,3664xm8628,3664r-48,l8580,3616r48,l8628,3664xm8532,3664r-48,l8484,3616r48,l8532,3664xm8436,3664r-48,l8388,3616r48,l8436,3664xm8340,3664r-48,l8292,3616r48,l8340,3664xm8244,3664r-48,l8196,3616r48,l8244,3664xm8148,3664r-48,l8100,3616r48,l8148,3664xm8052,3664r-48,l8004,3616r48,l8052,3664xm7956,3664r-48,l7908,3616r48,l7956,3664xm7860,3664r-48,l7812,3616r48,l7860,3664xm7764,3664r-48,l7716,3616r48,l7764,3664xm7668,3664r-48,l7620,3616r48,l7668,3664xm7572,3664r-48,l7524,3616r48,l7572,3664xm7476,3664r-48,l7428,3616r48,l7476,3664xm7380,3664r-48,l7332,3616r48,l7380,3664xm7284,3664r-48,l7236,3616r48,l7284,3664xm7188,3664r-48,l7140,3616r48,l7188,3664xm7092,3664r-48,l7044,3616r48,l7092,3664xm6996,3664r-48,l6948,3616r48,l6996,3664xm6900,3664r-48,l6852,3616r48,l6900,3664xm6804,3664r-48,l6756,3616r48,l6804,3664xm6708,3664r-48,l6660,3616r48,l6708,3664xm6612,3664r-48,l6564,3616r48,l6612,3664xm6516,3664r-48,l6468,3616r48,l6516,3664xm6420,3664r-48,l6372,3616r48,l6420,3664xm6324,3664r-48,l6276,3616r48,l6324,3664xm6228,3664r-48,l6180,3616r48,l6228,3664xm6132,3664r-48,l6084,3616r48,l6132,3664xm6036,3664r-48,l5988,3616r48,l6036,3664xm5940,3664r-48,l5892,3616r48,l5940,3664xm5844,3664r-48,l5796,3616r48,l5844,3664xm5748,3664r-48,l5700,3616r48,l5748,3664xm5652,3664r-48,l5604,3616r48,l5652,3664xm5556,3664r-48,l5508,3616r48,l5556,3664xm5460,3664r-48,l5412,3616r48,l5460,3664xm5364,3664r-48,l5316,3616r48,l5364,3664xm5268,3664r-48,l5220,3616r48,l5268,3664xm5172,3664r-48,l5124,3616r48,l5172,3664xm5076,3664r-48,l5028,3616r48,l5076,3664xm4980,3664r-48,l4932,3616r48,l4980,3664xm4884,3664r-48,l4836,3616r48,l4884,3664xm4788,3664r-48,l4740,3616r48,l4788,3664xm4692,3664r-48,l4644,3616r48,l4692,3664xm4596,3664r-48,l4548,3616r48,l4596,3664xm4500,3664r-48,l4452,3616r48,l4500,3664xm4404,3664r-48,l4356,3616r48,l4404,3664xm4308,3664r-48,l4260,3616r48,l4308,3664xm4212,3664r-48,l4164,3616r48,l4212,3664xm4116,3664r-48,l4068,3616r48,l4116,3664xm4020,3664r-48,l3972,3616r48,l4020,3664xm3924,3664r-48,l3876,3616r48,l3924,3664xm3828,3664r-48,l3780,3616r48,l3828,3664xm3732,3664r-48,l3684,3616r48,l3732,3664xm3636,3664r-48,l3588,3616r48,l3636,3664xm3540,3664r-48,l3492,3616r48,l3540,3664xm3444,3664r-48,l3396,3616r48,l3444,3664xm3348,3664r-48,l3300,3616r48,l3348,3664xm3252,3664r-48,l3204,3616r48,l3252,3664xm3156,3664r-48,l3108,3616r48,l3156,3664xm3060,3664r-48,l3012,3616r48,l3060,3664xm2964,3664r-48,l2916,3616r48,l2964,3664xm2868,3664r-48,l2820,3616r48,l2868,3664xm2772,3664r-48,l2724,3616r48,l2772,3664xm2676,3664r-48,l2628,3616r48,l2676,3664xm2580,3664r-48,l2532,3616r48,l2580,3664xm2484,3664r-48,l2436,3616r48,l2484,3664xm2388,3664r-48,l2340,3616r48,l2388,3664xm2292,3664r-48,l2244,3616r48,l2292,3664xm2196,3664r-48,l2148,3616r48,l2196,3664xm2100,3664r-48,l2052,3616r48,l2100,3664xm2004,3664r-48,l1956,3616r48,l2004,3664xm1908,3664r-48,l1860,3616r48,l1908,3664xm1812,3664r-48,l1764,3616r48,l1812,3664xm1716,3664r-48,l1668,3616r48,l1716,3664xm1620,3664r-48,l1572,3616r48,l1620,3664xm1524,3664r-48,l1476,3616r48,l1524,3664xm1428,3664r-48,l1380,3616r48,l1428,3664xm1332,3664r-48,l1284,3616r48,l1332,3664xm1236,3664r-48,l1188,3616r48,l1236,3664xm1140,3664r-48,l1092,3616r48,l1140,3664xm1044,3664r-48,l996,3616r48,l1044,3664xm948,3664r-48,l900,3616r48,l948,3664xm852,3664r-48,l804,3616r48,l852,3664xm756,3664r-48,l708,3616r48,l756,3664xm660,3664r-33,l627,3616r33,l660,3664xm626,3664r-15,l614,3616r15,l626,3664xm561,3661r-48,-7l521,3606r47,8l561,3661xm464,3641r-46,-15l432,3581r46,14l464,3641xm369,3608r-43,-23l350,3543r42,23l369,3608xm284,3562r-5,-4hdc278,3558,276,3557,275,3556hal243,3530r30,-38l306,3519r-4,-3l308,3519r-24,43xm206,3499r-20,-16hdc185,3482,184,3481,183,3480hal169,3462r36,-30l220,3449r-3,-3l236,3462r-30,37xm138,3425r-29,-34hdc108,3390,107,3388,106,3387hal105,3384r42,-23l149,3364r-3,-4l175,3395r-37,30xm82,3342l59,3300r42,-23l124,3319r-42,23xm40,3251l25,3205r46,-14l85,3237r-45,14xm12,3156l4,3108r48,-7l59,3149r-47,7xm1,3058l,3040r48,-3l49,3056r-48,2xe" coordsize="10496,3664" strokeweight=".05pt" fillcolor="#4f81bd" strokecolor="#4f81bd"><v:path arrowok="t"></v:path><o:lock v:ext="edit" verticies="t"></o:lock></v:shape><w:wrap type="none"></w:wrap><w:anchorlock></w:anchorlock></v:group></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 10pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><span style="mso-tab-count: 7"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><font size="3"><span style="LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">图</span><span lang="EN-US" style="LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt"><font face="Times New Roman">2.2 RawInput</font></span><span style="LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">各鼠标输入数据识别流程图</span><span lang="EN-US" style="LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman" size="3">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><font size="3"><span lang="EN-US"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">第一步，用</span></font><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">GetRawInputDeviceList</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数获取</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备数量。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">GetRawInputDeviceList</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的函数原型如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">UINT&nbsp;GetRawInputDeviceList(<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;PRAWINPUTDEVICELIST&nbsp;pRawInputDeviceList,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;PUINT&nbsp;puiNumDevices,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;UINT&nbsp;cbSize<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当第一参数为</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">NULL</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的时候，第二参数为输出，输出的是</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备数量。第三参数一般为</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RAWINPUTDEVICELIST</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">的大小。</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">所以可以以下方式调用以获得</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备数量。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">UINT nDevices;<span style="COLOR: green"><o:p></o:p></span></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputDeviceList(NULL, &amp;nDevices, <span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST)) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">调用以后，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">nDevices</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">就是</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备的数量。但是假如需要确定的鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备数量，就还需要再一次以第一参数为输出调用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">GetRawInputDeviceList</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数，这里首先需要了解</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RAWINPUTDEVICELIST</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RAWINPUTDEVICELIST</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构定义如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">typedef struct tagRAWINPUTDEVICELIST&nbsp;{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>HANDLE&nbsp;hDevice;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>DWORD&nbsp;dwType;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">} RAWINPUTDEVICELIST, *PRAWINPUTDEVICELIST;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当在第二参数中给定</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备的数量为输入时，第一参数就可以输出</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RAWINPUTDEVICELIST</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构类型的输出。调用方式如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">PRAWINPUTDEVICELIST pRawInputDeviceList;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">pRawInputDeviceList = (RAWINPUTDEVICELIST *) calloc( nDevices, <span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputDeviceList(pRawInputDeviceList,&amp;nDevices, <span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">这里的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">nDevices</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">必须已经经过上一步的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputDeviceList</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">调用，值已经是</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备的数量。这时可以通过判断</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">pRawInputDeviceList</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">各成员</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">dwType</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">值是否等于</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"> <span lang="EN-US">RIM_TYPEMOUSE</span></font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">来判断此</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备是否为鼠标的输入。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">第二步：</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 12.0pt"><font face="Times New Roman">RegisterRawInputDevices</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数注册</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 12.0pt"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备。这一步最需要注意，在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 12.0pt"><font face="Times New Roman">Windows</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中一般情况下并不会让用户获取原始输入数据</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 12.0pt"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，所以使用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputData</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">函数前必须先注册</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备。注册</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">的步骤就是通过调用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 12.0pt"><font face="Times New Roman">RegisterRawInputDevices</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数完成的。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 12.0pt"><font face="Times New Roman">RegisterRawInputDevices</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数原型如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 12.0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 12.0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">BOOL&nbsp;RegisterRawInputDevices(<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PCRAWINPUTDEVICE&nbsp;pRawInputDevices,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;<span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UINT&nbsp;uiNumDevices,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UINT&nbsp;cbSize<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">第一参数为一个</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 13.0pt"><font face="Times New Roman">RAWINPUTDEVICE</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 13.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构的指针，第二参数给定需要注册</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 13.0pt"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 13.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备的数量，第三参数为第一参数的大小。</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在这里要知道怎么注册又需要先了解</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 13.0pt"><font face="Times New Roman">RAWINPUTDEVICE</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 13.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构，其结构定义如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 13.0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 13.0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">typedef struct tagRAWINPUTDEVICE&nbsp;{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>USHORT&nbsp;usUsagePage;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>USHORT&nbsp;usUsage;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>DWORD&nbsp;dwFlags;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>HWND&nbsp;hwndTarget;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">} RAWINPUTDEVICE, *PRAWINPUTDEVICE, *LPRAWINPUTDEVICE;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">当</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">dwFlags</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设为</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">NULL</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">时，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">Windows</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">追随输入焦点接受</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">数据。而第四参数就是指定的输入焦点，假如第四参数为</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">NULL</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，那么</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">Windows</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">接受</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">数据的窗口就是目前的键盘焦点窗口。这两个参数设定就是一般时所需要的，比如以下的方式就注册了一个</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">设备</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">,</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">并且当注册失败时弹出对话框提示：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RAWINPUTDEVICE Raw[1];<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">Rid[0].usUsagePage = 0x01; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">Rid[0].usUsage = 0x02; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">Rid[0].dwFlags = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">Rid[0].hwndTarget = NULL;</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">if</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> (RegisterRawInputDevices(Rid, 1, <span style="COLOR: blue">sizeof</span> (Rid [0])) == FALSE) {<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MessageBox(hWnd,<span style="COLOR: maroon">&quot;RawInput Register Error.&quot;</span>,<span style="COLOR: maroon">&quot;RawInput init failed!&quot;</span>,MB_OK);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">这里需要注意的是并不是有多少个鼠标输入就需要注册多少个</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备，一般来说，注册一个</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备处理目前焦点的原始输入数据就足够了，同样可以获得所有的鼠标原始输入数据。除非想对不同焦点的原始输入数据进行处理，才需要注册多个</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">usUsagePage </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">与</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">usUsage </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">不同的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p style="TEXT-JUSTIFY: inter-ideograph; MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: justify"><font size="3"><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-bidi-font-family: 宋体; mso-no-proof: yes'><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><font face="宋体"><span style="mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第三步：</span><span style="COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">调用</span></font><span lang="EN-US" style='COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs'>GetRawInputData</span><span style="COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="宋体">函数获得</font></span><span lang="EN-US" style='COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-bidi-font-style: italic'>pData</span><font face="宋体"><span style="COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-bidi-font-style: italic">大小。</span><span style="COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">这里要说明的是</span></font><span lang="EN-US" style='COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs'>GetRawInputData</span><span style="COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri"><font face="宋体">一般要在响应</font></span><span lang="EN-US" style='COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs'>WM_INPUT</span><span style="COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri"><font face="宋体">消息时调用，不能随时调用。</font></span><span lang="EN-US" style='COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs'>GetRawInputData</span><font face="宋体"><span style="COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">函数原型如下：</span><span lang="EN-US" style='COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs'><o:p></o:p></span></font></font></p>
<p style="TEXT-JUSTIFY: inter-ideograph; MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: justify"><span lang="EN-US" style='COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: "Times New Roman"; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs'><o:p><font size="3">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">UINT&nbsp;GetRawInputData(<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;HRAWINPUT&nbsp;hRawInput,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;UINT&nbsp;uiCommand,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;pData,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;PUINT&nbsp;pcbSize,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;UINT&nbsp;cbSizeHeader<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs">GetRawInputData</span></font><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">第一参数为一个</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">结构的句柄，来自</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">WM_INPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">消息的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">lParam </font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">参数。要说明的是</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">GetRawInputData</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">并不是一个随时调用以检测有无</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">设备输入的函数，实际上是一个对</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">WM_INPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">消息的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">lParam </font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">参数的解析函数，主要用途是从</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">WM_INPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">消息的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">lParam </font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">参数中提取出有用的信息，并加以组织成一个</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">结构输出，当然，由于</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">WM_INPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: Calibri">消息的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">lParam </font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">参数传进来的是个句柄，实际上解析的是其代表的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构数据。这也是</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">GetRawInputData</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">一般在响应</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">WM_INPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">消息时调用的原因。第二参数为</span><span class="clsliteral"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 8.0pt"><font face="Courier New">RID_INPUT</font></span></span><span class="clsliteral"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 8.0pt; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'">时，</span></span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">GetRawInputData</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">才输出</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">信息。第三参数用以输出最后的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构数据，当为</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">NULL</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">时在第四参数输出本参数大小。第四参数用以制定第三参数大小，第五个参数在只需要调用</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构输出的时候一般可以设为</span><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">sizeof</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">(RAWINPUTHEADER)</span></font><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">。因为我们一开始不知道</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">GetRawInputData</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">第三参数的大小，必须以</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">NULL</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为第三参数先调用一次</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">GetRawInputData</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">以从第四参数获得第三参数</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><font face="Times New Roman">pData</font></span><span style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">大小。调用方式如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">UINT dwSize;</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: black; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 12.0pt; mso-bidi-font-family: +mn-cs"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">case</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> WM_INPUT: <o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputData((HRAWINPUT)lParam, RID_INPUT, NULL, &amp;dwSize, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">sizeof</span>(RAWINPUTHEADER));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">...<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这样调用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputData</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">函数后，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">dwSize</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">就指示了其第三参数</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">pData</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">的大小。为下一次调用以输出</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">数据做准备。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p style="TEXT-JUSTIFY: inter-ideograph; MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: justify"><font size="3"><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-bidi-font-family: 宋体; mso-no-proof: yes'><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><font face="宋体"><span style="mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第四步：</span><span style="mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">调用</span></font><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-font-kerning: 12.0pt; mso-bidi-font-family: 宋体'>GetRawInputData</span><span style="mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="宋体">函数获得</font></span><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-font-kerning: 12.0pt; mso-bidi-font-family: 宋体'>RAWINPUT</span><span style="mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="宋体">数据。在获得</font></span><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-font-kerning: 12.0pt; mso-bidi-font-family: 宋体'>GetRawInputData</span><span style="mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="宋体">第三参数</font></span><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-font-kerning: 12.0pt; mso-bidi-font-family: 宋体'>pData</span><span style="mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="宋体">大小后就可以直接调用</font></span><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-font-kerning: 12.0pt; mso-bidi-font-family: 宋体'>GetRawInputData</span><span style="mso-font-kerning: 12.0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="宋体">获得</font></span><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-bidi-font-family: 宋体; mso-no-proof: yes'>RAWINPUT</span><span style="mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes"><font face="宋体">数据了。这里要说明的是第三参数为一个空指针，调用前先用刚才得到的</font></span><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-bidi-font-family: 宋体; mso-no-proof: yes'>dwSize</span><font face="宋体"><span style="mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">参数分配足够的空间，并且调用完后必须强制转换才能得到想要的结果。实际调用源代码如下：</span><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-bidi-font-family: 宋体; mso-no-proof: yes'><o:p></o:p></span></font></font></p>
<p style="TEXT-JUSTIFY: inter-ideograph; MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: justify"><span lang="EN-US" style='FONT-FAMILY: "Times New Roman"; mso-bidi-font-family: 宋体'><o:p><font size="3">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">LPVOID lpb;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RAWINPUT *raw;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">case</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> WM_INPUT: <o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">{</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">...<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">lpb = malloc(<span style="COLOR: blue">sizeof</span>(LPVOID) * dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">if</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> (lpb == NULL) <o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">} <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputData((HRAWINPUT)lParam, RID_INPUT, lpb, &amp;dwSize, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;</span><span style="COLOR: blue">sizeof</span>(RAWINPUTHEADER));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">raw = (RAWINPUT*)lpb;</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">第五步：这里我们已经可以通过调用以上四步得到的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">数据来获得想要的数据了，这里以指针</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">raw</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">表示，首先看</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构的定义：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">typedef struct tagRAWINPUT { <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>RAWINPUTHEADER<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>header; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>union {<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RAWMOUSE<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>mouse; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RAWKEYBOARD keyboard; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>RAWHID<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hid; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} data;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">} RAWINPUT, *PRAWINPUT; *LPRAWINPUT;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">首先我们可以通过</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">检测</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">header</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">是否等于</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RIM_TYPEMOUSE</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，了解是否这次</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">输入得到的是否是鼠标输入数据，只有</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">等于时</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">想要读取的是</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构才是鼠标的输入数据。这时我们才可以通过读取</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">RAWMOUSE</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构数据获得鼠标的具体输入信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">,RAWMOUSE</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构又很复杂，其本身又是</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构中定义的一个名为</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">data</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的联合。首先看</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">RAWMOUSE</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构的定义：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">typedef struct tagRAWMOUSE { <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp; </span>USHORT<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>usFlags; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp; </span>union {<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ULONG<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>ulButtons;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>struct {<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>USHORT usButtonFlags;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>USHORT usButtonData;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>};<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp; </span>};<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp; </span>ULONG ulRawButtons;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp; </span>LONG<span style="mso-spacerun: yes">&nbsp; </span>lLastX;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp; </span>LONG<span style="mso-spacerun: yes">&nbsp; </span>lLastY;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp; </span>ULONG ulExtraInformation;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">} RAWMOUSE, *PRAWMOUSE, *LPRAWMOUSE;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">其中主要用到的是以下几个数据，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">usFlags</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">是用来指定鼠标状态的，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">usButtonFlags</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">指示了按键状况，只需要通过与以下值的对比就可以知道有哪些按键按下与松开：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RI_MOUSE_LEFT_BUTTON_DOWN <span style="mso-spacerun: yes">&nbsp;</span></font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">左键按下</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RI_MOUSE_LEFT_BUTTON_UP </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">左键松开</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RI_MOUSE_MIDDLE_BUTTON_DOWN </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中键按下</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RI_MOUSE_MIDDLE_BUTTON_UP </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中键松开</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RI_MOUSE_RIGHT_BUTTON_DOWN </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">右键按下</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RI_MOUSE_RIGHT_BUTTON_UP </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">右键松开</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>lLastX</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastY</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">指示了鼠标的移动，其值的含义由</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">usFlags</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">决定，当</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">usFlags</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">等于</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">MOUSE_MOVE_RELATIVE</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">时，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastX</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastY</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">值表示鼠标相对于上一点的移动，当</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">usFlags</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">等于</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">MOUSE_MOVE_ABSOLUTE</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">时，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastX</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLast</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的值表示鼠标的绝对移动，大概含义等于相对于某固定点的移动。要注意的是，无论是那种方式，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastX</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLast</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">都指示的是一个相对移动的数据，以屏幕坐标轴来看，当向上移动</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastX</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为负，向下移动</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastX</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为正，向左移动</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastY</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为负，向右移动</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">lLastY</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为正，其值大小表示的是偏差。实际要获得鼠标的绝对坐标还需要经过一定处理，代码如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">long</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> X;<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">long</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> Y;<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">if</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> (raw-&gt;header.dwType == RIM_TYPEMOUSE)<span style="COLOR: green"><o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.usFlags = MOUSE_MOVE_ABSOLUTE;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>X += raw-&gt;data.mouse.lLastX;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Y += raw-&gt;data.mouse.lLastY;</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">通过这样的调用，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">X,Y</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">才是想要的鼠标坐标。另外，得到坐标后应该做边界检查，以鼠标指针在屏幕边界后</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">X,Y</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">超出有意义的坐标值或为负值。而且，在大部分情况下，当高速移动鼠标时，系统的消息处理会跟不上鼠标的移动，在处理完坐标后应该以此坐标重定位鼠标指针，以防消息丢失导致的实际坐标与指针的不一致。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在以下的程序中，详细演示了利用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">获得各鼠标输入数据并加以处理显示在屏幕上的过程。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-ascii-font-family: 'Times New Roman'">各鼠标</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'">输入数据识别测试程序</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-bidi-font-size: 9.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">具体代码（以下代码在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">Visual studio .NET 2005 </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-bidi-font-size: 9.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">上编译通过）</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&quot;stdafx.h&quot;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&lt;stdlib.h&gt;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&lt;string.h&gt;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#define</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> _WIN32_WINNT 0x0501<span style="mso-spacerun: yes">&nbsp;&nbsp; </span><span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">定义此程序为</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">Windows XP</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">程序</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&lt;windows.h&gt;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: maroon; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">char</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> mousemessage[256];<span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">// </span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第一个字符串缓存主要储存原始设备输入信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">char</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> mousemessage2[256];<span style="mso-tab-count: 1"> </span><span style="COLOR: green">// </span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第二个字符串缓存储存经过分析处理的输入信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">char</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> rawinputdevices[256];<span style="mso-tab-count: 1"> </span><span style="COLOR: green">// </span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">输入设备数量的字符串缓存</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">long</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> X;<span style="mso-tab-count: 1">&nbsp;&nbsp; </span><span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">鼠标的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">X</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">坐标值</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">long</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> Y;<span style="mso-tab-count: 1">&nbsp;&nbsp; </span><span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">鼠标的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">Y</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">坐标值</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">char</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> mousemessage[256];<span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">// </span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第一个字符串缓存主要储存原始设备输入信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">char</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> mousemessage2[256];<span style="mso-tab-count: 1"> </span><span style="COLOR: green">// </span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第二个字符串缓存储存经过分析处理的输入信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">char</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> rawinputdevices[256];<span style="mso-tab-count: 1"> </span><span style="COLOR: green">// </span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">输入设备数量的字符串缓存</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">long</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> X;<span style="mso-tab-count: 1">&nbsp;&nbsp; </span><span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">鼠标的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">X</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">坐标值</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">long</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> Y;<span style="mso-tab-count: 1">&nbsp;&nbsp; </span><span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">鼠标的</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">Y</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">坐标值</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">//RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">初始化函数</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">void</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> InitRawInput(HWND hwnd)<span style="mso-spacerun: yes">&nbsp; </span><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RAWINPUTDEVICE Rid[1]; <span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">分配</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备的空间</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UINT nDevices;<span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">输入设备的数量</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">获得输入设备的数量</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputDeviceList(NULL, &amp;nDevices, <span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST)); <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PRAWINPUTDEVICELIST pRawInputDeviceList;<span style="COLOR: green">// = new RAWINPUTDEVICELIST[nDevices];<o:p></o:p></span></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pRawInputDeviceList=(RAWINPUTDEVICELIST *)calloc(nDevices, <span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputDeviceList(pRawInputDeviceList, &amp;nDevices, <span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">int</span> nMouseNumber = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=0; i &lt; nDevices; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(pRawInputDeviceList[i].dwType == RIM_TYPEMOUSE)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>++nMouseNumber;<span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">将输入设备数量写入</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">rawinputdevices</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">缓存</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wsprintf(rawinputdevices,<span style="COLOR: maroon">&quot;Number of raw input devices: %i/n&quot;<o:p></o:p></span></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: maroon">&quot;Number of raw input mouse: %i/n&quot;</span>, nDevices,nMouseNumber);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>free(pRawInputDeviceList);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">初始化第</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">1</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">个</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Rid[0].usUsagePage = 0x01; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Rid[0].usUsage = 0x02; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Rid[0].dwFlags = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Rid[0].hwndTarget = NULL;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">注册</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (RegisterRawInputDevices(Rid, 1, <span style="COLOR: blue">sizeof</span> (Rid [0])) == FALSE) {<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MessageBox(hwnd,<span style="COLOR: maroon">&quot;RawInput Register Error.&quot;</span>,<span style="COLOR: maroon">&quot;RawInput init failed!&quot;</span>,MB_OK);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">初始化</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">X,Y</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">坐标信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POINT pt;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetCursorPos(&amp;pt);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>X = pt.x;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Y = pt.y;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> ;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">//</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">检查边界的函数</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">void</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> CheckBound(HDC hdc,<span style="COLOR: blue">long</span> &amp;x,<span style="COLOR: blue">long</span> &amp;y)<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(x&lt;0)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>x = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(y&lt;0)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>y = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">最大值由</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetDeviceCaps</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">函数获取以适应不同系统设置</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(x&gt;(<span style="COLOR: blue">long</span>)GetDeviceCaps(hdc,HORZRES))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>x = (<span style="COLOR: blue">long</span>)GetDeviceCaps(hdc,HORZRES);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(y&gt;(<span style="COLOR: blue">long</span>)GetDeviceCaps(hdc,VERTRES))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>y = (<span style="COLOR: blue">long</span>)GetDeviceCaps(hdc,VERTRES);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">//</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">定义回调函数</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">LRESULT CALLBACK<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">MainWndProc (HWND hwnd, UINT nMsg, WPARAM wParam, LPARAM lParam)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">static</span> HWND<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>hwndButton = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>HDC<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hdc;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>PAINTSTRUCT<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>ps;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>RECT<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rc;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LPVOID lpb;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UINT dwSize;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RAWINPUT *raw;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">switch</span> (nMsg)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> WM_DESTROY:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PostQuitMessage (0);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">响应</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">WM_PAINT</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">消息以绘制窗口，输出信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> WM_PAINT:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hdc = BeginPaint(hwnd, &amp;ps);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">输出信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetClientRect(hwnd, &amp;rc);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DrawText(hdc, mousemessage, strlen(mousemessage), &amp;rc, DT_CENTER);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OffsetRect(&amp;rc,0,150); <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DrawText(hdc, rawinputdevices, strlen(rawinputdevices), &amp;rc, DT_CENTER);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OffsetRect(&amp;rc,0,40);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DrawText(hdc, mousemessage2, strlen(mousemessage2), &amp;rc, DT_CENTER);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>EndPaint(hwnd, &amp;ps);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">响应</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">WM_INPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">消息为本程序的主要部分</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> WM_INPUT: <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputData((HRAWINPUT)lParam, RID_INPUT, NULL, &amp;dwSize, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">sizeof</span>(RAWINPUTHEADER));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>lpb = malloc(<span style="COLOR: blue">sizeof</span>(LPVOID) * dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (lpb == NULL) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputData((HRAWINPUT)lParam, RID_INPUT, lpb, &amp;dwSize, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;</span><span style="COLOR: blue">sizeof</span>(RAWINPUTHEADER));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw = (RAWINPUT*)lpb;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (raw-&gt;header.dwType == RIM_TYPEMOUSE) <span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">判断是否为鼠标信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">将鼠标的输入信息写入缓存</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">mousemessage<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wsprintf(mousemessage,<span style="COLOR: maroon">&quot;Mouse:hDevice %d /n usFlags=%04x /nulButtons=%04x /nusButtonFlags=%04x /nusButtonData=%04x /nulRawButtons=%04x /nlLastX=%ld /nlLastY=%ld /nulExtraInformation=%04x/n&quot;</span>,<span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;header.hDevice,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.usFlags, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.ulButtons, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.usButtonFlags, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.usButtonData, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.ulRawButtons, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.lLastX, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.lLastY, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.ulExtraInformation);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">解析</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RAWMOUSE</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">数据</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.usFlags = MOUSE_MOVE_ABSOLUTE;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>X += raw-&gt;data.mouse.lLastX;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Y += raw-&gt;data.mouse.lLastY;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">检查边界，以防坐标为负或超过屏幕容许最大值</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hdc = BeginPaint(hwnd, &amp;ps);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CheckBound(hdc,X,Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>EndPaint(hwnd, &amp;ps);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">重新以坐标定位鼠标指针，以防系统忙导致的消息丢失</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>::SetCursorPos(X,Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wsprintf(mousemessage2,<span style="COLOR: maroon">&quot;X: %ld,Y: %ld/n&quot;</span>,X,Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">switch</span>(raw-&gt;data.mouse.usButtonFlags)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> RI_MOUSE_LEFT_BUTTON_DOWN:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>strcat(mousemessage2,<span style="COLOR: maroon">&quot;Left button down/n&quot;</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> RI_MOUSE_LEFT_BUTTON_UP:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>strcat(mousemessage2,<span style="COLOR: maroon">&quot;Left button up/n&quot;</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> RI_MOUSE_MIDDLE_BUTTON_DOWN:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>strcat(mousemessage2,<span style="COLOR: maroon">&quot;Middle button down/n&quot;</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> RI_MOUSE_MIDDLE_BUTTON_UP:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>strcat(mousemessage2,<span style="COLOR: maroon">&quot;Middle button up/n&quot;</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> RI_MOUSE_RIGHT_BUTTON_DOWN:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>strcat(mousemessage2,<span style="COLOR: maroon">&quot;Right button down/n&quot;</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> RI_MOUSE_RIGHT_BUTTON_UP:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>strcat(mousemessage2,<span style="COLOR: maroon">&quot;Right button up/n&quot;</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">重绘窗口以输入数据</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InvalidateRect(hwnd,0,TRUE);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SendMessage(hwnd,WM_PAINT,0,0);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>free(lpb);<span style="mso-spacerun: yes">&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> DefWindowProc (hwnd, nMsg, wParam, lParam);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">int</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> APIENTRY <o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">WinMain (HINSTANCE hInst, HINSTANCE hPrev, LPSTR lpCmd, <span style="COLOR: blue">int</span> nShow)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>HWND<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hwndMain;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MSG<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>msg;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WNDCLASSEX<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>wndclass;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">char</span>*<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>szMainWndClass = <span style="COLOR: maroon">&quot;szRawInputTest&quot;</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>memset (&amp;wndclass, 0, <span style="COLOR: blue">sizeof</span>(WNDCLASSEX));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.lpszClassName = szMainWndClass;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.cbSize = <span style="COLOR: blue">sizeof</span>(WNDCLASSEX);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.style = CS_HREDRAW | CS_VREDRAW;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.lpfnWndProc = MainWndProc;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hInstance = hInst;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hIcon = LoadIcon (NULL, IDI_APPLICATION);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hIconSm = LoadIcon (NULL, IDI_APPLICATION);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hCursor = LoadCursor (NULL, IDC_ARROW);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RegisterClassEx (&amp;wndclass);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hwndMain = CreateWindow (<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>szMainWndClass,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: maroon">&quot;RawInputTest&quot;</span>,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WS_OVERLAPPEDWINDOW,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CW_USEDEFAULT,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CW_USEDEFAULT,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CW_USEDEFAULT,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CW_USEDEFAULT,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NULL,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NULL,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hInst,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NULL<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ShowWindow (hwndMain, nShow);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UpdateWindow (hwndMain);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;</span>InitRawInput(hwndMain);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">进入消息循环</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">while</span> (GetMessage (&amp;msg, NULL, 0, 0))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TranslateMessage (&amp;msg);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DispatchMessage (&amp;msg);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> msg.wParam;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">程序实际运行效果如图</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">2.3</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">所示：</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%" align="center"><span lang="EN-US" style="FONT-SIZE: 10pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p><img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/RawInput各鼠标输入数据识别测试程序截图.JPG" /></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: center" align="center"><span lang="EN-US" style="FONT-SIZE: 10pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><v:shape id="_x0000_i1026" style="WIDTH: 184.5pt; HEIGHT: 181.5pt" type="#_x0000_t75"><v:imagedata o:title="RawInput2" src="file:///C:/DOCUME~1/ADMINI~1/LOCALS~1/Temp/msohtml1/01/clip_image004.jpg"></v:imagedata></v:shape><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: center" align="center"><font size="3"><span style="LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">图</span><span lang="EN-US" style="LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt"><font face="Times New Roman">2.3 RawInput</font></span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">各鼠标</span><span style="LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">输入数据识别测试程序截图</span><span lang="EN-US" style="LINE-HEIGHT: 150%; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 10pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">其中不同鼠标的输入通过鼠标的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">hDevice</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">不同来分辨，上面一部分是</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构的原始输入数据，下面一部分是解析过的数据。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 10.0pt; mso-font-kerning: 0pt"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 10pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><st1:chsdate w:st="on" isrocdate="False" islunardate="False" day="30" month="12" year="1899"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体">2.3.2</span></st1:chsdate><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体"> RawInput</span></font><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-ascii-font-family: 'Times New Roman'">多鼠标指针绘制原理</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-fareast-font-family: 黑体"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; </span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">虽然在此节介绍的多鼠标指针绘制原理中，绘制多鼠标指针的输入数据来源于上节所讲的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">技术，但是实际上无论用那种方法获得数据，本节所讲的多鼠标绘制技术都有实际意义，本节所讲的实际是一种非常典型的分时多鼠标指针绘制技术。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">首先，要绘制多个鼠标，首先要做到的就是保存下目前各鼠标的坐标状况。这里，可以用一个动态数组来完成，另外，要能识别此坐标到底是哪个鼠标的坐标，即应该给各鼠标加上一个</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">ID</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">号，并且这里可以用上节所讲的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构中的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">header.hDevice</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">来识别，因为代表各鼠标设备的句柄是唯一的。可以定义一个简单的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">struct</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">来将两者组合在一起以方便调用。</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这里将其命名为</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">SiRawMouse</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">并声明一个它的指针，用来实际保存数据。实际代码如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">struct</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> SiRawMouse<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">long</span> X;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">long</span> Y;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>HANDLE hDevice;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">}*pSiRawMouse;</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"> </span><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">另外，在上一节中已经通过第一步获得系统中</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">鼠标的数量了。可以根据这个数量决定动态数组的大小。各鼠标的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">hDevice</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在得到的各</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RAWINPUTDEVICELIST</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">结构中就有保存。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这里需要注意的是，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">Windows</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中实际上接入的鼠标要将以上数量减</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">1</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，因为它内置了一个虚拟的系统鼠标。在普通程序中，多个鼠标的操作都是移动同一个指针的效果就是通过这个虚拟的系统鼠标做到的。</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">在这里，最重要的是分析出到底哪个鼠标是系统鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">,</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">这里提供的一种思路是通过鼠标的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">DeviceName</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">来分辨，设备的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">DeviceName</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">可以通过</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputDeviceInfo</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">函数得到。其函数原型如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">UINT&nbsp;GetRawInputDeviceInfo(&nbsp;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hDevice,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;UINT&nbsp;uiCommand,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;pData,<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;PUINT&nbsp;pcbSize<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在这里又要通过两次调用才能得到想要的结果，第一次以第三参数为</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">NULL</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">获得第四参数的大小，然后以空指针获得想要的结构。并且要获得</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">DeviceName</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第二参数要设为</span><span class="clsliteral"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 8.0pt"><font face="Courier New">RIDI_DEVICENAME</font></span></span><span class="clsliteral"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-bidi-font-size: 8.0pt; mso-ascii-font-family: 'Courier New'; mso-hansi-font-family: 'Courier New'">。得到</span></span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">DeviceName</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">以后可以通过比较前</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">22</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">个字符来分辨此设备是否是系统鼠标，因为系统鼠标前</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">22</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">位一般是固定为</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">&quot;//??//Root#RDP_MOU#0000#&quot;,</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">具体比较方式可以用以下函数完成</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">:<span style="COLOR: maroon"><o:p></o:p></span></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">bool</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> isRootMouse(<span style="COLOR: blue">char</span> cDeviceString[])<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">char</span> cRootString[] = <span style="COLOR: maroon">&quot;//??//Root#RDP_MOU#0000#&quot;</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (strlen(cDeviceString) &lt; 22) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> <span style="COLOR: blue">false</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span> (<span style="COLOR: blue">int</span> i = 0; i &lt; 22; i++) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (cRootString[i] != cDeviceString[i]) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> <span style="COLOR: blue">false</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> <span style="COLOR: blue">true</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">按以上所讲方式，完整的各鼠标坐标数据初始化代码如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=0,j=1; i &lt; nDevices &amp;&amp; j &lt; nMouseNumber; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(pRawInputDeviceList[i].dwType == RIM_TYPEMOUSE)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputDeviceInfo(pRawInputDeviceList[i].hDevice, <span style="mso-tab-count: 11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RIDI_DEVICENAME, NULL, &amp;dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>lpb = malloc(<span style="COLOR: blue">sizeof</span>(LPVOID) * dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputDeviceInfo(pRawInputDeviceList[i].hDevice, <span style="mso-tab-count: 11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RIDI_DEVICENAME, lpb, &amp;dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">char</span> *deviceName = (<span style="COLOR: blue">char</span>*)lpb;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(isRootMouse(deviceName))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].hDevice = pRawInputDeviceList[i].hDevice;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].X = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].Y = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">else<o:p></o:p></span></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[j].hDevice = pRawInputDeviceList[i].hDevice;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[j].X = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[j].Y = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>++j;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>free(lpb);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">通过以上方式初始化了保存鼠标坐标信息的动态数组以后，分别储存和处理不同</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">hDevice</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">信息，具体方式如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">if</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> (raw-&gt;header.dwType == RIM_TYPEMOUSE) <span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">判断是否为鼠标信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.usFlags = MOUSE_MOVE_ABSOLUTE;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=1; i&lt;nMouseNumber; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(pSiRawMouse[i].hDevice == raw-&gt;header.hDevice)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[i].X += raw-&gt;data.mouse.lLastX;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[i].Y += raw-&gt;data.mouse.lLastY;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hdc = GetDC(hwnd);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CheckBound(hdc,pSiRawMouse[i].X,pSiRawMouse[i].Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ReleaseDC(hwnd,hdc);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].X = pSiRawMouse[i].X;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].Y = pSiRawMouse[i].Y;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SetCursorPos(pSiRawMouse[0].X, pSiRawMouse[0].Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">} </span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">此处的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">raw</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为上节中所提到已经获取到鼠标原始输入信息的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RAWINPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构数据。在这里，处理方式与上节中的不同是判断了鼠标输入信息的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">hDevice</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">属性来分辨不同鼠标，并保存在各自的</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">SiRawMouse</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结构中，在检查边界后再将其赋给系统鼠标，并利用此坐标定位系统鼠标指针。这样，就获得了各鼠标独立的，不同的坐标信息，为鼠标指针的绘制做了必要的工作。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">下一步就是利用各鼠标的坐标分别绘制鼠标指针，这里用图标代替鼠标指针的方式简化了一些处理。首先要设置一个自定义的图标资源，此资源储存着要绘制鼠标的样式。然后利用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">DrawIcon</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数调用各鼠标的坐标，达到绘制鼠标指针的类似效果。要注意的是，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">DrawIcon</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数调用的坐标信息是程序窗口的相对坐标，而以上方式获得的坐标信息为屏幕坐标，需要经过</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">ScreenToClient</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数进行坐标的转换。并且为了每次坐标的改变都要能够看到，而且以前绘制的图标应该消失，此过程应放置在响应</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">WM_PAINT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">消息的响应过程中，具体方式如下：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">case</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> WM_PAINT:<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hdc = BeginPaint(hwnd, &amp;ps);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=1; i&lt;nMouseNumber; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POINT pt = { pSiRawMouse[i].X, pSiRawMouse[i].Y };<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ScreenToClient(hwnd,&amp;pt);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DrawIcon(hdc,pt.x,pt.y,hicon);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>EndPaint(hwnd, &amp;ps);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">;</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><span style="mso-tab-count: 1"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这样，每次响应</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">WM_INPUT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">更改目前各鼠标的坐标状态后，都刷新一次程序，以调用</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">WM_PAINT</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的响应过程，就可以完成各鼠标指针的绘制。全程序完整原代码如下所示：</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-bidi-font-size: 9.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">多鼠标指针绘制演示程序具体代码（以下代码在</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><font face="Times New Roman">Visual studio .NET 2005 </font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-bidi-font-size: 9.0pt; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-bidi-font-weight: bold">上编译通过）</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&quot;stdafx.h&quot;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&quot;rawinput2.h&quot;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&lt;stdlib.h&gt;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&lt;string.h&gt;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#define</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> _WIN32_WINNT 0x0501<span style="mso-spacerun: yes">&nbsp;&nbsp; </span><span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">定义此程序为</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">Windows XP</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">程序</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">#include</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> <span style="COLOR: maroon">&lt;windows.h&gt;<o:p></o:p></span></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">char</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> mousePostion[256];<span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">储存经过分析处理的各鼠标坐标信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">HICON<span style="mso-spacerun: yes">&nbsp; </span>hicon; <span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">绘制的鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">int</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> nMouseNumber = 0; <span style="COLOR: green">//</span></span></font><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">鼠标数量</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">//</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">定义一个自定义的类型，保存坐标和设备的句柄</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">struct</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> SiRawMouse<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">long</span> X;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">long</span> Y;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>HANDLE hDevice;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}*pSiRawMouse;<span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">输入设备鼠标的自定义类型数组</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">//</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">判定是否为系统鼠标的函数</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">bool</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> isRootMouse(<span style="COLOR: blue">char</span> cDeviceString[])<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">一般系统鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">DeviceName</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">的前</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">22</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">字节</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">char</span> cRootString[] = <span style="COLOR: maroon">&quot;//??//Root#RDP_MOU#0000#&quot;</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">通过比较前</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">22</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">个字节判断是否为系统鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (strlen(cDeviceString) &lt; 22) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> <span style="COLOR: blue">false</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span> (<span style="COLOR: blue">int</span> i = 0; i &lt; 22; i++) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (cRootString[i] != cDeviceString[i]) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> <span style="COLOR: blue">false</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> <span style="COLOR: blue">true</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">//RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">初始化函数</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">void</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> InitRawInput(HWND hwnd)<span style="mso-spacerun: yes">&nbsp; </span><o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UINT nDevices;<span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">输入设备的数量</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第一次调用</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputDeviceList</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">获得输入设备的数量</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputDeviceList(NULL, &amp;nDevices, <span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">第二次调用</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputDeviceList</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">获得</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInputDeviceList</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">数组</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PRAWINPUTDEVICELIST pRawInputDeviceList;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pRawInputDeviceList = (RAWINPUTDEVICELIST *)calloc(nDevices,<span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputDeviceList(pRawInputDeviceList, &amp;nDevices, <span style="COLOR: blue">sizeof</span>(RAWINPUTDEVICELIST));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">获得输入设备中鼠标的数量</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=0; i &lt; nDevices; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(pRawInputDeviceList[i].dwType == RIM_TYPEMOUSE)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>++nMouseNumber;<span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">获得输入设备鼠标的自定义类型数组，其中索引为</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">0</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">的为系统鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse = (SiRawMouse *)calloc(nMouseNumber,<span style="COLOR: blue">sizeof</span>(SiRawMouse));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LPVOID lpb;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UINT dwSize;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=0,j=1; i &lt; nDevices &amp;&amp; j &lt; nMouseNumber; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(pRawInputDeviceList[i].dwType == RIM_TYPEMOUSE)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">连续两次调用</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetRawInputDeviceInfo</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">以读取</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RIDI_DEVICENAME<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">并通过此值判断是否为系统鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputDeviceInfo(pRawInputDeviceList[i].hDevice,RIDI_DEVICENAME,NULL,&amp;dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>lpb = malloc(<span style="COLOR: blue">sizeof</span>(LPVOID) * dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputDeviceInfo(pRawInputDeviceList[i].hDevice,RIDI_DEVICENAME,lpb,&amp;dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">char</span> *deviceName = (<span style="COLOR: blue">char</span>*)lpb;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">将系统鼠标的保存在索引</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">0</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">中，其他依次列在后面</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(isRootMouse(deviceName))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].hDevice = pRawInputDeviceList[i].hDevice;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].X = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].Y = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">else<o:p></o:p></span></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[j].hDevice = pRawInputDeviceList[i].hDevice;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[j].X = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[j].Y = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>++j;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>free(lpb);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>free(pRawInputDeviceList);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pRawInputDeviceList = NULL;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">初始化</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">1</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">个</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RAWINPUTDEVICE Rid[1]; <span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">分配</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备的空间</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Rid[0].usUsagePage = 0x01; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Rid[0].usUsage = 0x02; <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Rid[0].dwFlags = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Rid[0].hwndTarget = NULL;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">注册</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">设备</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (RegisterRawInputDevices(Rid, 1, <span style="COLOR: blue">sizeof</span> (Rid [0])) == FALSE) {<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MessageBox(hwnd,<span style="COLOR: maroon">&quot;RawInput Register Error.&quot;</span>,<span style="COLOR: maroon">&quot;RawInput init failed!&quot;</span>,MB_OK);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> ;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">//</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">检查边界的函数</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">void</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> CheckBound(HDC hdc,<span style="COLOR: blue">long</span> &amp;x,<span style="COLOR: blue">long</span> &amp;y)<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(x&lt;0)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>x = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(y&lt;0)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>y = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">最大值由</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">GetDeviceCaps</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">函数获取以适应不同系统设置</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(x&gt;(<span style="COLOR: blue">long</span>)GetDeviceCaps(hdc,HORZRES))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>x = (<span style="COLOR: blue">long</span>)GetDeviceCaps(hdc,HORZRES);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(y&gt;(<span style="COLOR: blue">long</span>)GetDeviceCaps(hdc,VERTRES))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>y = (<span style="COLOR: blue">long</span>)GetDeviceCaps(hdc,VERTRES);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">//</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">定义回调函数</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">LRESULT CALLBACK<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">MainWndProc (HWND hwnd, UINT nMsg, WPARAM wParam, LPARAM lParam)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">static</span> HWND<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>hwndButton = 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>HDC <span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>hdc;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>PAINTSTRUCT<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>ps;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>RECT<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rc;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LPVOID lpb;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UINT dwSize;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RAWINPUT *raw;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">switch</span> (nMsg)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> WM_DESTROY:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>free(pSiRawMouse);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DestroyIcon(hicon);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PostQuitMessage (0);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">响应</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">WM_PAINT</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">消息以绘制窗口，输出信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> WM_PAINT:<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hdc = BeginPaint(hwnd, &amp;ps);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">输出信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetClientRect(hwnd, &amp;rc);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OffsetRect(&amp;rc,0,100);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DrawText(hdc, mousePostion, strlen(mousePostion), &amp;rc, DT_CENTER);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=1; i&lt;nMouseNumber; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>POINT pt = { pSiRawMouse[i].X, pSiRawMouse[i].Y };<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ScreenToClient(hwnd,&amp;pt);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DrawIcon(hdc,pt.x,pt.y,hicon);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>EndPaint(hwnd, &amp;ps);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">break</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">响应</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">WM_INPUT</font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">消息为本程序的主要部分</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">case</span> WM_INPUT: <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputData((HRAWINPUT)lParam, RID_INPUT, NULL, &amp;dwSize, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">sizeof</span>(RAWINPUTHEADER));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>lpb = malloc(<span style="COLOR: blue">sizeof</span>(LPVOID) * dwSize);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (lpb == NULL) <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetRawInputData((HRAWINPUT)lParam, RID_INPUT, lpb, &amp;dwSize, <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;</span><span style="COLOR: blue">sizeof</span>(RAWINPUTHEADER));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw = (RAWINPUT*)lpb;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span> (raw-&gt;header.dwType == RIM_TYPEMOUSE) <span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">判断是否为鼠标信息</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raw-&gt;data.mouse.usFlags = MOUSE_MOVE_ABSOLUTE;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=1; i&lt;nMouseNumber; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">if</span>(pSiRawMouse[i].hDevice == raw-&gt;header.hDevice)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[i].X += raw-&gt;data.mouse.lLastX;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[i].Y += raw-&gt;data.mouse.lLastY;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hdc = GetDC(hwnd);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CheckBound(hdc,pSiRawMouse[i].X,pSiRawMouse[i].Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ReleaseDC(hwnd,hdc);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].X = pSiRawMouse[i].X;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pSiRawMouse[0].Y = pSiRawMouse[i].Y;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SetCursorPos(pSiRawMouse[0].X, pSiRawMouse[0].Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wsprintf(mousePostion,<span style="COLOR: maroon">&quot;Mouse %d-&gt; X: %ld,Y: %ld/n&quot;</span>, 0, pSiRawMouse[0].X, pSiRawMouse[0].Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">for</span>(<span style="COLOR: blue">int</span> i=1; i&lt;nMouseNumber; ++i)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">char</span> cTemp[100];<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wsprintf(cTemp,<span style="COLOR: maroon">&quot;Mouse %d-&gt; X: %ld,Y: %ld/n&quot;</span>, i, pSiRawMouse[i].X, pSiRawMouse[i].Y);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>strcat(mousePostion,cTemp);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">重绘窗口以显示输入数据及重绘指针</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InvalidateRect(hwnd,0,TRUE);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SendMessage(hwnd,WM_PAINT,0,0);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>free(lpb);<span style="mso-spacerun: yes">&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> 0;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} <o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> DefWindowProc (hwnd, nMsg, wParam, lParam);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><font face="Times New Roman"><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: blue; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes">int</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"> APIENTRY <o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">WinMain (HINSTANCE hInst, HINSTANCE hPrev, LPSTR lpCmd, <span style="COLOR: blue">int</span> nShow)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;</span><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hicon = LoadIcon(hInst,MAKEINTRESOURCE(IDI_CURSOR));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>HWND<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hwndMain;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MSG<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>msg;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WNDCLASSEX<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>wndclass;<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">char</span>*<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>szMainWndClass = <span style="COLOR: maroon">&quot;szRawInputTest&quot;</span>;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>memset (&amp;wndclass, 0, <span style="COLOR: blue">sizeof</span>(WNDCLASSEX));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.lpszClassName = szMainWndClass;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.cbSize = <span style="COLOR: blue">sizeof</span>(WNDCLASSEX);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.style = CS_HREDRAW | CS_VREDRAW;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.lpfnWndProc = MainWndProc;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hInstance = hInst;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hIcon = LoadIcon (NULL, IDI_APPLICATION);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hIconSm = LoadIcon (NULL, IDI_APPLICATION);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hCursor = LoadCursor (NULL, IDC_ARROW);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>wndclass.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RegisterClassEx (&amp;wndclass);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hwndMain = CreateWindow (<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>szMainWndClass,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: maroon">&quot;RawInput pointer draw&quot;</span>,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>WS_OVERLAPPEDWINDOW,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CW_USEDEFAULT,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CW_USEDEFAULT,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>CW_USEDEFAULT,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CW_USEDEFAULT,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NULL,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NULL,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hInst,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NULL<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ShowCursor(FALSE);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InitRawInput(hwndMain);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ShowWindow (hwndMain, nShow);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>UpdateWindow (hwndMain);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: green">//</span></font></span><span style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">进入消息循环</span><span lang="EN-US" style="FONT-SIZE: 12pt; COLOR: green; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">while</span> (GetMessage (&amp;msg, NULL, 0, 0))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>TranslateMessage (&amp;msg);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>DispatchMessage (&amp;msg);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR: blue">return</span> msg.wParam;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><font face="Times New Roman">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">程序运行效果如图</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">2.4</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">所示：</span></p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="center"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p><img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/vagrxie/RawInput各鼠标指针绘制演示程序截图.JPG" /></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: center; mso-layout-grid-align: none" align="center"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体"><v:shape id="_x0000_i1027" style="WIDTH: 226.5pt; HEIGHT: 225.75pt" type="#_x0000_t75"><v:imagedata o:title="RawInputDraw" src="file:///C:/DOCUME~1/ADMINI~1/LOCALS~1/Temp/msohtml1/01/clip_image005.jpg"></v:imagedata></v:shape><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: center; mso-layout-grid-align: none" align="center"><font size="3"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">图</span><span lang="EN-US"><font face="Times New Roman">2.4 RawInput</font></span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">各鼠标指针绘制演示程序截图</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%; TEXT-ALIGN: left; mso-layout-grid-align: none" align="left"><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; </span></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">中间显示的鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">0</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">即为系统鼠标，鼠标</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">1</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">2</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">3</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">分别为接入的实际鼠标，在这里为了更好的集中在鼠标指针的绘制问题上，忽略了所有关于鼠标按键的问题。程序源代码中</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; mso-font-kerning: 0pt; mso-no-proof: yes"><font face="Times New Roman">IDI_CURSOR</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'; mso-no-proof: yes">为一个自定义的图标资源。</span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">需要注意的是，因为各鼠标实际的操作是利用系统鼠标完成，所以同时操作的时候会有些混乱，这是分时控制系统鼠标的弊病所在，在介绍</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">RawInput</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">技术的时候已经讲过，另外，在接下来的第</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">3</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">章中，讲</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><font face="Times New Roman">CPNMouse</font></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%; FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">库部分时候会详细演示这种技术的弊端。</span><span lang="EN-US" style="FONT-SIZE: 12pt; LINE-HEIGHT: 150%"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: 150%"><span lang="EN-US" style="FONT-SIZE: 16pt; LINE-HEIGHT: 150%; FONT-FAMILY: 黑体; mso-font-kerning: 0pt; mso-bidi-font-weight: bold"><o:p>&nbsp;</o:p></span></p>
